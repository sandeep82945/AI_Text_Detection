{
    "abstractText": "In this paper we improve the zero-shot generalization ability of language models via MixtureOf-Memory Augmentation (MoMA), a mechanism that retrieves augmentation documents from multiple information corpora (\u201cexternal memories\u201d), with the option to \u201cplug in\u201d unseen memory at inference time. We develop a joint learning mechanism that trains the augmentation component with latent labels derived from the end retrieval task, paired with hard negatives from the memory mixture. We instantiate the model in a zero-shot dense retrieval setting by augmenting strong T5-based retrievers with MoMA. With only T5-base, our model obtains strong zero-shot retrieval accuracy on the eighteen tasks included in the standard BEIR benchmark, outperforming some systems with larger model sizes. As a plug-inplay model, our model can efficiently generalize to any unseen corpus, meanwhile achieving comparable or even better performance than methods relying on target-specific pretraining. Our analysis further illustrates the necessity of augmenting with mixture-of-memory for robust generalization, the benefits of augmentation learning, and how MoMA utilizes the plugin memory at inference time without changing its parameters. Our code can be found at https://github.com/gesy17/MoMA.",
    "authors": [
        {
            "affiliations": [],
            "name": "Suyu Ge"
        },
        {
            "affiliations": [],
            "name": "Chenyan Xiong"
        },
        {
            "affiliations": [],
            "name": "Corby Rosset"
        },
        {
            "affiliations": [],
            "name": "Arnold Overwijk"
        },
        {
            "affiliations": [],
            "name": "Jiawei Han"
        },
        {
            "affiliations": [],
            "name": "Paul Bennett"
        }
    ],
    "id": "SP:1dbd48e442bc1c6b6210428967098b76633762e5",
    "references": [
        {
            "authors": [
                "Payal Bajaj",
                "Daniel Campos",
                "Nick Craswell",
                "Li Deng",
                "Jianfeng Gao",
                "Xiaodong Liu",
                "Rangan Majumder",
                "Andrew McNamara",
                "Bhaskar Mitra",
                "Tri Nguyen"
            ],
            "title": "2016. MS MARCO: A human generated machine reading comprehension",
            "year": 2016
        },
        {
            "authors": [
                "Emily M Bender",
                "Timnit Gebru",
                "Angelina"
            ],
            "title": "McMillanMajor, and Shmargaret Shmitchell",
            "venue": "In Proceedings of the 2021 ACM Conference on Fairness, Accountability, and Transparency,",
            "year": 2021
        },
        {
            "authors": [
                "Alexander Bondarenko",
                "Maik Fr\u00f6be",
                "Meriem Beloucif",
                "Lukas Gienapp",
                "Yamen Ajjour",
                "Alexander Panchenko",
                "Chris Biemann",
                "Benno Stein",
                "Henning Wachsmuth",
                "Martin Potthast",
                "Matthias Hagen"
            ],
            "title": "Overview of Touch\u00e9 2020",
            "year": 2020
        },
        {
            "authors": [
                "Sebastian Borgeaud",
                "Arthur Mensch",
                "Jordan Hoffmann",
                "Trevor Cai",
                "Eliza Rutherford",
                "Katie Millican",
                "George Bm Van Den Driessche",
                "Jean-Baptiste Lespiau",
                "Bogdan Damoc",
                "Aidan Clark"
            ],
            "title": "Improving language models by retrieving from tril",
            "year": 2022
        },
        {
            "authors": [
                "Vera Boteva",
                "Demian Gholipour",
                "Artem Sokolov",
                "Stefan Riezler."
            ],
            "title": "A full-text learning to rank dataset for medical information retrieval",
            "venue": "European Conference on Information Retrieval, pages 716\u2013722. Springer.",
            "year": 2016
        },
        {
            "authors": [
                "Askell"
            ],
            "title": "Language models are few-shot",
            "year": 2020
        },
        {
            "authors": [
                "Jamie Callan"
            ],
            "title": "DBpedia-Entity v2: A test",
            "year": 2017
        },
        {
            "authors": [
                "Doris Hoogeveen",
                "Karin M. Verspoor",
                "Timothy Baldwin."
            ],
            "title": "CQADupStack: A benchmark data set for community question-answering research",
            "venue": "Proceedings of the 20th Australasian Document Computing Symposium, ADCS \u201915, New York, NY, USA.",
            "year": 2015
        },
        {
            "authors": [
                "Gautier Izacard",
                "Mathilde Caron",
                "Lucas Hosseini",
                "Sebastian Riedel",
                "Piotr Bojanowski",
                "Armand Joulin",
                "Edouard Grave."
            ],
            "title": "Towards unsupervised dense information retrieval with contrastive learning",
            "venue": "arXiv preprint arXiv:2112.09118.",
            "year": 2021
        },
        {
            "authors": [
                "Gautier Izacard",
                "Edouard Grave."
            ],
            "title": "Distilling knowledge from reader to retriever for question answering",
            "venue": "arXiv preprint arXiv:2012.04584.",
            "year": 2020
        },
        {
            "authors": [
                "Gautier Izacard",
                "Edouard Grave"
            ],
            "title": "Leveraging passage retrieval with generative models for open domain question answering",
            "year": 2020
        },
        {
            "authors": [
                "Gautier Izacard",
                "Patrick Lewis",
                "Maria Lomeli",
                "Lucas Hosseini",
                "Fabio Petroni",
                "Timo Schick",
                "Jane Dwivedi-Yu",
                "Armand Joulin",
                "Sebastian Riedel",
                "Edouard Grave."
            ],
            "title": "Few-shot learning with retrieval augmented language models",
            "venue": "arXiv preprint",
            "year": 2022
        },
        {
            "authors": [
                "Jeff Johnson",
                "Matthijs Douze",
                "Herv\u00e9 J\u00e9gou."
            ],
            "title": "Billion-scale similarity search with gpus",
            "venue": "IEEE Transactions on Big Data, 7(3):535\u2013547.",
            "year": 2019
        },
        {
            "authors": [
                "Jared Kaplan",
                "Sam McCandlish",
                "Tom Henighan",
                "Tom B Brown",
                "Benjamin Chess",
                "Rewon Child",
                "Scott Gray",
                "Alec Radford",
                "Jeffrey Wu",
                "Dario Amodei."
            ],
            "title": "Scaling laws for neural language models",
            "venue": "arXiv preprint arXiv:2001.08361.",
            "year": 2020
        },
        {
            "authors": [
                "Vladimir Karpukhin",
                "Barlas O\u011fuz",
                "Sewon Min",
                "Patrick Lewis",
                "Ledell Wu",
                "Sergey Edunov",
                "Danqi Chen",
                "Wen-tau Yih."
            ],
            "title": "Dense passage retrieval for open-domain question answering",
            "venue": "arXiv preprint arXiv:2004.04906.",
            "year": 2020
        },
        {
            "authors": [
                "Urvashi Khandelwal",
                "Omer Levy",
                "Dan Jurafsky",
                "Luke Zettlemoyer",
                "Mike Lewis."
            ],
            "title": "Generalization through memorization: Nearest neighbor language models",
            "venue": "arXiv preprint arXiv:1911.00172.",
            "year": 2019
        },
        {
            "authors": [
                "Omar Khattab",
                "Matei Zaharia."
            ],
            "title": "Colbert: Efficient and effective passage search via contextualized late interaction over bert",
            "venue": "Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval, pages 39\u2013",
            "year": 2020
        },
        {
            "authors": [
                "Omar Khattab",
                "Matei Zaharia"
            ],
            "title": "2020b. Colbert: Efficient and effective passage search via contextualized late interaction over bert",
            "venue": "In Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval,",
            "year": 2020
        },
        {
            "authors": [
                "Yubin Kim."
            ],
            "title": "Applications and future of dense retrieval in industry",
            "venue": "Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval, pages 3373\u2013 3374.",
            "year": 2022
        },
        {
            "authors": [
                "Uszkoreit",
                "Quoc Le",
                "Slav Petrov."
            ],
            "title": "Natural questions: A benchmark for question answering research",
            "venue": "Transactions of the Association for Computational Linguistics, 7:452\u2013466.",
            "year": 2019
        },
        {
            "authors": [
                "Victor Lavrenko",
                "W Bruce Croft."
            ],
            "title": "Relevancebased language models",
            "venue": "ACM SIGIR Forum, volume 51, pages 260\u2013267. ACM New York, NY, USA.",
            "year": 2017
        },
        {
            "authors": [
                "Patrick Lewis",
                "Ethan Perez",
                "Aleksandara Piktus",
                "Fabio Petroni",
                "Vladimir Karpukhin",
                "Naman Goyal",
                "Heinrich K\u00fcttler",
                "Mike Lewis",
                "Wen-tau Yih",
                "Tim Rockt\u00e4schel"
            ],
            "title": "Retrieval-augmented generation for knowledge-intensive nlp tasks",
            "year": 2020
        },
        {
            "authors": [
                "Yinhan Liu",
                "Myle Ott",
                "Naman Goyal",
                "Jingfei Du",
                "Mandar Joshi",
                "Danqi Chen",
                "Omer Levy",
                "Mike Lewis",
                "Luke Zettlemoyer",
                "Veselin Stoyanov."
            ],
            "title": "RoBERTa: A Robustly Optimized BERT Pretraining Approach",
            "venue": "arXiv preprint arXiv:1907.11692.",
            "year": 2019
        },
        {
            "authors": [
                "Ilya Loshchilov",
                "Frank Hutter."
            ],
            "title": "Decoupled weight decay regularization",
            "venue": "International Conference on Learning Representations.",
            "year": 2019
        },
        {
            "authors": [
                "Jing Lu",
                "Gustavo Hernandez Abrego",
                "Ji Ma",
                "Jianmo Ni",
                "Yinfei Yang."
            ],
            "title": "Multi-stage training with improved negative contrast for neural passage retrieval",
            "venue": "Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing, pages",
            "year": 2021
        },
        {
            "authors": [
                "Macedo Maia",
                "Siegfried Handschuh",
                "Andr\u00e9 Freitas",
                "Brian Davis",
                "Ross McDermott",
                "Manel Zarrouk",
                "Alexandra Balahur."
            ],
            "title": "WWW\u201918 open challenge: Financial opinion mining and question answering",
            "venue": "Companion Proceedings of the The Web Conference",
            "year": 2018
        },
        {
            "authors": [
                "Arvind Neelakantan",
                "Tao Xu",
                "Raul Puri",
                "Alec Radford",
                "Jesse Michael Han",
                "Jerry Tworek",
                "Qiming Yuan",
                "Nikolas Tezak",
                "Jong Wook Kim",
                "Chris Hallacy"
            ],
            "title": "Text and code embeddings by contrastive pretraining",
            "venue": "arXiv preprint arXiv:2201.10005",
            "year": 2022
        },
        {
            "authors": [
                "Jianmo Ni",
                "Gustavo Hernandez Abrego",
                "Noah Constant",
                "Ji Ma",
                "Keith Hall",
                "Daniel Cer",
                "Yinfei Yang."
            ],
            "title": "Sentence-t5: Scalable sentence encoders from pretrained text-to-text models",
            "venue": "Findings of the Association for Computational Linguistics: ACL 2022,",
            "year": 2022
        },
        {
            "authors": [
                "Jianmo Ni",
                "Chen Qu",
                "Jing Lu",
                "Zhuyun Dai",
                "Gustavo Hern\u00e1ndez \u00c1brego",
                "Ji Ma",
                "Vincent Y Zhao",
                "Yi Luan",
                "Keith B Hall",
                "Ming-Wei Chang"
            ],
            "title": "Large dual encoders are generalizable retrievers",
            "venue": "arXiv preprint arXiv:2112.07899",
            "year": 2021
        },
        {
            "authors": [
                "Adam Paszke",
                "Sam Gross",
                "Francisco Massa",
                "Adam Lerer",
                "James Bradbury",
                "Gregory Chanan",
                "Trevor Killeen",
                "Zeming Lin",
                "Natalia Gimelshein",
                "Luca Antiga"
            ],
            "title": "Pytorch: An imperative style, high-performance deep learning library",
            "year": 2019
        },
        {
            "authors": [
                "Fabio Petroni",
                "Aleksandra Piktus",
                "Angela Fan",
                "Patrick Lewis",
                "Majid Yazdani",
                "Nicola De Cao",
                "James Thorne",
                "Yacine Jernite",
                "Vladimir Karpukhin",
                "Jean Maillard"
            ],
            "title": "Kilt: a benchmark for knowledge intensive language",
            "year": 2020
        },
        {
            "authors": [
                "Yingqi Qu",
                "Yuchen Ding",
                "Jing Liu",
                "Kai Liu",
                "Ruiyang Ren",
                "Wayne Xin Zhao",
                "Daxiang Dong",
                "Hua Wu",
                "Haifeng Wang."
            ],
            "title": "RocketQA: An optimized training approach to dense passage retrieval for opendomain question answering",
            "venue": "Proceedings of the",
            "year": 2021
        },
        {
            "authors": [
                "Colin Raffel",
                "Noam Shazeer",
                "Adam Roberts",
                "Katherine Lee",
                "Sharan Narang",
                "Michael Matena",
                "Yanqi Zhou",
                "Wei Li",
                "Peter J Liu."
            ],
            "title": "Exploring the limits of transfer learning with a unified text-to-text transformer",
            "venue": "Journal of Machine Learning Research.",
            "year": 2019
        },
        {
            "authors": [
                "Adam Roberts",
                "Colin Raffel",
                "Noam Shazeer"
            ],
            "title": "How much knowledge can you pack into the parameters of a language model",
            "year": 2020
        },
        {
            "authors": [
                "Stephen Robertson",
                "Hugo Zaragoza"
            ],
            "title": "The probabilistic relevance framework: Bm25 and beyond",
            "venue": "Foundations and Trends in Information Retrieval,",
            "year": 2009
        },
        {
            "authors": [
                "Shaden Smith",
                "Mostofa Patwary",
                "Brandon Norick",
                "Patrick LeGresley",
                "Samyam Rajbhandari",
                "Jared Casper",
                "Zhun Liu",
                "Shrimai Prabhumoye",
                "George Zerveas",
                "Vijay Korthikanti"
            ],
            "title": "Using deepspeed and megatron to train megatron-turing nlg",
            "year": 2022
        },
        {
            "authors": [
                "Ian Soboroff",
                "Shudong Huang",
                "Donna Harman"
            ],
            "title": "Trec 2018 news track overview",
            "year": 2018
        },
        {
            "authors": [
                "Emma Strubell",
                "Ananya Ganesh",
                "Andrew McCallum."
            ],
            "title": "Energy and policy considerations for modern deep learning research",
            "venue": "Proceedings of the AAAI Conference on Artificial Intelligence, volume 34, pages 13693\u201313696.",
            "year": 2020
        },
        {
            "authors": [
                "Axel Suarez",
                "Dyaa Albakour",
                "David Corney",
                "Miguel Martinez",
                "Jos\u00e9 Esquivel."
            ],
            "title": "A data collection for evaluating the retrieval of related tweets to news articles",
            "venue": "European Conference on Information Retrieval, pages 780\u2013786. Springer.",
            "year": 2018
        },
        {
            "authors": [
                "los"
            ],
            "title": "An overview of the BIOASQ",
            "year": 2015
        },
        {
            "authors": [
                "Ellen M Voorhees"
            ],
            "title": "Overview of the trec",
            "venue": "SIGIR Forum,",
            "year": 2004
        },
        {
            "authors": [
                "Henning Wachsmuth",
                "Shahbaz Syed",
                "Benno Stein"
            ],
            "title": "2004 robust retrieval track",
            "venue": "In Trec,",
            "year": 2004
        },
        {
            "authors": [
                "Hannaneh Hajishirzi"
            ],
            "title": "Fact or fiction: Verifying",
            "year": 2020
        },
        {
            "authors": [
                "Yining Wang",
                "Liwei Wang",
                "Yuanzhi Li",
                "Di He",
                "Wei Chen",
                "Tie-Yan Liu."
            ],
            "title": "A theoretical analysis of ndcg ranking measures",
            "venue": "Proceedings of the 26th annual conference on learning theory (COLT 2013), volume 8, page 6. Citeseer.",
            "year": 2013
        },
        {
            "authors": [
                "Guillaume Wenzek",
                "Marie-Anne Lachaux",
                "Alexis Conneau",
                "Vishrav Chaudhary",
                "Francisco Guzm\u00e1n",
                "Armand Joulin",
                "Edouard Grave."
            ],
            "title": "CCNet: Extracting high quality monolingual datasets from web crawl data",
            "venue": "Proceedings of the 12th Lan-",
            "year": 2020
        },
        {
            "authors": [
                "Teven Le Scao",
                "Sylvain Gugger",
                "Mariama Drame",
                "Quentin Lhoest",
                "Alexander Rush."
            ],
            "title": "Transformers: State-of-the-art natural language processing",
            "venue": "Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing: System",
            "year": 2020
        },
        {
            "authors": [
                "Ji Xin",
                "Chenyan Xiong",
                "Ashwin Srinivasan",
                "Ankita Sharma",
                "Damien Jose",
                "Paul Bennett."
            ],
            "title": "Zeroshot dense retrieval with momentum adversarial domain invariant representations",
            "venue": "Findings of the Association for Computational Linguistics: ACL 2022,",
            "year": 2022
        },
        {
            "authors": [
                "Ji Xin",
                "Chenyan Xiong",
                "Ashwin Srinivasan",
                "Ankita Sharma",
                "Damien Jose",
                "Paul N Bennett."
            ],
            "title": "Zero-shot dense retrieval with momentum adversarial domain invariant representations",
            "venue": "arXiv preprint arXiv:2110.07581.",
            "year": 2021
        },
        {
            "authors": [
                "Lee Xiong",
                "Chenyan Xiong",
                "Ye Li",
                "Kwok-Fung Tang",
                "Jialin Liu",
                "Paul Bennett",
                "Junaid Ahmed",
                "Arnold Overwijk."
            ],
            "title": "Approximate nearest neighbor negative contrastive learning for dense text retrieval",
            "venue": "arXiv preprint arXiv:2007.00808.",
            "year": 2020
        },
        {
            "authors": [
                "Zhilin Yang",
                "Peng Qi",
                "Saizheng Zhang",
                "Yoshua Bengio",
                "William W. Cohen",
                "Ruslan Salakhutdinov",
                "Christopher D. Manning."
            ],
            "title": "HotpotQA: A Dataset for Diverse, Explainable Multi-hop Question Answering",
            "venue": "Proceedings of the Conference on",
            "year": 2018
        },
        {
            "authors": [
                "HongChien Yu",
                "Chenyan Xiong",
                "Jamie Callan."
            ],
            "title": "Improving query representations for dense retrieval with pseudo relevance feedback",
            "venue": "arXiv preprint arXiv:2108.13454.",
            "year": 2021
        },
        {
            "authors": [
                "Yue Yu",
                "Chenyan Xiong",
                "Si Sun",
                "Chao Zhang",
                "Arnold Overwijk."
            ],
            "title": "Coco-dr: Combating distribution shifts in zero-shot dense retrieval with contrastive and distributionally robust learning",
            "venue": "arXiv preprint arXiv:2210.15212.",
            "year": 2022
        },
        {
            "authors": [
                "Susan Zhang",
                "Stephen Roller",
                "Naman Goyal",
                "Mikel Artetxe",
                "Moya Chen",
                "Shuohui Chen",
                "Christopher Dewan",
                "Mona Diab",
                "Xian Li",
                "Xi Victoria Lin"
            ],
            "title": "Opt: Open pre-trained transformer language models. arXiv preprint arXiv:2205.01068",
            "year": 2022
        },
        {
            "authors": [
                "Chen Zhao",
                "Chenyan Xiong",
                "Jordan Boyd-Graber",
                "Hal Daum\u00e9 III."
            ],
            "title": "Distantly-supervised evidence retrieval enables question answering without evidence annotation",
            "venue": "arXiv preprint arXiv:2110.04889.",
            "year": 2021
        },
        {
            "authors": [
                "Zexuan Zhong",
                "Tao Lei",
                "Danqi Chen."
            ],
            "title": "Training language models with memory augmentation",
            "venue": "arXiv preprint arXiv:2205.12674.",
            "year": 2022
        }
    ],
    "sections": [
        {
            "heading": "1 Introduction",
            "text": "Scaling up language models\u2014with more parameters and pretraining data\u2014improves model generalization ability on downstream applications (Raffel et al., 2019; Brown et al., 2020; Smith et al., 2022), but with diminishing return: linear improvements on downstream metrics often require exponentially more parameters and computing cost (Kaplan et al., 2020; Hoffmann et al., 2022). Hence, scaling pretrained language models in this way is economically unsustainable (Strubell et al., 2020; Bender et al., 2021; Zhang et al., 2022).\n\u2217Work partly done while at Microsoft.\nRetrieval augmented language models provide a promising alternative. They allow language models to efficiently access vast resources from an external corpus (Guu et al., 2020; Borgeaud et al., 2022) that serves as a kind of \u201cmemory\u201d they can refer to when making predictions, alleviating the need to memorize as much information in their own network parameters (Roberts et al., 2020). This open-book approach helps language models to better generalize on token prediction tasks and machine translation (Khandelwal et al., 2019; Borgeaud et al., 2022), and tasks which already involve a first-stage retrieval component, e.g., OpenQA (Borgeaud et al., 2022; Izacard et al., 2022). Existing retrieval augmentation methods usually stick to one single retrieval corpus throughout training and inference so that the retrieval component can be indirectly guided by the supervision from end tasks.\nIn this paper we improve the zero-shot generalization ability of language models using \u201cmixtureof-memory\u201d (MoMA), a new retrieval augmentation mechanism. Instead of a single corpus, MoMA retrieves documents from a \u201cmixture\u201d of multiple external corpora and enjoys the merits of a larger and more comprehensive source of knowledge. This mechanism also allows removing and/or \u201cplugging-in\u201d new corpora during inference time, when more information from the target task is revealed, or as an additional way for users to control the model. Specifically, we apply MoMA on the zero-shot dense retrieval task, which is the foundation of many important real-world applications (Thakur et al., 2021a; Kim, 2022) and also the retrieval component of recent retrieval augmented language models (Guu et al., 2020; Izacard et al., 2022). However, it is not trivial to guide a retrieval model to leverage multiple corpora. We need to jointly train the augmentation component and dense retriever using supervised relevance signals and self-mined hard negatives.\nWe instantiate MoMA with a T5-base model (Ni et al., 2022) and apply it to the dense retrieval task (Karpukhin et al., 2020). Our end task retriever uses a set of augmenting documents from the mixture-of-memories to enhance its representation of the query with important context; the retriever then uses the enhanced query representation to retrieve a final candidate set. At inference time, we plug in the target task\u2019s corpus to the memory mixture to introduce in-domain context information, without updating any parameter.\nAs a plug-in-play method, MoMA provides an flexible but powerful solution to zero-shot dense retrieval: Unlike recent state-of-the-art methods (Yu et al., 2022; Neelakantan et al., 2022), it does not require pretraining on target corpus or large-scale web corpus, enabling it to generalize to arbitrary unseen corpus without additional effort. It can also be used as an efficient alternative for recent large language model (LLM) based generative retrieval models (Gao et al., 2022). Given the target query, MoMA only involves the T5-base model for query encoding, which is significantly cheaper than querying an LLM to generate pseudo answers and re-encoding it.\nWe experimented on eighteen zero-shot dense retrieval tasks included in BEIR (Thakur et al., 2021a), the standard ZeroDR benchmark. The results demonstrate the improved zero-shot ability of MoMA. MoMA achieves comparable or even stronger performance to recent state-of-the-art dense retrieval systems with larger model scales and heavier computation costs. Our further analysis reveals that large and diverse corpora in the memory leads to the best performance; while only using a single corpus during training does not improve performance on unseen target tasks. The learning of augmentation component is also important for MoMA to utilize the diverse information from the mixture. Our analysis and case studies illustrate how MoMA leverages the plug-in memory at testing time to enrich its query representations."
        },
        {
            "heading": "2 Related Work",
            "text": ""
        },
        {
            "heading": "2.1 Retrieval Augmentation",
            "text": "Recent research has explored the retrievalaugmented language model, which aims to construct an external memory for the language model (Khandelwal et al., 2019; Zhong et al., 2022; Guu et al., 2020; Borgeaud et al., 2022; Petroni et al., 2020). It retrieves related documents or to-\nkens from an in-domain corpus as additional input to enhance the semantic representation. Despite their effectiveness, learning to retrieve useful documents to augment the language model is a challenging task, since human annotations on the usefulness of augmentation documents are costly and seldom available. The most straightforward way is to use representations from raw pretrained language models, i.e., as unsupervised dense retrieval (Guu et al., 2020; Borgeaud et al., 2022). Adapting existing dense retrieval models is another common choice (Izacard and Grave, 2020b; Lewis et al., 2020; Yu et al., 2021). A more plausible solution is to jointly learn the augmentation components end-to-end using supervision from the final task, for example, treating the augmentation as latent variables and applying EM (Zhao et al., 2021), or distilling the augmentation component from feedback of the final model (Izacard and Grave, 2020a). In a parallel work, Izacard et al. (2022) found the most effective one is attention distillation method (ADist), which trains the augmentation component using soft labels derived from the end model\u2019s attention on augmentation documents.\nThe motivation for query augmentation coincides with the query expansion methods in the traditional IR community, whereby a query is augmented by new but similar features (Carpineto and Romano, 2012). As feature selection usually requires additional semantic analysis, the efficiency and usability of traditional query expansion methods remain limited when faced with a new domain. To overcome this, recent work relies on dense retrieval results to expand the query (Yu et al., 2021). The retrieved relevant documents serve as pseudo relevance feedback signals for the model, which are concatenated with the original query as the augmented model input. Our work augments queries with feedback from multiple corpora and learns to select important augmentation documents automatically."
        },
        {
            "heading": "2.2 Zero-shot Dense Retrieval",
            "text": "Dense retrieval models trained on a resource rich source tasks, e.g., web search, usually do not perform as well when zero-shot transferred to other domains (Thakur et al., 2021b). Xin et al. (2021) analyzed the challenge of shifting between training and testing domains, and leveraged domain-invariant learning to mitigate the gap. Another common approach is to first generate domain-specific pseudo\nlabels for each task, and then use them to train dense retriever (Thakur et al., 2021b; Wang et al., 2022). Additionally, continuous pretraining the language model also improves its generalization ability in ZeroDR (Izacard et al., 2021). Following works (Izacard et al., 2021; Yu et al., 2022) further contrastively pretrained the retriever on target or external corpus with a sentence matching loss. One significant drawback of them is requiring the target or external corpus as part of the training corpus, which prohibits the plug-in-play feature when exposed to new data. Besides, stacking all target datasets for model pretraining also increases computation costs to a notable degree. On BEIR benchmarks which contain 18 target tasks, it enlarges the training corpus to 7 times larger.\nOther methods seek better generalization ability in ZeroDR from various resources, for example, combining with sparse retrieval to introduce exact match signals (Formal et al., 2021) or using multiple vectors per documents for term-level matching (Khattab and Zaharia, 2020a). More recent work simply changes backbone models to larger language models, such as T5-XXL or cpttext-XL (Ni et al., 2021; Neelakantan et al., 2022). Some rely on stronger instruction-guided generative language models (Gao et al., 2022), which match documents with model-generated query answers. Overall, methods relying on large language models will incur heavier costs on memory consumption and computation, and calling generative model API may also cause latency issues. Instead of chasing stronger backbone models, our goal in this paper is to provide an efficient plug-in-play alternative for them."
        },
        {
            "heading": "3 Method",
            "text": "In this section we first describe our Mixture-ofMemory Augmentation. Then we discuss how it is jointly learned with the end system and enables plug-in memory at inference time."
        },
        {
            "heading": "3.1 Mixture-of-Memory Augmentation",
            "text": "Before going to the details of MoMA, we first recap some preliminaries in ZeroDR.\nPreliminaries. The dense retrieval (DR) task aims to find relevant documents d from a corpus C for the given query q by representing them in a shared embedding space. Specifically, the retrieval score in DR is often calculated as:\nf(q, d) = q \u00b7 d; q = g(q);d = g(d). (1)\nIt uses dot product as the scoring function to match the embeddings q and d, which is known to support efficient approximate nearest neighbor search (ANN) (Johnson et al., 2019). A pretrained language model is often the encoder of choice g(). We use the ST5-EncDec variant of Sentence-T5 (Ni et al., 2022):\ng(x) = Dec(Enc(x)), (2)\nwhich feeds in the text sequence (prepended by a special [CLS] tokens) to the encoder of T5, Enc(), and uses the output representation of the [CLS] token from the decoder, Dec(), as the text representation. This naturally leverages the attention from decoder to encoder at all Transformer layers (Raffel et al., 2019), as a fine-grained information gathering mechanism.\nThe training of dense retrieval systems often applies standard ranking loss and pairs the relevant documents d+ \u2208 D+ for each query q with hard negatives d\u2212 \u2208 D\u2212:\nL = \u2211 q \u2211 d+\u2208D+ \u2211 d\u2212\u2208D\u2212 l(f(q, d+), f(q, d\u2212));\nD\u2212 \u223c ANNCf(q,\u25e6) \\D +. (3)\nEqn. 3 uses ANCE hard negatives, which are the top-retrieved documents from C using the retriever itself (Xiong et al., 2020). The loss function l() can be any standard ranking loss such as cross entropy. A ZeroDR model is trained on qs and documents ds \u2208 Cs from a source task, often web search, and tested on target tasks qt and Ct; supervision signals are only present from the source.\nMixture-of-Memory. The key idea of (document-based) retrieval augmented language models is to enrich the representation g(q) with additional contextual input for the model, i.e., augmentation documents da retrieved from an external memory M. Instead of using a single document corpus, MoMA uses multiple corpora to provide richer and more diverse external resources for augmentation. For example, M can be composed by the source corpus Cs, a general encyclopedia, a domain specific knowledge graph, etc. Then we can retrieve the augmentation documents Da :\nDa = ANNMfa(x,\u25e6); M = {C1, ..., CM}. (4)\nThis augmentation component uses another dense retriever fa(), which also adopts the Sentence-T5 architecture. Note that instead of retrieving Da\nEnc Dec\nseparately from M different ANN memory sources and merging results, Eqn. 4 combines them into one ANN index. This requires the augmentation component fa() to be flexible enough to handle various corpora in the mixture.\nUsing the encoder-decoder architecture for g() in Eqn. 2 enables a simple extension to incorporate the augmentation documents using the fusionin-decoder (FiD) mechanism (Izacard and Grave, 2020b):\ngMoMA(q) = Dec(Enc(q),Enc(da1), ...,Enc(d a K));\nDa = {da1, ..., daK}. (5)\nIt feeds in the K augmentation documents separately to the T5 encoder of g(). Then it fuses the encoded documents together with Enc(q) using one decoder that attends to all encoded vectors, as illustrated in Figure 1.\nThe FiD approach in Eqn 5 is a nice balance of efficiency and capacity when modeling multiple text sequences (Izacard and Grave, 2020b). It is more efficient than concatenating all text pieces together, while also remaining expressive enough to model the nuances from many sequences. (Izacard and Grave, 2020a; Izacard et al., 2022).\nWhen instantiating MoMA in the dense retrieval setting, we focus on augmenting the query representation q, as queries are often short, ambiguous, and benefit more from additional contextual information (Lavrenko and Croft, 2017; Yu et al., 2021). This leads to the following definition of MoMA:\nfMoMA(q, d) =qa \u00b7 d; qa = gMoMA(q),d = g(d), (6)\nusing the construction of gMoMA() in Eqn. 5 upon the augmentation documents defined in Eqn. 4."
        },
        {
            "heading": "3.2 Joint Learning in MoMA and Inference with Plug In Memory",
            "text": "MoMA has two sets of parameters to learn, in the main model fMoMA() and the augmentation com-\nponent fa(). Both have their own independent parameters. The two components are bridged by the augmentation documents, which are retrieved by fa() from M and used by fMoMA() to produce query representation qa.\nMain Model Learning. Given the relevance labels from the source task and an augmentation model, training fMoMA() is straightforward. We can use the standard dense retrieval training to finetune the enriched query encoder gMoMA() and the document encoder g(): LMoMA = \u2211\nqs,d+,d\u2212\nl(fMoMA(qs, d+), fMoMA(qs, d\u2212));\nd+ \u2208 Ds+, d\u2212 \u2208 Ds\u2212 (7) Ds\u2212 \u223c ANNCsfMoMA(qs,\u25e6) \\D s+. (8)\nThe training signals come from the source task, including qs, its relevant documents Ds+, and ANCE hard negatives Ds\u2212 retrieved from the source corpus Cs.\nAugmentation Learning. Training fa() is challenging as it is hard to label whether an augmentation document is useful. Propagating gradients from the final loss to fa() is also prohibitive as the retrieval operation in Eqn. 4 is discrete. Fortunately, recent research found the attention scores from the FiD decoder to each encoded inputs (Eqn. 5) are good approximations to the usefulness of augmentation documents (Izacard and Grave, 2020a):\nFidAtt(dai ) = \u2211 pos \u2211 head AttDec\u2192Enc(gMoMA(dai )).\n(9)\nIt sums the attentions from gMoMA()\u2019s special token at the decoder\u2019s [CLS] position over all layers, input positions, and attention heads. Ideally, higher FidAtt() is assigned to dai that provides useful contextual information.\nPreviously, FidAtt scores are often used as soft labels for the augmentation model (Izacard and Grave, 2020a; Izacard et al., 2022). Doing so with memory mixtures is risky as it is too sparse and overfits memory resource that appears earlier in the training, which are the only ones available for the decoder to attend on. To improve the learning robustness, we introduce ANCE-style hard negative mining to train the augmentation component as well.\nFirst, we formulate the positive set of augmenta-\ntion documents as:\nDa+ = Ds+ \u222a Top-NFidAtt(dai ),Da . (10)\nwhich combines relevant documents Ds+ and the augmenting ones that received N-highest attention scores from gMoMA(). Then we pair them with hard negatives to formulate the training of fa() as:\nLa = \u2211 qs \u2211 d+\u2208Da+ \u2211 d\u2212\u2208Da\u2212 l(fa(qs, d+), fa(qs, d\u2212));\n(11)\nDa\u2212 \u223c ANNMfa(qs,\u25e6) \\D a+. (12)\nNotice the negatives for fa() have comprehensive coverage from multiple corpora.\nIterative Training. The learning of fMoMA() and fa() is an iterative process that fits naturally into the training procedure of dense retrieval training with hard negatives. We follow the standard iterations in ANCE and construct the t-th training episode of MoMA:\n1. Construct hard negatives Ds\u2212 via Eqn. 8 using weights fMoMAt\u22121 () from the last episode;\n2. Retrieve augmentation Da via Eqn. 4 using weights fat\u22121() from the last episode;\n3. Train fMoMAt () as Eqn. 7;\n4. Formulate new positive augmentation documents Da+, using updated attention scores from fMoMAt (), and mine negative augmentation documents Da\u2212 using fat\u22121();\n5. Train fat () following Eqn. 11.\nBoth fMoMA0 () and f a 0 () can be initialized with a BM25 warmed-up T5 retriever. Steps 1 and 3 above are inherited from standard dense retrieval training. The rest are introduced by MoMA. The additional computation in the training side mainly resides updating the index for the memory mixture, a standard cost in retrieval-augmented language models (Guu et al., 2020; Izacard et al., 2022).\nZero-Shot Retrieval with Plug in Memories. To perform zero-shot retrieval on unseen tasks, MoMA first retrieves augmented documents using fa() from M for the target query qt, and retrieves target documents dt \u2208 Ct with the augmented model fMoMA() without changing any model parameters. MoMA allows fa() to attend over the target corpus as well if it is plugged in: M =\nM\u222aCt\\Cs, which conveys in-domain information. The augmenting corpus can also be engineered by users manually to inject their preference or domain knowledge, e.g., as \u201cmemory engineering\u201d. In this work we focus on swapping out the source corpus for the target corpus; we leave other explorations for future work."
        },
        {
            "heading": "4 Experimental Methodologies",
            "text": "Datasets. We choose the MS MARCO passage dataset (Bajaj et al., 2016) as the source domain dataset, whereas the target domains are from the 18 datasets in BEIR (Thakur et al., 2021b) benchmark, which include including biomedical, scientific and financial texts. More details can be found in Appendix A.3. The evaluation metric NDCG@10 is the same with BEIR benchmark, which measures Normalized Discounted Cumulative Gain (Wang et al., 2013) of top 10 prediction. The higher NDCG@10 value indicates better performance.\nAugmenting Corpora. During training, the mixture-of-memory is composed of source training corpus (MARCO), Wikipedia and a medical knowledge graph. We use the Wikipedia chunk prepossessed by (Karpukhin et al., 2020) without further processing1. The medical knowledge graph is extracted from the Medical Subject Headings (MeSH)2, an open-source database for indexing and cataloging of biomedical and health-related information. Since it is hierarchical in structure, we linearize it by concatenating spans with text information. During testing, we directly replace MARCO with the corresponding document sets from BEIR. Each task from BEIR is augmented independently. More dataset and preprocessing details can be found in Appendix A.3.\nBaselines and Model Choices. We compare our MoMA with standard sparse and dense retrieval models on BEIR. We also compare MoMA with advanced approaches that are specifically designed for zero-shot generalization. They involve techniques that are not directly comparable with this paper, including pretraining on extra data, in-domain continuous pretraining, and generating target pairs using another pretrained generative model. Besides, some baselines use larger scale language model as their backbone. We list the details of baselines in Appendix A.4.\nAs a plug-in-and-play method, MoMA can be\n1https://huggingface.co/datasets/wiki_dpr 2https://www.ncbi.nlm.nih.gov/mesh/\ncombined with other techniques. We initiate MoMA on two dense retrieval models. The primitive MoMA (T5-ANCE) is built on the original T5 model checkpoint and optimized iteratively with ANCE-style (Xiong et al., 2020) hard negatives. By comparing it with T5-ANCE, we can clearly observe the performance gain brought by MoMA. To demonstrate it can integrate techniques from other models to achieve higher performances, we initiate MoMA on a better pretrained model. Following coCondenser (Gao and Callan, 2022), we continuously trained the original T5 model on the MARCO document corpus using a sentencelevel contrastive loss, combined with the original masked language modeling loss. We then performed the same MoMA training on top of the continuously pretrained T5 checkpoint and denoted it as MoMA (coCondenser). The only difference between MoMA (T5-ANCE) and MoMA (coCondenser) is the initialized model start point. We compare their pretraining details with other models in Table 2. Unlike other work (Yu et al., 2022), as a plug-in-play design, we did not include target datasets and augmenting corpora in the contrastive pretraining stage. Since MARCO contains only 0.5M documents, it adds fewer computational overhead compared to other methods listed in the table, e.g., Contriever.\nImplementation Details. For MoMA, we use the T5-base (Raffel et al., 2019) architecture (12- layer Transformer, 768 hidden size) by directly loading the checkpoint from HuggingFace3. To warm up the language model for dense retrieval, we\n3https://huggingface.co/t5-base\nfollowed (Xiong et al., 2020) to further train it using BM25 negatives for 10 epochs. After warming up, we jointly trained the two components for three episodes, each episode including three training epochs. After three joint episodes, the end retriever reaches the best performance on MSMARCO, so we select this checkpoint for evaluation. The ratio between positive and hard negative pairs is 1:7 for both models. The main hyperparameters in MoMA include the total number of grounding documents K and the attention threshold number N in Equation 10. We directly set K=10 and N=5 without any parameter tuning. More details on hyperparameters and experimental settings can be found in Appendix A.5."
        },
        {
            "heading": "5 Evaluation Results",
            "text": ""
        },
        {
            "heading": "5.1 Zero-Shot Retrieval Accuracy and",
            "text": "Efficiency\nThe retrieval accuracy of MoMA and baselines are listed in Table 1. Besides baselines of similar parameter count, we also include larger models (GTRlarge) or those using multiple vectors per document (ColBERT). MoMA (coCondenser) shows the strongest zero-shot accuracy against previous stateof-the-art methods that do continuous contrastive pretraining (coCondenser), generate pseudo labels (GenQ), or consume additional training signals in both continuous pretraining and finetuning phrases (GTRbase). MoMA (T5-ANCE) also achieved nearly comparable zero-shot accuracy against larger models like GTRlarge, and ColBERT, which scales up the number of vectors per documents (one per token). This confirms that retrieval-"
        },
        {
            "heading": "Operation Offline Online",
            "text": "augmentation provides another path to improve language models\u2019 generalization ability besides scaling up. MoMA (T5-ANCE) also outperforms T5-ANCE, which MoMA (T5-ANCE) uses as a subroutine for retrieval augmentation, on all but one retrieval task, showing the improved generalization ability from plug-in mixture of memory.\nWe evaluate the efficiency of MoMA in two stages: offline model training and online inference. In offline training from Table 2, MoMA (T5-ANCE) is significantly cheaper than other methods as we do not require pretraining on large external corpora, which saves hundreds of hours training time. MoMA (condenser) additionally pretrain on MARCO for 50k steps, which is far fewer than the other compared methods. In online inference, similar with other retrieval enhanced language models, MoMA imposes a necessary cost of retrieval augmented model upon the baseline T5-ANCE. We further provide detailed efficiency analysis on MoMA in Table 3. The online latency is measured on one query and 100 retrieved documents. Due to the query augmentation, query encoding is more costly and takes about 55ms per query. Even with the augmentation cost, the full dense retrieval total online inference cost is 64ms, only slightly above the BM25 retrieval latency. The ANN retrieval is very efficient, only takes 9ms. In addition, the complexity of ANN retrieval is sublinear to the corpus size, in most ANN framework such as FAISS. Thus the extra round of ANN retrieval operation in MoMA is not the bottleneck even when the size of memory mixture scales up."
        },
        {
            "heading": "5.2 Performance with Different Memories",
            "text": "Table 4 evaluates how MoMA behaves under different combinations of external memories. Unsurprisingly, using a single out-of-domain memory for retrieval augmentation does not help, for example, even though MARCO is the source domain corpus, solely grounding on it reduces zero-shot accuracy. MeSH as the sole augmenting corpus also lowers performance, even on some medical retrieval tasks such as BioASQ. Interestingly, when we expand the memory to include MARCO, Wiki, and MeSH, but keep the target corpus excluded (w/o Target), MoMA exhibits better accuracy compared to the no-memory version. Our conclusion is that more memory sources achieves better generalization, especially when no target domain information is available.\nIn the Full setting, the 3-memory mixture of MARCO, Wiki, and MeSH is jointly learned with final task at training time. At test time, MARCO is swapped out for the target corpus. The Full improves zero-shot accuracy over both the w/o Target setting (where the target corpus is excluded at test time), and the w/o Learning setting (wherein the augmentation component is not learned). As expected, plugging in the target corpus at test time is the most valuable source of generalization power. It is also the most realistic, as access to the target corpus may only be available at testing time."
        },
        {
            "heading": "5.3 Effect of Memory Mixture Learning",
            "text": "To study the effect of our joint learning mechanism on the memory mixture, we compare it with recent state-of-the-art Attention Distillation (ADist), which is first used in Izacard and Grave (2020a) and recently updated in a parallel work Izacard et al. (2022). It jointly trains the augmentation model using attention scores from the end language model as pseudo-labels. We also enrich ADist with relevance labels from MARCO for more direct supervision (ADist + MSMARCO rel). To exclude the effect of contrastive pretraining, we choose MoMA (T5-ANCE) as our own method for comparison. We also tried using a trained ANCE retriever without further distilling and denote it as w/o Distilling (T5-ANCE). The performances of these joint learning methods are listed in Table 5. The results show that ADist, either standalone or enriched with MARCO labels, does not improve the final accuracy compared to using a supervised dense retriever T5-ANCE. The main difference is\nthat ADist learns a soft attention score distribution, while the supervised retriever is trained effectively using hard negative sampling (Xiong et al., 2020). Jointly learning using soft labels without hard negatives downgraded the augmentation accuracy. Hence, MoMA is a simple technique to learn the end task signals via the attention scores together with hard negatives, which improves quality over a supervised retriever alone.\nTo further illustrate the joint training process, we track the attention scores of documents from different memory sources as well as their ratio in the augmentation set in Figure 2. We also split MARCO documents by whether they are labeled as Relevant (Rel) for the corresponding query.\nFirstly, MoMA learns to increasingly attend to, and retrieve, relevant documents from the memory mixture throughout training. In Figure 2a, more attention is paid to MARCO Relevant documents than to any other type in the memory. Although the number of MARCO Relevant documents is not significant as a percentage of the augmenting set in Figure 2c, a query level analysis confirms that\npercentage of queries having at least one relevant document in the augmenting set increases from 46% in Epi-0 to 62% in Epi-2.\nThis apparent discrepancy can be explained by the fact that MARCO has only one relevant label per query on average, leaving plenty of room for other types of documents to be included in the augmenting set.\nSecondly, the amount of attention paid to certain types of documents by MoMA is positively correlated with their representation in the augmenting set. This confirms that the joint learning effectively conveys the feedback signals from the end model to the augmentation component. For instance, in Figure 2a, MoMA pays a high level of attention to MARCO Other documents, a signal reflected in the composition of its augmentation set in Figure 2c. Even though MARCO Other documents were not labeled relevant for the query, they can still prove to be valuable as an augmenting document because they may contain partial information that helps query understanding (Lavrenko and Croft, 2017) or it was simply not annotated\nin MARCO\u2019s sparse labels (Bajaj et al., 2016). In comparison, the correlation of the two in ADist is weak as the model seems to include 60% augmenting documents from MeSH, far greater than the fraction of medical queries in MARCO."
        },
        {
            "heading": "5.4 Generalization of Plug-In Memory",
            "text": "In the previous section, we observed how MoMA learns to attend to, and retrieve, informative documents from memories on which it was trained. In this section, we examine the zero-shot behavior of MoMA (T5-ANCE) on new corpora plugged-in at test time (keeping Wiki and MeSH as before).\nFigure 3 compares documents from the pluggedin target versus the remaining memory mixture in terms of membership in the augmenting set (Doc Ratio) and attention. Again, on all tasks, MoMA (T5-ANCE) heavily attends to \u2013 and successfully retrieves \u2013 in-domain documents, even if those indomain documents were only just plugged in. This confirms that the augmentation model achieves the zero-shot ability to capture relevant information from unseen corpora.\nIn the medical domain, the model pays more attention to MeSH documents, especially on TRECCovid task since MeSH includes high quality updated information related to COVID-19. Wikipedia documents received more attention on the Wiki-\ncentric tasks like FEVER, as expected. Some tasks may need a small amount of precise information from Wikipedia to answer the detailed question, e.g. in HotpotQA. Similar with the training process, there is a non-trivial correspondence between attention score of a memory and its membership in the augmentation set."
        },
        {
            "heading": "6 Conclusion",
            "text": "In this paper we propose a new plug-in mixtureof-memory mechanism for the retrieval augmented language models to improve their zero-shot ability on the dense retrieval task. To learn the memory mixture we develop a new joint learning approach that trains the augmentation component using the positive signals from the end task, the language model\u2019s attention scores, and hard negatives retrieved from the mixture of augmentation corpora. This leads to our final model MoMA (T5ANCE) and MoMA (coCondenser) that achieve strong zero-shot accuracy on 18 retrieval tasks included in BEIR. Our analysis shows the importance of augmenting with diverse memory sources and indomain information for robust generalization. We hope our findings can inspire more future research in better augmenting language models, to provide other alternatives to achieve generalization ability beyond solely relying on model scale."
        },
        {
            "heading": "Limitations",
            "text": "Although MoMA (T5-ANCE) and MoMA (coCondenser) achieve strong zero-shot performances, we mainly verify their efficacy from the empirical performances on BEIR tasks, where the target corpora, Wiki and MARCO serve as readily available retrieval sources. In a real-world scenario, the grounding corpora usually need to be customized according to query domains and user needs. Thus, how to choose effective grounding corpora and efficiently evaluate their relative contribution remain an open problem. These analyses will go beyond our empirical settings and reveal a wider application scenario of MoMA."
        },
        {
            "heading": "Ethics Statement",
            "text": "All data in this study are publicly available and used under ethical considerations. Text and figures in the paper are used for illustration only, they do not represent the ethical attitude of the authors."
        },
        {
            "heading": "A Appendix",
            "text": ""
        },
        {
            "heading": "A.1 Performance on Source Domain",
            "text": "Figure 4 demonstrates the MRR@10 on MSMARCO for the end retriever and augmentation component of MoMA (coCondenser) over different training epochs. We make the following observations. Firstly, the augmentation component improves on the source domain even though it is not directly optimized with relevance labels. Since helpful augmentation documents are usually strongly related to the query, the augmentation component benefits from such indirect relevance signals. Secondly, the end retriever monotonically benefits from information collected by the augmenting component, indicating that the two components mutually enhance each other in the joint learning process. We further compare MoMA with relevant baselines on MSMARCO in Table 6. The comparison verifies that MoMA also achieves better performance on the source domain retrieval tasks."
        },
        {
            "heading": "A.2 Case Studies",
            "text": "Table 7 shows examples of how augmenting documents chosen by MoMA can provide valuable contextual information for the query. The first example is a training query from MARCO, where the augmenting documents help disambiguate the query word \"rating\". In the second one, documents from the official Wiki and HotpotQA\u2019s Wiki corpus are descriptions of the two entities in HotpotQA\u2019s comparison question. It illustrates how MoMA provides more comprehensive augmentation by incorporating information from different sources. The last query shows the benefit of the in-domain plugin corpus as it brings in very specific information about the query (AND-1/Ctf4) that is hard to find elsewhere."
        },
        {
            "heading": "A.3 Datasets Details",
            "text": "Evaluation Datasets Target domain datasets used in our experiments are collected in the BEIR benchmark (Thakur et al., 2021b)4 and include the following domains:\n\u2022 Open-domain Question Answering (QA): HotpotQA (Yang et al., 2018), NQ (Kwiatkowski et al., 2019), and FiQA (Maia et al., 2018).\n\u2022 Bio-Medical Information Retrieval: TRECCOVID (Voorhees et al., 2021), NFCorpus (Boteva et al., 2016), and BioASQ (Tsatsaronis et al., 2015).\n\u2022 Argument Retrieval: Webis-Touch\u00e92020 (Bondarenko et al., 2020) and ArguAna (Wachsmuth et al., 2018).\n\u2022 News Retrieval: TREC-NEWS (Soboroff et al., 2018) and Robust04 (Voorhees et al., 2004).\n\u2022 Tweet Retrieval: Signal-1m (Suarez et al., 2018).\n\u2022 Duplicate Question Retrieval: Quora (Thakur et al., 2021b) and CQADupStack (Hoogeveen et al., 2015).\n\u2022 Entity Retrieval: DBPedia (Hasibi et al., 2017)\n\u2022 Citation Prediction: SCIDOCS (Cohan et al., 2020)\n\u2022 Fact Checking: SciFact (Wadden et al., 2020), FEVER (Thorne et al., 2018), and ClimateFEVER (Diggelmann et al., 2020)\nWe list the statistics of the BEIR benchmark in Table 8.\nAugmenting Corpora Corpus size We first introduce more details on how we preprocessed the Medical Subject Headings (MeSH) Database. We select text information from the Qualifier Record Set and Descriptor Record Set. Each set contains multiple <Concept> elements, which is composed of three sub-elecments, i.e., <ConceptName>, <ScopeNote> and <TermList>. Among the sub-elecments, <ScopeNote> is the major textual information source, which is usually a short description to a medical term or phenomenon. We directly consider each <ScopeNote> as a document entry and concatenate it with corresponding <ConceptName>.\nWe list the statistics of the augmenting corpora in Table 9.\n4https://github.com/beir-cellar/beir"
        },
        {
            "heading": "A.4 Baselines",
            "text": "We use the baselines from the current BEIR leaderboard (Thakur et al., 2021b) and recent papers. These baselines can be divided into four groups: dense retrieval, dense retrieval with generated queries5, lexical retrieval and late interaction.\nDense Retrieval For dense retrieval, the baselines are the same dual-tower model as ours. We consider DPR (Karpukhin et al., 2020), ANCE (Xiong et al., 2020), T5-ANCE, coCondenser (Gao and Callan, 2022) and one recentlyproposed model GTR (Ni et al., 2021) with different size configuration in this paper.\n\u2022 DPR uses a single BM25 retrieval example and in-batch examples as hard negative examples to train the model. Different from the original paper (Thakur et al., 2021b) that train the DPR on QA datasets, we train DPR on MS MARCO (Bajaj et al., 2016) Dataset for fair comparison. Notice that this also lead to better results according to Xin et al. (2022).\n5We separate them from dense retrieval since they usually rely on Seq2seq models to generate pseudo query-document pairs, and they train a model for each dataset independently instead of using a single model for all datasets.\n\u2022 ANCE constructs hard negative examples from an ANN index of the corpus. The hard negative training instances are updated in parallel during fine-tuning of the model. The model is a RoBERTa (Liu et al., 2019) model trained on MS MARCO for 600k steps.\n\u2022 T5-ANCE Different with default ANCE setting, we replace the backbone language model RoBERTa with T5-base. All the other model settings are the same with the original ANCE. We include this baseline because as a subroutine for MoMA, it could be viewed as an ablation without memory augmentation. We can directly observe the impact of plug-in mixture of memory by comparing T5-ANCE with MoMA.\n\u2022 coCondenser is a continuous pre-trained model based on BERT, with the equivalent amount of parameters to BERT-base. It enhances the representation ability of [CLS] token by changing the connections between different layers of Transformer blocks. Fine-tuning of coCondenser uses BM25 and self-mined negatives.\n\u2022 Contriever conducts unsupervised contrastive pretraining with data augmentations and momentum queues on Wikipedia and the larger CCNet (Wenzek et al., 2020) corpora for 500k steps.\n\u2022 GTR initializes the dual encoders from the T5 models (Raffel et al., 2019). It is first pre-trained on Community QA6 with 2 billion questionanswer pairs then fine-tuned on NQ and MS Marco dataset. In addition, they use the hard negatives released by RocketQA (Qu et al., 2021) when finetuning with MS Marco data and the hard negatives release by (Lu et al., 2021) for Natural Questions. GTRbase leverages the same T5base model as MoMA, while GTRlarge is based on T5-large, which is not directly comparable to our method as it triples the parameters.\nDense Retrieval with Generated Queries GenQ first fine-tunes a T5-base (Raffel et al., 2019)\n6Unfortunately, this corpus has not been released by the authors."
        },
        {
            "heading": "Datasets Corpus Size Avg. Doc Length",
            "text": "model on MS MARCO for 2 epochs and then generate 5 queries for each passage as additional training data for the target domain to continue to fine-tune the TAS-B (Hofst\u00e4tter et al., 2021) model.\nLexical Retrieval Lexical retrieval is a score function for token matching calculated between two high-dimensional sparse vectors with token weights. BM25 (Robertson et al., 2009) is the most commonly used lexical retrieval function. We use the BM25 results reported in Thakur et al. (2021b) for comparison.\nLate Interaction We also consider a late interaction baseline, namely ColBERT (Khattab and Zaharia, 2020b). The model computes multiple contextualized embeddings for each token of queries and documents, and then uses a maximum similarity function to retrieve relevant documents. This type of matching requires significantly more disk space for indexes and has a higher latency."
        },
        {
            "heading": "A.5 Detailed Experimental Settings and hyperparameters",
            "text": "Our implementation uses PyTorch (Paszke et al., 2019) with Hugging Face Transformers (Wolf et al., 2020). We optimize the model using\nAdamW (Loshchilov and Hutter, 2019) with a peak learning rate at 5e-6, weight decay of 0.01, and linear learning rate decay. The global batch size is set to 256. The maximum length of query and passage are set to 32 and 128 respectively. We summarize all hyperparameter settings in Table 10. The model is trained with 8 Nvidia A100 80GB GPUs and FP16 mixed-precision training. The total running time is 6.6 hrs for three episodes of augmentation component training and 6.3 hrs for end retriever training. We detail the training time of each episode in Table 11.\nWhen evaluating on the BEIR benchmark, we follow the setting in GTR (Ni et al., 2021), which use sequences of 64 tokens for the questions and 512 for the documents in all datasets except TrecNews, Robust-04 and ArguAna. In particular, we set the document length to 768 for Trec-News and Robust-04. For ArguAna, we set both question and document length to 128. The above length setting is in accordance to the average query and document lengths in these datasets."
        },
        {
            "heading": "Stage Augmentation Component End Retriever",
            "text": ""
        }
    ],
    "title": "Augmenting Zero-Shot Dense Retrievers with Plug-in Mixture-of-Memories",
    "year": 2023
}