{
    "abstractText": "The problem of minimizing the maximum of N convex, Lipschitz functions plays significant roles in optimization and machine learning. It has a series of results, with the most recent one requiring O(N\u03b5\u22122/3 + \u03b5\u22128/3) queries to a first-order oracle to compute an \u03b5-suboptimal point. On the other hand, quantum algorithms for optimization are rapidly advancing with speedups shown on many important optimization problems. In this paper, we conduct a systematic study for quantum algorithms and lower bounds for minimizing the maximum of N convex, Lipschitz functions. On one hand, we develop quantum algorithms with an improved complexity bound of \u00d5( \u221a N\u03b5\u22125/3 + \u03b5\u22128/3).1 On the other hand, we prove that quantum algorithms must take \u03a9\u0303( \u221a N\u03b5\u22122/3) queries to a first order quantum oracle, showing that our dependence on N is optimal up to poly-logarithmic factors.",
    "authors": [
        {
            "affiliations": [],
            "name": "MAXIMAL LOSS"
        },
        {
            "affiliations": [],
            "name": "Hao Wang"
        },
        {
            "affiliations": [],
            "name": "Chenyi Zhang"
        },
        {
            "affiliations": [],
            "name": "Tongyang Li"
        }
    ],
    "id": "SP:ede82cb215a2d52fdb4826d0662c454d4b4a464f",
    "references": [
        {
            "authors": [
                "REFERENCES Zeyuan"
            ],
            "title": "Allen-Zhu. Katyusha: The first direct acceleration of stochastic gradient methods",
            "venue": "The Journal of Machine Learning Research,",
            "year": 2017
        },
        {
            "authors": [
                "Yossi Arjevani",
                "Yair Carmon",
                "John C. Duchi",
                "Dylan J. Foster",
                "Ayush Sekhari",
                "Karthik Sridharan"
            ],
            "title": "Second-order information in non-convex stochastic optimization: Power and limitations",
            "venue": "In Conference on Learning Theory,",
            "year": 2020
        },
        {
            "authors": [
                "Yossi Arjevani",
                "Yair Carmon",
                "John C. Duchi",
                "Dylan J. Foster",
                "Nathan Srebro",
                "Blake Woodworth"
            ],
            "title": "Lower bounds for non-convex stochastic optimization",
            "venue": "Mathematical Programming,",
            "year": 2022
        },
        {
            "authors": [
                "Brandon Augustino",
                "Giacomo Nannicini",
                "Tam\u00e1s Terlaky",
                "Luis F. Zuluaga"
            ],
            "title": "Quantum interior point methods for semidefinite optimization, 2021",
            "year": 2021
        },
        {
            "authors": [
                "Aharon Ben-Tal",
                "Dick Den Hertog",
                "Anja De Waegenaere",
                "Bertrand Melenberg",
                "Gijs Rennen"
            ],
            "title": "Robust solutions of optimization problems affected by uncertain probabilities",
            "venue": "Management Science,",
            "year": 2013
        },
        {
            "authors": [
                "Hans-Georg Beyer",
                "Bernhard Sendhoff"
            ],
            "title": "Robust optimization\u2013a comprehensive survey",
            "venue": "Computer Methods in Applied Mechanics and Engineering,",
            "year": 2007
        },
        {
            "authors": [
                "Adam Bouland",
                "Yosheb Getachew",
                "Yujia Jin",
                "Aaron Sidford",
                "Kevin Tian"
            ],
            "title": "Quantum speedups for zero-sum games via improved dynamic gibbs sampling, 2023",
            "year": 2023
        },
        {
            "authors": [
                "Fernando G.S.L. Brand\u00e3o",
                "Krysta M. Svore"
            ],
            "title": "Quantum speed-ups for solving semidefinite programs",
            "venue": "IEEE 58th Annual Symposium on Foundations of Computer Science (FOCS),",
            "year": 2017
        },
        {
            "authors": [
                "Fernando G.S.L. Brand\u00e3o",
                "Amir Kalev",
                "Tongyang Li",
                "Cedric Yen-Yu Lin",
                "Krysta M. Svore",
                "Xiaodi Wu"
            ],
            "title": "Quantum SDP solvers: Large speed-ups, optimality, and applications to quantum learning",
            "venue": "In Proceedings of the 46th International Colloquium on Automata, Languages, and Programming,",
            "year": 2019
        },
        {
            "authors": [
                "Gilles Brassard",
                "Peter H\u00f8yer",
                "Michele Mosca",
                "Alain Tapp"
            ],
            "title": "Quantum amplitude amplification and estimation",
            "venue": "Contemporary Mathematics,",
            "year": 2002
        },
        {
            "authors": [
                "S\u00e9bastien Bubeck",
                "Qijia Jiang",
                "Yin-Tat Lee",
                "Yuanzhi Li",
                "Aaron Sidford"
            ],
            "title": "Complexity of highly parallel non-smooth convex optimization",
            "venue": "In Advances in Neural Information Processing Systems,",
            "year": 2019
        },
        {
            "authors": [
                "Brian Bullins"
            ],
            "title": "Highly smooth minimization of non-smooth problems",
            "venue": "In Conference on Learning Theory,",
            "year": 2020
        },
        {
            "authors": [
                "Yair Carmon",
                "John C. Duchi",
                "Oliver Hinder",
                "Aaron Sidford"
            ],
            "title": "Lower bounds for finding stationary points I",
            "venue": "Mathematical Programming,",
            "year": 2020
        },
        {
            "authors": [
                "Yair Carmon",
                "Arun Jambulapati",
                "Qijia Jiang",
                "Yujia Jin",
                "Yin Tat Lee",
                "Aaron Sidford",
                "Kevin Tian"
            ],
            "title": "Acceleration with a ball optimization oracle",
            "venue": "Advances in Neural Information Processing Systems,",
            "year": 2020
        },
        {
            "authors": [
                "Yair Carmon",
                "Arun Jambulapati",
                "Yujia Jin",
                "Aaron Sidford"
            ],
            "title": "Thinking inside the ball: Near-optimal minimization of the maximal loss",
            "venue": "In Conference on Learning Theory,",
            "year": 2021
        },
        {
            "authors": [
                "Shouvanik Chakrabarti",
                "Andrew M. Childs",
                "Tongyang Li",
                "Xiaodi Wu"
            ],
            "title": "Quantum algorithms and lower bounds for convex optimization",
            "year": 2020
        },
        {
            "authors": [
                "Andrew M. Childs",
                "Jiaqi Leng",
                "Tongyang Li",
                "Jin-Peng Liu",
                "Chenyi Zhang"
            ],
            "title": "Quantum simulation of real-space",
            "venue": "dynamics. Quantum,",
            "year": 2022
        },
        {
            "authors": [
                "Kenneth L. Clarkson",
                "Elad Hazan",
                "David P. Woodruff"
            ],
            "title": "Sublinear optimization for machine learning",
            "venue": "Journal of the ACM (JACM),",
            "year": 2012
        },
        {
            "authors": [
                "Arjan Cornelissen",
                "Yassine Hamoudi",
                "Sofiene Jerbi"
            ],
            "title": "Near-optimal quantum algorithms for multivariate mean estimation",
            "venue": "In Proceedings of the 54th Annual ACM SIGACT Symposium on Theory of Computing,",
            "year": 2022
        },
        {
            "authors": [
                "Erick Delage",
                "Yinyu Ye"
            ],
            "title": "Distributionally robust optimization under moment uncertainty with application to data-driven problems",
            "venue": "Operations Research,",
            "year": 2010
        },
        {
            "authors": [
                "Jelena Diakonikolas",
                "Crist\u00f3bal Guzm\u00e1n"
            ],
            "title": "Lower bounds for parallel and randomized convex optimization",
            "venue": "In Conference on Learning Theory,",
            "year": 2019
        },
        {
            "authors": [
                "Christoph D\u00fcrr",
                "Mark Heiligman",
                "Peter HOyer",
                "Mehdi Mhalla"
            ],
            "title": "Quantum query complexity of some graph problems",
            "venue": "SIAM Journal on Computing,",
            "year": 2006
        },
        {
            "authors": [
                "Minbo Gao",
                "Zhengfeng Ji",
                "Tongyang Li",
                "Qisheng Wang"
            ],
            "title": "Logarithmic-regret quantum learning algorithms for zero-sum games, 2023",
            "year": 2023
        },
        {
            "authors": [
                "Ankit Garg",
                "Robin Kothari",
                "Praneeth Netrapalli",
                "Suhail Sherif"
            ],
            "title": "No quantum speedup over gradient descent for non-smooth convex optimization",
            "venue": "In 12th Innovations in Theoretical Computer Science Conference,",
            "year": 2021
        },
        {
            "authors": [
                "Ankit Garg",
                "Robin Kothari",
                "Praneeth Netrapalli",
                "Suhail Sherif"
            ],
            "title": "Near-optimal lower bounds for convex optimization for all orders of smoothness",
            "venue": "Advances in Neural Information Processing Systems,",
            "year": 2021
        },
        {
            "authors": [
                "Alexander Gasnikov",
                "Pavel Dvurechensky",
                "Eduard Gorbunov",
                "Evgeniya Vorontsova",
                "Daniil Selikhanovych",
                "C\u00e9sar A Uribe",
                "Bo Jiang",
                "Haoyue Wang",
                "Shuzhong Zhang",
                "S\u00e9bastien Bubeck"
            ],
            "title": "Near optimal methods for minimizing convex functions with lipschitz p-th derivatives",
            "venue": "In Conference on Learning Theory,",
            "year": 2019
        },
        {
            "authors": [
                "Weiyuan Gong",
                "Chenyi Zhang",
                "Tongyang Li"
            ],
            "title": "Robustness of quantum algorithms for nonconvex optimization, 2022",
            "year": 2022
        },
        {
            "authors": [
                "Lov Grover",
                "Terry Rudolph"
            ],
            "title": "Creating superpositions that correspond to efficiently integrable probability distributions",
            "year": 2002
        },
        {
            "authors": [
                "Crist\u00f3bal Guzm\u00e1n",
                "Arkadi Nemirovski"
            ],
            "title": "On lower complexity bounds for large-scale smooth convex optimization",
            "venue": "Journal of Complexity,",
            "year": 2015
        },
        {
            "authors": [
                "Yassine Hamoudi"
            ],
            "title": "Preparing many copies of a quantum state in the black-box model",
            "venue": "Physical Review A,",
            "year": 2022
        },
        {
            "authors": [
                "Elad Hazan",
                "Satyen Kale"
            ],
            "title": "Beyond the Regret Minimization Barrier: Optimal Algorithms for Stochastic Strongly-Convex Optimization",
            "venue": "Journal of Machine Learning Research,",
            "year": 2014
        },
        {
            "authors": [
                "Elad Hazan",
                "Tomer Koren",
                "Nati Srebro"
            ],
            "title": "Beating SGD: Learning SVMs in sublinear time",
            "venue": "In Advances in Neural Information Processing Systems,",
            "year": 2011
        },
        {
            "authors": [
                "Stephen P. Jordan"
            ],
            "title": "Fast quantum algorithm for numerical gradient estimation",
            "venue": "Physical Review Letters,",
            "year": 2005
        },
        {
            "authors": [
                "Phillip Kaye",
                "Michele Mosca"
            ],
            "title": "Quantum networks for generating arbitrary quantum states",
            "venue": "Optical Fiber Communication Conference and International Conference on Quantum Information, pp. PB28. Optica Publishing Group,",
            "year": 2001
        },
        {
            "authors": [
                "Iordanis Kerenidis",
                "Anupam Prakash"
            ],
            "title": "A quantum interior point method for LPs and SDPs",
            "venue": "ACM Transactions on Quantum Computing,",
            "year": 2020
        },
        {
            "authors": [
                "Tongyang Li",
                "Shouvanik Chakrabarti",
                "Xiaodi Wu"
            ],
            "title": "Sublinear quantum algorithms for training linear and kernel-based classifiers",
            "venue": "In International Conference on Machine Learning,",
            "year": 2019
        },
        {
            "authors": [
                "Yizhou Liu",
                "Weijie J. Su",
                "Tongyang Li"
            ],
            "title": "On quantum speedups for nonconvex optimization via quantum tunneling walks, 2022",
            "year": 2022
        },
        {
            "authors": [
                "Renato DC Monteiro",
                "Benar Fux Svaiter"
            ],
            "title": "An accelerated hybrid proximal extragradient method for convex optimization and its implications to second-order methods",
            "venue": "SIAM Journal on Optimization,",
            "year": 2013
        },
        {
            "authors": [
                "Arkadi Semenovi\u010d Nemirovski",
                "David Borisovich Yudin"
            ],
            "title": "Problem complexity and method efficiency in optimization",
            "year": 1983
        },
        {
            "authors": [
                "Y. Nesterov"
            ],
            "title": "Smooth minimization of non-smooth functions",
            "venue": "Mathematical programming,",
            "year": 2005
        },
        {
            "authors": [
                "Shai Shalev-Shwartz",
                "Yonatan Wexler"
            ],
            "title": "Minimizing the maximal loss: How and why",
            "venue": "In International Conference on Machine Learning,",
            "year": 2016
        },
        {
            "authors": [
                "Peter W. Shor"
            ],
            "title": "Polynomial-time algorithms for prime factorization and discrete logarithms on a quantum computer",
            "venue": "SIAM Review,",
            "year": 1999
        },
        {
            "authors": [
                "Joran van Apeldoorn",
                "Andr\u00e1s Gily\u00e9n"
            ],
            "title": "Improvements in quantum sdp-solving with applications. In 46th International Colloquium on Automata, Languages, and Programming (ICALP 2019)",
            "venue": "Schloss Dagstuhl-Leibniz-Zentrum fuer Informatik,",
            "year": 2019
        },
        {
            "authors": [
                "Joran van Apeldoorn",
                "Andr\u00e1s Gily\u00e9n",
                "Sander Gribling",
                "Ronald de Wolf"
            ],
            "title": "Convex optimization using quantum oracles",
            "year": 2020
        },
        {
            "authors": [
                "Joran van Apeldoorn",
                "Andr\u00e1s Gily\u00e9n",
                "Sander Gribling",
                "Ronald de Wolf"
            ],
            "title": "Quantum SDP-solvers: Better upper and lower bounds",
            "year": 2020
        },
        {
            "authors": [
                "Vladimir N. Vapnik"
            ],
            "title": "An overview of statistical learning theory",
            "venue": "IEEE Transactions on Neural Networks,",
            "year": 1999
        },
        {
            "authors": [
                "Blake E. Woodworth",
                "Nati Srebro"
            ],
            "title": "Tight complexity bounds for optimizing composite objectives",
            "venue": "In Advances in Neural Information Processing Systems,",
            "year": 2016
        },
        {
            "authors": [
                "Christof Zalka"
            ],
            "title": "Simulating quantum systems on a quantum computer",
            "venue": "Proceedings of the Royal Society of London Series A: Mathematical, Physical and Engineering Sciences,",
            "year": 1969
        },
        {
            "authors": [
                "Chenyi Zhang",
                "Tongyang Li"
            ],
            "title": "Quantum lower bounds for finding stationary points of nonconvex functions",
            "venue": "In International Conference on Machine Learning. PMLR,",
            "year": 2023
        },
        {
            "authors": [
                "Chenyi Zhang",
                "Jiaqi Leng",
                "Tongyang Li"
            ],
            "title": "Quantum algorithms for escaping from saddle points",
            "year": 2021
        }
    ],
    "sections": [
        {
            "text": "\u221a N\u03f5\u22125/3 + \u03f5\u22128/3).1 On the other hand, we prove that\nquantum algorithms must take \u2126\u0303( \u221a N\u03f5\u22122/3) queries to a first order quantum oracle, showing that our dependence on N is optimal up to poly-logarithmic factors."
        },
        {
            "heading": "1 INTRODUCTION",
            "text": "Consider the problem of minimizing the maximum of N convex functions f1, . . . , fN where each fi : Rd \u2192 R is convex and L-Lipschitz. Our goal is to find a point x\u22c6 satisfying\nFmax(x\u22c6)\u2212 inf x\u2208Rd Fmax(x) \u2264 \u03f5 (1)\nfor some target accuracy \u03f5, where\nFmax(x) := max i\u2208[N ] fi(x). (2)\nThis problem has wide applications in machine learning and optimization. Specifically, it characterizes the problem of minimizing the maximum of loss functions in supervised learning. For instance, in support vector machines (SVMs), fi\u2019s are loss functions representing the negative margin of the ith data point (Vapnik, 1999; Clarkson et al., 2012; Hazan et al., 2011; Li et al., 2019). Furthermore, minimizing the maximum loss in classification provides advantageous effects on training speed and generalization (Shalev-Shwartz & Wexler, 2016). In optimization, it falls into the category of robust optimization (Beyer & Sendhoff, 2007; Ben-Tal et al., 2009) that studies optimization of the worst-case objective. As a concrete example, Fmax(x) = maxp\u2208\u2206N \u2211 i\u2208[N ] pifi(x) is an instance\n\u2217Equal contribution. 1Throughout this paper, O\u0303 omits poly-logarithmic factors, i.e., O\u0303(f) = O(f poly(log f)).\nof distributionally robust optimization (Delage & Ye, 2010; Ben-Tal et al., 2013) with the uncertain set being the whole set \u2206N of probability distributions with cardinality N .\nGiven these motivations, Problem (1) has been extensively studied in previous literature. In particular, it is known that it can be solved by subgradient method using O(\u03f5\u22122) iterations, e.g., see Nesterov (2018). In each iteration, however, N queries are needed to compute the exact subgradient, which leads to an overall query complexity of order O(N\u03f5\u22122). Furthermore, Carmon et al. (2021) proposed an algorithm based on the ball optimization acceleration scheme (Carmon et al., 2020b) that uses O\u0303(N\u03f5\u22122/3 + \u03f5\u22128/3) subgradient queries. Carmon et al. (2021) also proved an \u2126(N\u03f5\u22122/3) lower bound on the number of subgradient queries via the \u201cchain construction\u201d technique in optimization lower bounds (Carmon et al., 2020a; Diakonikolas & Guzm\u00e1n, 2019; Guzm\u00e1n & Nemirovski, 2015; Nemirovski & Yudin, 1983; Woodworth & Srebro, 2016), indicating that their algorithm is optimal to a poly-logarithmic factor in the parameter regime where N \u2265 \u03f5\u22122. On the other hand, quantum computing has been a rapidly advancing technology in recent years. The main motivation of studying quantum computing is its potential of solving problems significantly faster than the classical counterparts. The most famous example is Shor\u2019s algorithm Shor (1999) for factoring integers in polynomial time with high success probability on quantum computers. In optimization theory, various quantum algorithms for optimization problems have been developed, providing quantum speedups for semidefinite programs (Brand\u00e3o & Svore, 2017; Brand\u00e3o et al., 2019; van Apeldoorn & Gily\u00e9n, 2019; van Apeldoorn et al., 2020; Kerenidis & Prakash, 2020; Augustino et al., 2021), convex optimization (Chakrabarti et al., 2020; van Apeldoorn et al., 2020), nonconvex optimization (Liu et al., 2022; Gong et al., 2022; Childs et al., 2022; Zhang et al., 2021), etc. Conversely, quantum lower bounds on convex optimization (Garg et al., 2021; Garg et al., 2021) and nonconvex optimization (Zhang & Li, 2023) are also established. However, the problem of minimizing the maximum of functions is widely open in quantum computing at the moment.\nContributions. In this paper, we conduct a systematic study of quantum algorithms and lower bounds for minimizing the maximum of N convex and Lipschitz functions f1, . . . , fN . In particular, we assume the access to the following quantum zeroth-order oracle:\nOf |i\u27e9 |x\u27e9 |y\u27e9 \u2192 |i\u27e9 |x\u27e9 |y + fi(x)\u27e9 , (3) where |\u00b7\u27e9 denotes input or output register that allow queries in quantum superpositions, the essence of speedups from quantum algorithms. Specifically, a quantum algorithm can choose x1, . . . , xN \u2208 Rd, y1, . . . , yN \u2208 R, and c \u2208 CN such that \u2211N i=1 |ci|2 = 1, and applies the quantum oracle as follows:\nOf ( N\u2211 i=1 ci |i\u27e9 |xi\u27e9 |yi\u27e9 ) = N\u2211 i=1 ci |i\u27e9 |xi\u27e9 |yi + fi(x)\u27e9 . (4)\nIf we measure this quantum state, with probability |ci|2 the third register gives yi + fi(x). This oracle is a standard assumption by quantum algorithms for optimization, see e.g. Chakrabarti et al. (2020); van Apeldoorn et al. (2020); Liu et al. (2022); Gong et al. (2022); Zhang et al. (2021). More introductions to notations and definitions of quantum computing are given in Section 2. Theorem 1 (Main theorem). There is a quantum algorithm (Algorithm 1) that outputs an x\u22c6 satisfying Eq. (1) with probability at least 2/3 using O\u0303( \u221a N\u03f5\u22125/3 + \u03f5\u22128/3) queries to the Of in Eq. (3). On the other hand, such quantum algorithms must take \u2126\u0303( \u221a N\u03f5\u22122/3) queries to Of (Theorem 4).\nCompared to the state-of-the-art classical algorithm for minimizing the maximum of N convex and Lipschitz functions, we achieve quadratic quantum speedup in the number of functions N . On the other hand, our quantum lower bound \u2126( \u221a N\u03f5\u22122/3) establishes the near-optimality of our quantum algorithm in N . See Table 1 for more detailed comparisons.\nTechniques. Our quantum algorithm follows the scheme of Carmon et al. (2021), while we achieve quantum speedup by leveraging quantum samples. As a starting point, classical algorithms (Carmon et al., 2021; Nesterov, 2005) proceed by considering the so-called \u201csoftmax\u201d approximation of the maximum, defined as\nFsmax,\u03f5(x) := \u03f5 \u2032 log \u2211 i\u2208[N ] exp ( fi(x) \u03f5\u2032 ) , \u03f5\u2032 = \u03f5 2 logN . (5)\nNote that the choice of \u03f5\u2032 here promises that a solution x\u22c6 of\nFsmax,\u03f5(x\u22c6)\u2212 inf x\u2208Rd\nFsmax,\u03f5(x) \u2264 \u03f5\n2 (6)\nwill automatically satisfy (1) (see Lemma 4). Our algorithm has two stages:\n\u2022 Implement a regularized ball optimization oracle (BROO) of Fsmax,\u03f5 that when query at x returns an (approximate) minimizer of Fsmax,\u03f5 in a ball of radius r around x; and then\n\u2022 Find an approximate minimum of Fsmax,\u03f5 using ball optimization oracle via a ball optimization algorithm (Carmon et al., 2020b).\nHere, the ball optimization algorithm in Carmon et al. (2020b) is a variant of the Monteiro-Svaiter acceleration (Bubeck et al., 2019; Bullins, 2020; Gasnikov et al., 2019; Monteiro & Svaiter, 2013) and can minimize f to accuracy \u03f5 using O\u0303 ( r\u22122/3 ) queries to the BROO. Carmon et al. (2021) showed that BROO for Fsmax,\u03f5 can be implemented by considering instead a \u201csoftened\u201d function\n\u0393\u03f5(x) = \u2211 i\u2208[N ] pi\u03f5 \u2032 \u00b7 e fi(x)\u2212fi(x\u0304) \u03f5\u2032 , pi = efi(x\u0304)/\u03f5 \u2032\u2211 j\u2208[N ] e fi(x\u0304)/\u03f5\u2032 , (7)\nwhere \u03f5\u2032 = \u03f5/(2 logN), which shares the same minimizer as Fsmax,\u03f5 and has a finite sum structure enables stochastic gradient methods. In their implementation, the main bottleneck for N arises from the sampling step of the distribution pi. To obtain T samples, the algorithm requires precomputing all p1, . . . , pN , which takes \u2126(N) classical queries and cannot be further accelerated in the classical setting. However, this task shares a similar formula with the Gibbs sampling problem, which exhibits quantum speedups (Bouland et al., 2023; Gao et al., 2023). Building on this intuition, we demonstrate that BROO can be executed using just O\u0303( \u221a N) queries to the quantum oracle Of defined in (3). Our\nquantum algorithm begins by preparing T copies of the quantum state \u2211\ni\n\u221a pi |i\u27e9. The first step\ninvolves identifying the K largest pi values and corresponding indices, which can be accomplished with only \u221a NT queries to the quantum oracle Of , in contrast to the classical case\u2019s query complexity of \u2126(N). This quadratic speedup in N contributes to our overall quantum speedup.\nFrom a high-level perspective, quantum speedups in optimization algorithms have been mainly investigated in gradient descent methods (Liu et al., 2022; Gong et al., 2022; Zhang et al., 2021), cutting plane methods (Chakrabarti et al., 2020; van Apeldoorn et al., 2020), interior point methods (Kerenidis & Prakash, 2020; Augustino et al., 2021), etc., but quantum algorithms based on trust region methods are widely open. Our result can be seen as a first attempt for quantum algorithms using trust region methods with speedup.\nWe establish our quantum lower bound for minimizing the maximal loss by applying a quantum progress control method to the classical hard instance described in Carmon et al. (2021). The quantum progress control method, initially introduced in Garg et al. (2021), has been widely used in proving quantum lower bounds for optimization problems, including non-smooth convex optimization (Garg et al., 2021), smooth convex optimization (Garg et al., 2021), and (stochastic) non-convex optimization (Zhang & Li, 2023). This method is analogous to the classical progress control technique employed in proving classical lower bounds for optimization problems (Carmon et al., 2020a; Arjevani et al., 2020; 2022; Bubeck et al., 2019), and is based on demonstrating that any algorithm attempting to solve the optimization problem must acquire a sufficient amount of information through an adaptive \"chain structure\". This chain structure is a well-established concept in classical optimization lower bound proofs, as seen in prior works such as (Carmon et al., 2020a; Nemirovski & Yudin, 1983; Woodworth & Srebro, 2016; Guzm\u00e1n & Nemirovski, 2015; Diakonikolas & Guzm\u00e1n, 2019).\nThe quantum progress control method proceeds by modeling any quantum algorithm as a sequence of unitaries represented as\n\u00b7 \u00b7 \u00b7V3OfV2OfV1OfV0\napplied to the initial state |0\u27e9, where Of is the oracle encoding the information of f and Vi\u2019s are unitaries that are independent from f . Then, one can show that those queries can only learn the information and make progress along the chain structure in an adaptive manner. This ultimately leads to a lower bound that scales in proportion to the length of the chain multiplied by the cost to make a unit progress along the chain.\nIn the majority of cases, the query cost of making a unit progress along the chain is just 1, see e.g., Garg et al. (2021); Garg et al. (2021). Nevertheless, there exists methods to incorporate more \u201chardness\u201d into the chain by constructing hard instances where making progress along the chain requires solving a subproblem. For example, the quantum stochastic lower bound for nonconvex optimization algorithm (Zhang & Li, 2023) proceeds by applying a hard instance with a \u201cchain structure\u201d such that, at each point where any algorithm attempts to progress by one step of unit length along the chain, it is required to solve a multivariate mean estimation problem, whose quantum lower bound is given in Cornelissen et al. (2022).\nOur lower bound builds upon the same framework. In particular, we demonstrate that, at each point where a quantum algorithm attempts to progress by one step along the chain of the hard instance defined in described in Carmon et al. (2021), it has to solve an unstructured search problem. This intuition, however, cannot work straightforwardly. This arises from the fact that even in the case of a completely random guess, any algorithm possesses a success probability that is at least polynomially small for solving the unstructured search problem and progress by multiple steps along the chain. This success probability, although small, poses a challenge to the progress control argument where the probability of making progress by multiple steps at once should be super-polynomially small.\nWe address this issue by introducing a multi-round version of unstructured search problem. In this modified problem, each round\u2019s solution acts as a \u201ckey\u201d that unlocks the next round, forcing it to solve these unstructured search problems adaptively. We demonstrate that for any quantum algorithm making a maximum of O(N) queries to this multi-round unstructured search problem, its overall success probability in solving the entire multi-round problem, i.e., solve the unstructured search problem of each round, is only super-polynomially small. After establishing the lower bound for the multi-round unstructured search problem, we show that making progress along the chain for a given length is as hard as solving the multi-round unstructured search problem of the same number of rounds. Formally, we show that any quantum algorithm has to use \u2126\u0303( \u221a N) queries to make\nO(poly log(1/\u03f5)) progress along chain of length \u2126 ( \u03f5\u22122/3 ) , giving our \u2126\u0303 (\u221a N\u03f5\u22122/3 ) lower bound.\nOpen questions. Our paper leaves several natural open questions for future investigation:\n\u2022 Can we narrow or even close the gap of order \u03f5 between the leading complexity term in our quantum algorithm and our quantum lower bound? Useful techniques might be found in quantum algorithms for Gibbs sampling (Bouland et al., 2023; Gao et al., 2023), but it remains uncertain if we can reconcile the differences in the two settings.\n\u2022 It is shown in Carmon et al. (2021) that the smoothness of fi can enable faster classical algorithms for minimizing the maximum loss, even in the case where the smoothness parameter is of order 1/\u03f5 and all the fi are almost non-smooth. The intuition is that we can apply the accelerated variance reduction method (Allen-Zhu, 2017) to implement the ball optimization oracle of Fsmax,\u03f5 if it is smooth, which contains a mean estimation subroutine that cannot be directly improved by quantum algorithms (Cornelissen et al., 2022; Zhang & Li, 2023). Hence, a natural question to ask is if there exist quantum algorithms that can utilize the smoothness structure and provide better convergence rates."
        },
        {
            "heading": "2 PRELIMINARIES",
            "text": "Basic notations in quantum computing. Quantum mechanics can be formulated in the language of linear algebra. Specifically, we define the computational basis of the space Cd by {e\u20d71, . . . , e\u20d7d},\nwhere e\u20d7i = (0, . . . , 1, . . . , 0)\u22a4 with the ith coordinate being 1 and other coordinates being 0. These basis vectors can be written by the Dirac notation, where we write e\u20d7i as |i\u27e9, and write e\u20d7\u22a4i as \u27e8i|.\nA d-dimensional quantum state |v\u27e9 = (v1, . . . , vd)\u22a4 is a unit vector in Cd, i.e., \u2211d\u22121\ni=0 |vi|2 = 1. For each i, vi is named the amplitude in |i\u27e9. If at least two amplitudes are nonzero, we say |v\u27e9 is in superposition of the computational basis.\nTensor product of quantum states is their Kronecker product: if |u\u27e9 \u2208 Cd1 and |v\u27e9 \u2208 Cd2 , then |u\u27e9 \u2297 |v\u27e9 = (u1v1, u1v2, . . . , ud1vd2)\u22a4 \u2208 Cd1 \u2297 Cd2 . |u\u27e9 \u2297 |v\u27e9 can be abbreviated as |u\u27e9|v\u27e9. The basic element in classical computing is one bit. Following this pattern, the basic element in quantum computing is one qubit, which is a quantum state in C2. Formally, a qubit state has the form a|0\u27e9 + b|1\u27e9 where a, b \u2208 C, |a|2 + |b|2 = 1. Furthermore, an n-qubit state has the form |v1\u27e9 \u2297 \u00b7 \u00b7 \u00b7 \u2297 |vn\u27e9, where each |vi\u27e9 is a qubit state for all i \u2208 [n]. As a result, n-qubit states form a Hilbert space of dimension 2n.\nCalculations in quantum computing are unitary transformations and can be stated in the circuit model where a k-qubit gate is a unitary matrix in C2k . Two-qubit quantum gates are universal, i.e., every n-qubit gate can be written as the product of a series of two-qubit gates. Therefore, the gate complexity of a quantum algorithm can be regarded as its number of two-qubit gates.\nBasic quantum algorithms. In our paper, we use the following quantum algorithms in previous works as basic building blocks of our quantum algorithm. Proposition 1 (Top-K Maximum Finding - D\u00fcrr et al. 2006, Theorem 4.2). Let K,N \u2208 N, 1 \u2264 K \u2264 N , \u03b4 \u2208 (0, 1) and w \u2208 RN\u22650. There exists a quantum algorithm QuantumMaximumFinding(K,N,w, \u03b4) that outputs the positions of K largest entries in w with success probability at least 1\u2212 \u03b4. The algorithm performs O( \u221a KN log(1/\u03b4)) queries the following quantum oracle Ow that encodes w:\nOw |i\u27e9 |y\u27e9 \u2192 |i\u27e9 |y + wi\u27e9 . (8) Proposition 2 (State Preparation - Zalka 1998; Grover & Rudolph 2002; Kaye & Mosca 2001). Given integers N,T , a non-zero vector w \u2208 RN\u22650 with \u2225w\u22251 = 1 and a classical procedure that computes\u2211j\nl=i wj ,\u2200i \u2264 j, there exists a quantum procedure QuantumStatePreparation(N,T,w) that outputs the classical description of a quantum circuit D that satisfies D |0\u27e9 \u2192 |w\u27e9 = \u2211 i \u221a wi |i\u27e9. Proposition 3 (Amplitude Amplification - Brassard et al. 2002, Theorem 3). Let C be a quantum circuit that prepares the state C |0\u27e9 = \u221ap |\u03d5\u27e9 |0\u27e9+ \u221a 1\u2212 p |\u03d5\u22a5\u27e9 |1\u27e9 for some p \u2208 [0, 1] and two unit states |\u03d5\u27e9 , |\u03d5\u22a5\u27e9. There exists a quantum algorithm AmplitudeAmplification(C) that outputs the state |\u03d5\u27e9 by using O(1/\u221ap) calls of C and C\u2020 in expectation. Proposition 4 (Quantum Gradient Estimation - Jordan 2005, Lemma 2.2). Given access to the quantum zeroth-order oracle Of defined in (3), there exists a quantum algorithm QuantumGradientEstimation(i, x) that outputs the gradient \u2207fi(x) using only one query to Of ."
        },
        {
            "heading": "3 QUANTUM ALGORITHM FOR MINIMIZING THE MAXIMAL LOSS",
            "text": "In this section, we present our quantum algorithm for minimizing the maximal loss. Our approach builds upon the framework of (Carmon et al., 2021, Algorithm 1), which proceeds by preparing a ball optimization oracle that can minimize the objective function in a very small region, and then optimize the objective function by using this oracle recursively. In particular, (Carmon et al., 2021, Algorithm 1) is a variant of Carmon et al. (2020b) and utilizes the Monteiro-Svaiter acceleration (Monteiro & Svaiter, 2013). Notably, there has been a series of work (Carmon et al., 2020b; 2021) on designing optimization algorithms following this framework, given that it is natural in some problems where we can access the ball optimization oracle efficiently. Compared to (Carmon et al., 2021, Algorithm 1), our algorithm differs by a critical observation that the bottleneck in the classic algorithm, mainly the sampling, can be sped up using a quantum subroutine based on Gibbs sampling.\nAs in Carmon et al. (2021), we consider the ball regularized optimization oracle (BROO), which is a generalization from the stricter ball optimization oracle Carmon et al. (2020b). Formally, a BROO is defined as follows.\nDefinition 1 (Carmon et al. 2021, Definition 1). We say that a mapping O\u03bb,\u03b4 is a Ball Regularized Optimization Oracle of radius r (r-BROO) for f , if for every query point x\u0304, regularization parameter \u03bb and desired accuracy \u03b4, it returns x\u0303 = O\u03bb,\u03b4(x\u0304) satisfying\nf(x\u0303) + \u03bb\n2 \u2225x\u0303\u2212 x\u0304\u22252 \u2264 min x\u2208Br(x\u0304)\n{ f(x) + \u03bb\n2 \u2225x\u2212 x\u0304\u22252\n} + \u03bb\n2 \u03b42. (9)\nThe following result illustrates the convergence rate achieved by the classical ball optimization algorithm (Carmon et al., 2021, Algorithm 1) using BROO queries. Proposition 5 (BROO Acceleration - Rephrased from Carmon et al. 2021, Theorem 1). Let f : Rd \u2192 R be convex and Lf -Lipschitz, and let z \u2208 Rd. For any domain bound R > 0 accuracy level \u03f5 > 0, and initial point x0 \u2208 Rd, there exists a (classical) algorithm that returns a point x \u2208 Rd satisfying f(x)\u2212minz\u2208BR(x0) f(z) \u2264 \u03f5/2 using at most\nO\n(( R\nr\u03f5\n)2/3 log2 ( R\nr\u03f5\n)) (10)\nqueries to an r\u03f5-BROO, in which r\u03f5 = \u03f5/2Lf logN . The algorithm also guarantees that the BROO query parameters (\u03bb, \u03b4) satisfy \u2126 (\n\u03f5 r\u03f5R\n) \u2264 \u03bb \u2264 O ( Lf r\u03f5 ) and \u03b4 = \u2126 ( \u03f5 \u03bbR ) .\n3.1 QUANTUM BROO IMPLEMENTATION OF Fsmax,\u03f5\nIn this subsection, we present a quantum algorithm (Algorithm 1) that implements a BROO given access to the oracle Of defined in (3). The query complexity of Algorithm 1 is given in Theorem 2.\nAlgorithm 1: Quantum-Epoch-SGD-Proj on the exponentiated softmax Input: Functions f1, . . . , fN , ball center x\u0304, ball radius r\u03f5, regularization strength \u03bb, smoothing parameter \u03f5\u2032, failure probability \u03c3 Parameters: Step size \u03b71 = 1/(3\u03bb), domain size D1 = \u0398(G \u221a log(log(T )/\u03c3)/\u03bb), T1 = 450 and total iteration budget T Output: Approximate minimizer of \u0393\u03f5,\u03bb (and hence F\u03bbsmax,\u03f5) in Br\u03f5(x\u0304))\n1 Prepare T identical states |\u03c8\u27e9 = \u2211\ni e fi(x\u0304)/2\u03f5\n\u2032 / \u221a\u2211\ni\u2208[N ] e fi(x\u0304)/\u03f5\u2032 |i\u27e9 using Algorithm 2\n2 Initialize x11 \u2208 Br\u03f5(x\u0304) arbitrarily, set k = 1 3 while \u2211 i\u2208[k] Ti \u2264 T do 4 for t = 1, . . . , Tk do 5 Sample i \u2208 [N ] by measuring the next unmeasured |\u03c8\u27e9 6 Call QuantumGradientEstimation(i, x) to compute\n\u2207f\u03bbi (x) = \u2207fi(x) + \u03bb(x\u2212 x\u0304) 7 g\u0302t = e (f\u03bbi (x)\u2212f \u03bb i (x\u0304))/\u03f5\n\u2032\u2207f\u03bbi (x) 8 Update xkt+1 \u2190 \u03a0Br(x\u0304)\u2229BDk (xk1 )(x k t \u2212 \u03b7kg\u0302t)\n9 Let xk+11 \u2190 1Tk \u2211 t\u2208[Tk] x k t\n10 Update parameters Tk+1 \u2190 2Tk, \u03b7k+1 \u2190 \u03b7k/2, Dk+1 \u2190 Dk/ \u221a 2, k \u2190 k + 1\n11 return xk1\nTheorem 2. Let f1, f2, . . . , fN be Lf -Lipschitz functions. Let \u03c3 \u2208 (0, 1), \u03f5, \u03b4 > 0 and r\u03f5 = \u03f5/2Lf logN . For any x\u0304 \u2208 Rd and \u03bb \u2264 O(Lf/r\u03f5), with probability at least 1 \u2212 2\u03c3, Algorithm 1 outputs a valid r\u03f5-BROO response for Fsmax,\u03f5 to query x\u0304 with regularization \u03bb and accuracy \u03b4, and has cost\nO( \u221a NT log(1/\u03c3) + T ) (11)\nin which T = L2f\u03bb\u22122\u03b4\u22122 log(log(Lf/\u03bb\u03b4)/\u03c3).\nNote that when implementing BROO we are not essentially minimizing Fsmax,\u03f5(x) but instead\nF\u03bbsmax,\u03f5(x) := Fsmax,\u03f5(x) + \u03bb/2 \u00b7 \u2225x\u2212 x\u0304\u2225 2 = \u03f5\u2032 log \u2211 i\u2208[N ] exp ( f\u03bbi (x)/\u03f5 \u2032), (12)\nin which f\u03bbi (x) := fi(x) + \u03bb/2 \u00b7 \u2225x\u2212 x\u0304\u2225 2 is a regularized version of fi(x). We define its \u201csoftened\u201d function \u0393\u03f5,\u03bb (Eq. (7)) accordingly.\nClassically, a BROO of Fsmax,\u03f5 can be implemented by (Carmon et al., 2021, Algorithm 2) using Epoch-SGD-Proj proposed in Hazan & Kale (2014) with the stochastic gradient oracle implemented by sampling an i first and evaluate the gradient of one of the \u03b3i\u2019s. This process is similar to stochastic gradient descent but introduces epochs, where a intra-epoch mirror descent takes place. Additionally, a projection is placed at the end of each iteration such that the variance of the stochastic gradient can be limited and probability bounds can be obtained rather than expectation bounds.\nIn comparison, our quantum algorithm (Algorithm 1) is based on the same framework, with a critical change. Rather than sampling classically from the same distribution many times within each epoch, we derive a quantum subroutine (Algorithm 2) that sped up this bottleneck exploiting quantum advantage on Gibbs sampling. Additionally, comparing to the classic algorithm, which requires first-order oracle to acquire gradient information, the proposed algorithm uses QuantumGradientEstimation (Proposition 4) to efficiently estimate the gradient through quantum zeroth-order oracle.\nAlgorithm 2: Quantum sampling of the softmax distribution. Input: Number of copies K, failure probability \u03b4\n1 Denote w = (f1(x\u0304), . . . , fN (x\u0304))\u22a4. Call QuantumMaximumFinding(K,N,w, \u03b4) to compute the set H \u2286 [N ] of the positions of K largest entries in fi(x\u0304) with failure probability \u03b4. 2 Compute h = mini\u2208H fi(x\u0304) and\nZ = (N \u2212K) exp(h/\u03f5\u2032) + \u2211 i\u2208H exp(fi(x\u0304)/\u03f5 \u2032)\n3 Denote w\u2032 = (w\u20321, . . . , w \u2032 N ) where\nw\u2032i =  exp(fi(x\u0304)/\u03f5\u2032) Z , i \u2208 H exp(h/\u03f5\u2032)\nZ , i /\u2208 H, \u2200i \u2208 [N ],\ncall QuantumStatePreparation(N,T,w\u2032) to build a unitary D such that\n|0\u27e9 D\u2212\u2192 \u2211 i\u2208H\n\u221a exp(fi(x\u0304)/\u03f5\u2032)\nZ |i\u27e9+ \u2211 i/\u2208H\n\u221a exp(h/\u03f5\u2032)\nZ |i\u27e9\n4 Construct the circuit C, which first applies D to the output register, as represented in Figure 1. 5 Call AmplitudeAmplification(C)K times and return the K output states.\nIn Line 4, the circuit C is constructed from the unitary D in Line 3. Amplitude amplification is then applied to prepare the state we need by C. More explanation of Algorithm 2 is given in Appendix A. The lemma below shows quantum speedup for producing multiple samples from the same distribution. Lemma 1. With probability at least 1\u2212 \u03b4, Algorithm 2 on input K, \u03b4 produces K samples from the probability distribution\npi = exp(fi(x\u0304)/\u03f5 \u2032)\u2211 j\u2208[N ] exp(fj(x\u0304)/\u03f5 \u2032) , i = 1, 2, . . . , N, (13)\nusing O( \u221a NK log(1/\u03b4)) queries to the quantum evaluation oracle Uf defined in (3).\nWe present the proof of this lemma in Appendix A. Next, we cite the result regarding the convergence rate of stochastic gradient method with projection for \u00b5-strongly convex functions. Lemma 2 (Hazan & Kale 2014, Theorem 11). Let f : X \u2192 R be a \u00b5-strongly-convex objective function on a convex compact set X with minimizer x\u22c6. With an unbiased stochastic estimator with norm bounded by G, Epoch-SGD-Proj algorithm uses T stochastic gradient queries and finds an approximate minimizer x\u0303 satisfying with probability 1\u2212 \u03c3\nf(x\u0303)\u2212 f(x\u22c6) \u2264 O ( G2 log(log(T )/\u03c3)\n\u00b5T\n) . (14)\nProof of Theorem 2. According to (7), the gradient of \u0393\u03f5,\u03bb(x) can be expressed as follows: \u2207\u0393\u03f5,\u03bb(x) = \u2211 i pie (f\u03bbi (x)\u2212f \u03bb i (x\u0304))/\u03f5 \u2032 \u2207fi(x). (15)\nThus, we have E[g\u0302t] = \u2207\u0393\u03f5,\u03bb(xt). Moreover, by Lemma 5, the quantity e(f \u03bb i (x)\u2212f \u03bb i (x\u0304))/\u03f5 \u2032\u2207fi(x) is bounded by a constant G = O(Lf ). Thus, g\u0302t is a valid stochastic gradient.\nNext, by applying Lemma 2 with T = \u0398(L2f\u03bb \u22122\u03b4\u22122 log(log(Lf/\u03bb\u03b4)/\u03c3)), Algorithm 1 outputs a minimizing point x\u22c6 of \u0393\u03f5,\u03bb with suboptimality\n\u0393\u03f5,\u03bb(x\u22c6)\u2212 min x\u2208Rd \u0393\u03f5,\u03bb(x) \u2264 O ( L2f \u03bbT log(log T/\u03c3) ) \u2264 \u03bb\u03b4 6e2 . (16)\nWith Lemma 5, we can bound the suboptimality of x\u22c6 on F\u03bbsmax,\u03f5 by 3e 2\u03bb\u03b4/6e2 \u2264 \u03bb\u03b4/2, indicating that Algorithm 1 is a valid BROO. The probability of Algorithm 1 failing is at most 2\u03c3 considering either the Epoch-SGD-Proj fails (Lemma 2) or the quantum sampling fails (Lemma 1)."
        },
        {
            "heading": "3.2 QUANTUM QUERY COMPLEXITY OF MINIMIZING THE MAXIMAL LOSS",
            "text": "With our BROO oracle implementation at hand, we present our main result in this section, which describes the quantum query complexity of minimizing the maximum loss. Theorem 3. Let f1, f2, . . . , fN be Lf -Lipschitz, let x\u22c6 be a minimizer of Fmax(x) = maxi\u2208[N ] fi(x) and assume \u2225x0 \u2212 x\u22c6\u2225 \u2264 R for a given initial point x0 and some R > 0. For any \u03f5 > 0, using the algorithm in Proposition 5 the BROO implementation for Fsmax,\u03f5 in Algorithm 1 finds a point with suboptimality \u03f5 with probability at least 23 and has computational cost\nO(K5/3 log3K( \u221a N logK + LfR/\u03f5)/ logN) (17)\nin which K = LfR log(N)/\u03f5.\nProof. We use Proposition 5 along with Theorem 2 on the minimization problem to prove both the correctness and the overall query complexity of the algorithm. In particular, using the guarantees in Proposition 5, we can see that the results of Theorem 2 applies directly since \u03bb \u2264 O(Lf/r\u03f5). Letting T be the bound of the total number of oracle queries in Proposition 5. We could have \u03c3 = 1/6T such that the probability of Algorithm 1 not failing throughout all the queries is at least 2/3. Thus, according to Proposition 5 the algorithm can output a minimizing point x\u22c6 for Fsmax,\u03f5 with suboptimality at most \u03f5/2. Thus, using Lemma 4, we conclude that x\u22c6 is a solution to (1), proving the correctness of the algorithm.\nAs for the query complexity, notice that from Proposition 5 the total number of calls to the BROO is\nT = O\n(( LfR logN\n\u03f5\n)2/3 log2 ( LfR logN\n\u03f5\n)) . (18)\nUsing our implementation of the BROO (Algorithm 1), the total number of calls to the quantum oracle Uf per BROO call is\nO (\u221a N log ( LfR logN\n\u03f5\n)( LfR\n\u03f5\n) log ( LfR logN\n\u03f5\n) + ( LfR\n\u03f5\n)2 log ( LfR logN\n\u03f5\n)) (19)\nin which we substitute \u03b4 = \u2126(\u03f5/\u03bbR) and \u03c3 = 1/6T ."
        },
        {
            "heading": "4 QUANTUM LOWER BOUND FOR MINIMIZING THE MAXIMUM LOSS",
            "text": "In this section, we establish a quantum query lower bound to demonstrate the optimality of our algorithm in Section 3 with respect to N . Classically, the query lower bound for minimizing maximal loss is established by a progress control argument given in Carmon et al. (2021). For any x \u2208 Rd, they define a quantity progress as\nprog\u03b1(x) := max { i \u2265 1 \u2223\u2223 |xi| \u2265 \u03b1} . (20)\nIntuitively, the progress is the highest coordinate index that an algorithm discovers when it reaches x. Following that, Carmon et al. (2021) extended the concept of robust zero chain introduced in Carmon et al. (2020a) to the setting of minimization of maximum loss. Definition 2 (Carmon et al. 2021, Definition 2). A sequence f1, . . . , fN of functions fi : BR(0)\u2192 R is called an \u03b1-robust N -element zero-chain if for all x \u2208 BR(0), all y in a neighborhood of x, and all i \u2208 [N ], we have\nprog\u03b1(x) \u2264 p =\u21d2 fi(y) =  fi(y[\u2264p]) i < p+ 1 fi(y[\u2264p+1]) i = p+ 1\nfN (y[\u2264p]) i > p+ 1,\n(21)\nwhere for any y \u2208 Rd, y[\u2264l] denotes the vector whose first l coordinates are identical to those of y and the remained coordinates are zero.\nCarmon et al. (2021) demonstrates that, for a sequence of functions f1, . . . , fN forming an \u03b1-robust N -element zero-chain with randomly permuted indices, a classical algorithm requires a lower bound of \u2126(N) queries to increase the progress by 1 in expectation. Similarly, we show that it takes \u2126 (\u221a N ) queries for a quantum algorithm to make progress on an \u03b1-robust N -element zero-chain. Notably, the progress achieved after \u2126 (\u221a N )\nquantum queries exhibits a sub-exponential tail, and the probability of achieving super-logarithmic progress is super-polynomially small.\nIn this section, we first present in Section 4.1 a quantum analog of the progress control argument in Carmon et al. (2021). Finally, we introduce the main lower bound statement in Section 4.2."
        },
        {
            "heading": "4.1 PROGRESS CONTROL ARGUMENT FOR QUANTUM ALGORITHMS",
            "text": "We establish a quantum analog of the progress control argument given in Carmon et al. (2021). Following the notion of Garg et al. (2021); Garg et al. (2021); Zhang & Li (2023), we represent any quantum algorithm making k queries to the oracle Of in the form of sequences of unitaries\nAquan[k] = VkOfVk\u22121Of \u00b7 \u00b7 \u00b7OfV1OfV0 (22) applied to the initial state |0\u27e9, followed by a measurement. Similar to Carmon et al. (2021, Proposition 1), we prove the following result that no quantum algorithm can guess the final column of U or make progress efficiently (proof deferred to Appendix B.2). Proposition 6. Let \u03b4, \u03b1 \u2208 (0, 1) and let N,T \u2208 N with T \u2264 N/2. Let {fi}i\u2208[N ] be an \u03b1-robust N - element zero-chain with domain BR(0). For d \u2265 T +max(32T 3 log(32 \u221a NT 5), 32T 3 log (4T/\u03b4)), draw U uniformly from the set of d \u00d7 T orthogonal matrices, and draw \u03a0 uniformly from the set of permutations of [N ]. Let f\u0303i(x) := f\u03a0(i)(U\u22a4x). For any t-query quantum algorithm Aquan[t] equipped with an oracle on f\u03031(x), . . . , f\u0303N (x), denote xt as its output. Then with probability at least 1\u2212 \u03b4 we have\nprog\u03b1(U \u22a4xt) < T, \u2200t \u2264\nT \u221a N\nCK2\nin which C is a constant and K = 4 log T + 12 logN + 4."
        },
        {
            "heading": "4.2 THE LOWER BOUND STATEMENT",
            "text": "Finally, we present the main theorem of the lower bound argument. Theorem 4. For any Lf , Lg, R > 0, \u03f5 < min(LfR,LgR2), N \u2208 N and \u03b4 \u2208 (0, 1), there exists a constant C such that, for any quantum algorithm A making less than C \u00b7 \u221a N\u03f5\u22122/3 logN/\u03f5 queries to the oracle Of defined in (3) and outputs a point xout, there exists Lf -Lipschitz and Lg-smooth functions (fi)i\u2208[N ] with domain BdR(0) for d \u2265 T + max(32T 3 log(32 \u221a NT 5), 32T 3 log (4T/\u03b4)) such that\nPr [ Fmax(xout)\u2212 min\nx\u2208BdR(0) Fmax(x) \u2265 \u03f5\n] \u2264 1\n3 . (23)\nTheorem 4 implies that the problem can only be solved by any quantum algorithm using \u2126( \u221a N\u03f5\u22122/3) queries. The proof is deferred to Appendix B.3, but the idea of the proof is straightforward by combining Proposition 6 and the hard instance defined in (92) in Appendix B.3."
        },
        {
            "heading": "ACKNOWLEDGMENTS",
            "text": "We thank Adam Bouland, Tudor Giurgica-Tiron, and Aaron Sidford for helpful discussions. CZ was supported in part by the Shoucheng Zhang Graduate Fellowship. TL was supported by the National Natural Science Foundation of China (Grant Numbers 62372006 and 92365117), and a startup fund from Peking University."
        },
        {
            "heading": "A PROOF DETAILS OF OUR QUANTUM UPPER BOUND",
            "text": "First, we present the proof of Lemma 1. To prove this lemma, we would need a modified version of (Hamoudi, 2022, Theorem 3) given in Lemma 3. This circuit C uses the unitary D we prepare in\nAlgorithm 2 as a subroutine. Lemma 3. Consider two integers 1 \u2264 K \u2264 N , a real number \u03b4 \u2208 (0, 1) and a quantum oracle Of as defined in (3). Let C denote a quantum circuit obtained with Algorithm 2 on input K, \u03b4,Of that correctly prepares the state\n|\u03d5\u27e9 = \u221ap |\u03c8\u27e9 |0\u27e9+ \u221a 1\u2212 p |\u03c8\u22a5\u27e9 |1\u27e9 , (24)\nwhere |\u03c8\u27e9 = \u2211\ni e fi(x\u0304)/2\u03f5\n\u2032 / \u221a\u2211\nj\u2208[N ] e fj(x\u0304)/\u03f5\u2032 |i\u27e9, p \u2265 K/N , and |\u03c8\u22a5\u27e9 is some unit state. The\nalgorithm performs O( \u221a KN log(1/\u03b4)) queries to Of . The circuit C performs two queries to Of .\nProof. Suppose that QuantumMaximumFinding returns a correct set H , which occurs with probability at least 1\u2212 \u03b4. The circuit C as depicted in Figure 1 operates on four registers: rot and ind that contains a Boolean value, qry that contains a real number, and out that contains an integer i \u2208 [N ]. The indicator gate 1H flips ind when out contains i /\u2208 H . Observe that the final state is C |0\u27e9 = |0\u27e9qry |0\u27e9ind |\u03d5\u27e9out,rot where\n|\u03d5\u27e9out,rot = \u221a W/Z |\u03c8\u27e9out |0\u27e9rot + \u221a 1\u2212W/Z |\u03c8\u22a5\u27e9out |0\u27e9rot (25)\nin whichW = \u2211\ni exp(fi(x\u0304)/\u03f5 \u2032) and |\u03c8\u22a5\u27e9 is some state whose value is irrelevant. To bound the coefficient p = \u221a W/Z , notice that by the definition of h, we must have exp(h/\u03f5\u2032) \u2264 W/K, or else\u2211\ni exp(fi(x\u0304)/\u03f5 \u2032) >W , which is a contradiction. Consequently, we obtain\np\u22121 = Z W = (N \u2212K) exp(h/\u03f5\u2032) +\n\u2211 i\u2208H exp(fi(x\u0304)/\u03f5\n\u2032)\u2211 i exp(fi(x\u0304)/\u03f5 \u2032) \u2264 N \u2212K K + 1 = N K (26)\nindicating that p \u2265 KN . Next, we bound the query complexity of the preparing of C. Notice that for QuantumMaximumFinding to succeed with probability at least 1 \u2212 \u03b4, it needs to make O( \u221a KN log(1/\u03b4)) queries to the oracle Of defined in (3), according to Proposition 1. Since all the remaining steps (Line 2-Line 4 in Algorithm 2) involve only classical computation, no additional quantum queries are required, the total number of quantum queries needed isO( \u221a KN log(1/\u03b4)).\nNext, we present the proof of Lemma 1.\nProof of Lemma 1. The result follows directly from Lemma 3 and Proposition 3. Given that p \u2265\u221a K/N , AmplitudeAmplification requires only O( \u221a N/K) calls to C. Notice that each call to C only costs two quantum calls, the cost for preparing K copied states is O( \u221a NK). Combining these costs with the cost for preparing C gives the result of Lemma 1.\nNote that preparing D, we keep only the first K largest elements in the distribution to make sure that the coefficient \u221a p before |\u03c8\u27e9 can be lower bounded. This ensures that the amplitude amplification algorithm can prepare K identical target states with the lowest total cost.\nNext, we provide some classic results regarding Fmax and Fsmax,\u03f5. Lemma 4. Given Fmax and Fsmax,\u03f5 as defined in (12). If x\u22c6 is an approximate minimizing point of Fsmax,\u03f5 with suboptimality \u03f5/2, then x\u22c6 is also an approximate minimizing point of Fmax with suboptimality \u03f5.\nProof. The proof is straightforward given the fact that 0 \u2264 Fsmax,\u03f5(x)\u2212Fmax(x) \u2264 \u03f5/2 (see Carmon et al. 2020b, Lemma 45). Thus, we have\nFmax(x\u22c6)\u2212 min x\u2208Rd Fmax(x\u22c6) = Fmax(x\u22c6)\u2212 min x\u2208BR(x0) Fmax(x\u22c6) (27)\n\u2264 Fsmax,\u03f5(x\u22c6)\u2212 min x\u2208BR(x0)\nFsmax,\u03f5(x) + \u03f5\n2 \u2264 \u03f5. (28)\nLemma 5 (Rephrased from Carmon et al. 2021, Lemma 1). Let f1, . . . , fN each be Lf -Lipschitz and Lg-smooth gradients. For any c > 0, r \u2264 c\u03f5\u2032/Lf , and \u03bb \u2264 cLf/r let C = (1+ c+ c2)ec+c\n2/2. The exponentiated softmax \u0393\u03f5,\u03bb satisfies the following properties for any x\u0304 \u2208 Rd.\n\u2022 F\u03bbsmax,\u03f5 and \u0393\u03f5,\u03bb have the same minimizer x in Br(x\u0304). Moreover, for every x \u2208 Br(x\u0304),\nF\u03bbsmax,\u03f5(x)\u2212 F\u03bbsmax,\u03f5(x\u22c6) \u2264 C(\u0393\u03f5,\u03bb(x)\u2212 \u0393\u03f5,\u03bb(x\u22c6)). (29)\n\u2022 Restricted to Br(x\u0304), \u03b3i(x) = \u03f5\u2032ef \u03bb i (x)\u2212f \u03bb i (x\u0304) is CLf -Lipshitz, \u03bb/C strongly convex, and\nC(Lg + \u03bb+ L 2 f \u03f5 \u2032)-smooth."
        },
        {
            "heading": "B PROOF DETAILS OF OUR QUANTUM LOWER BOUND",
            "text": "B.1 WARMUP: QUANTUM LOWER BOUND FOR MULTI-ROUNDS UNSTRUCTURED SEARCH PROBLEM\nFirst, we consider where the difficulty lies in minimizing the hard instance. Consider an algorithm that tries to achieve prog\u03b1(U\n\u22a4x) = T on the \u201cshuffled\u201d version of f : \u2200x, f\u0303(x) = max f\u0303i(U\u22a4x), f\u0303i = f\u03a0\u22121(i) in which U is a random rotation and \u03a0 is a random permutation.\nDefinition 3. Based on an \u03b1-robust N -element zero-chain, we define its shuffled version f\u0303(x) = max f\u0303i(x) such that for all x \u2208 BR(0), all y in a neighborhood of x, and all i \u2208 [N ], we have\nprog\u03b1(U \u22a4x) \u2264 p =\u21d2 f\u0303i(y) =  f\u03a0\u22121(i)(U \u22a4y[\u2264p]) \u03a0 \u22121(i) < p+ 1 f\u03a0\u22121(i)(U \u22a4y[\u2264p+1]) \u03a0 \u22121(i) = p+ 1\nfN (U \u22a4y[\u2264p]) \u03a0 \u22121(i) > p+ 1,\n(30)\nin which U is an arbitrary rotation and \u03a0 is a permutation over [N ].\nIn order to make progress, the algorithm can either guess randomly (succeeds with minor probability) or use the oracle information. However, at first all of the gradients are 0 unless the algorithm queries f\u03a0(1). Then, \u03a0(2) needs to be discovered to uncover a new gradient direction. Thus, the algorithm needs to sequentially discover \u03a0(2), . . .\u03a0(T ) in order to find the x with progress T , each of which is approximately an unstructured search problem requiring a certain number of oracle queries.\nFrom the structure of the hard instance, we see that the key of finding the minimum of an N -element zero chain is to find an x that has a large prog\u03b1 and an i that is in the right direction (since on any other direction the oracle would only reveal information regarding the \u201cshallower\u201d fi\u2019s). Notice that this is essentially a multi-round version of the unstructured search problem where one need to sequentially search the xp, ip\u2019s such that prog\u03b1(xp) = p and ip = \u03a0(p + 1). Thus, to establish a quantum query lower bound for our problem, we begin by introducing the following variant of an unstructured search problem that has the same underlying structure as the Definition 3.\nProblem 1 (Multi-rounds unstructured search problem). For some N,K \u2265 0 and d \u2265 10K lnN , suppose there is a sequence of K numbers a1, . . . , aK \u2208 [N ] and each number ai is associated with a different \u201ckey\u201d si which is a d-bit string. Suppose s1 = 0d. Define the search function Fsearch : [N ]\u00d7 {0, 1}d \u2192 {0, 1}d to be\nFsearch(a, s) = { si+1, if \u2203i \u2208 [K] such that a = ai and s = si, 0d, otherwise.\n(31)\nIntuitively, we can discover the i + 1th key if and only if we know the ith number ai and its corresponding key si. Suppose we have access to the following quantum oracle Osearch encoding the value of Fsearch:\nOsearch |s\u27e9 |a\u27e9 |0\u27e9 \u2192 |s\u27e9 |a\u27e9 |Fsearch(a, s)\u27e9 , (32) the goal is to output sK .\nWe prove a quantum query lower bound for Problem 1 by first dividing the oracle Osearch into a series of oracles. In particular, we define a set of functions F (1)search, . . . , F (K) search where each F (i) search is defined as\nF (i) search(a, s) = { si+1, if a = ai and s = si, 0d, otherwise.\n(33)\nAs we can see, each F (i)search represents Fsearch in certain input domain. Moreover, we define a series of quantum oracles O(1)search, . . . , O (K) search encoding the values of F (1) search, . . . , F (K) search,\nO (i) search |s\u27e9 |a\u27e9 |0\u27e9 \u2192 |s\u27e9 |a\u27e9 \u2223\u2223\u2223F (i)search(a, s)\u232a . (34) Then, one query to the oracle Osearch can be implemented using at most K queries to the oracles O\n(1) search, . . . , O (K) search. The following lemma shows that, if the i th key si is not fully discovered, it would be hard to further discover the next key si+1 even given access to the oracle O (i) search. Lemma 6. For any quantum algorithm A making at most T = \u221a N/6 queries to the oracles {O(i)search}\nA = O(iT \u22121)search VT \u22121O (iT \u22122) search \u00b7 \u00b7 \u00b7O (i0) searchV0, (35)\nfor any 0 \u2264 k < K, if at any step t of the algorithm the intermediate quantum state |\u03a8t\u27e9 has in expectation at most \u03b4 overlap with |sk\u27e9, i.e., E\nsk |\u27e8sk|\u03a8t\u27e9| \u2264 \u03b4, we have\nE ak,sk,sk+1\n|\u27e8sk+1|\u03a8t\u27e9| \u2264 \u03b4\n3 +\n1\n2d/2 . (36)\nProof. For any fixed value of ak and sk+1, we use \u2223\u2223\u03a8kt \u232a to denote the quantum state at stage t. Similarly, we use |\u03a8\u2032t\u27e9 to denote the quantum state at stage t if any query to O (k) search is replaced by an identity operation, which can be expressed as\n|\u03a8\u2032t\u27e9 = |\u27e8sk|\u03a8\u2032t\u27e9| |sk\u27e9 |\u03d5\u2032t\u27e9+ \u221a 1\u2212 |\u27e8sk|\u03a8\u2032t\u27e9|2 \u2223\u2223\u03d5\u2032\u22a5t \u232a , (37) where |\u03d5\u2032t\u27e9 represents the quantum state in the second and the third register that can be written as\n|\u03d5\u2032t\u27e9 = \u2211 i\u2208[N ] \u03b2t,i |i\u27e9 |ri,t\u27e9 , (38)\nwhere we reorganize the state with respect to the second register, whose computational basis corresponds to all possible values of the N items.\nThen for any value of ak, we have\u2225\u2225\u2223\u2223\u03a8kt \u232a\u2212 |\u03a8\u2032t\u27e9\u2225\u2225 \u2264 2|\u27e8sk|\u03a8t\u27e9| t\u22121\u2211 \u03c4=0 |\u03b2t,ak |. (39)\nConsider taking expectation over sk and ak, based on our assumption that E sk |\u27e8sk|\u03a8t\u27e9| \u2264 \u03b4, we have\nE sk \u2225\u2225\u2223\u2223\u03a8kt \u232a\u2212 |\u03a8\u2032t\u27e9\u2225\u2225 \u2264 2\u03b4 t\u22121\u2211 \u03c4=0 |\u03b2t,ak |, (40)\nand\nE sk,ak \u2225\u2225\u2223\u2223\u03a8kt \u232a\u2212 |\u03a8\u2032t\u27e9\u2225\u2225 \u2264 2\u03b4 t\u22121\u2211 \u03c4=0 E ak |\u03b2t,ak | \u2264 2\u03b4t\u221a N \u2264 \u03b4 3 . (41)\nSince |\u03a8\u2032t\u27e9 is irrelavant from sk+1, we can derive that\nE sk+1 |\u27e8sk+1|\u03a8\u2032t\u27e9| \u2264 2\u2212d/2, (42)\nwhich leads to\nE ak,sk,sk+1 |\u27e8sk+1|\u03a8t\u27e9| \u2264 E sk,ak \u2225\u2225\u2223\u2223\u03a8kt \u232a\u2212 |\u03a8\u2032t\u27e9\u2225\u2225+ E sk+1 |\u27e8sk+1|\u03a8\u2032t\u27e9| \u2264 \u03b4 3 + 1 2d/2 . (43)\nLemma 7. For any K \u2264 2d, any quantum algorithm making less than \u221a N\n6K queries to the oracle Osearch defined in (32), there exists an instance of Problem 1 such that the algorithm fails to solve Problem 1 with expected probability 1 \u2212 2\u2212K among all possible sK , or equivalently, for any intermediate state |\u03a8\u27e9 of the algorithm, we have\nE sK |\u27e8\u03a8|sK\u27e9| \u2264 2\u2212K . (44)\nProof. We first prove a quantum query lower bound for Problem 1 with access to the oracles O\n(1) search, . . . , O (K) search. In particular, we consider any quantum algorithm A for Problem 1 using\nT = \u221a N/6 queries to O(1)search, . . . , O (K) search for some large enough constant C \u2265 1, it can be expressed as\nO (iT \u22121) search VT \u22121O (iT \u22122) search \u00b7 \u00b7 \u00b7O (i0) searchV0 |0\u27e9 . (45)\nDenote |\u03c8out\u27e9 to be its output quantum state. We use \u03b4i to denote the expected overlap with |si\u27e9 among any intermediate stage of the algorithm. Then by Lemma 6, we have\n\u03b4i+1 \u2264 \u03b4i 3 + 1 2d/2 , (46)\nwhich leads to\nE sK |\u27e8\u03a8|sK\u27e9| \u2264\n1\n3K +\n1 2d/2\u22121 \u2264 1 2K . (47)\nThat is to say, any quantum algorithm making at most \u221a N/6 queries to the oracles O (1) search, . . . , O (K) search will fail to find sK with probability at least 1\u2212 2\u2212K . Since the oracle Osearch can be implemented using K queries to O(1)search, . . . , O (K) search, we can conclude that for any quantum\nalgorithm making at most \u221a N/(6K) queries to Osearch, it fails to solve Problem 1 with expected probability 1\u2212 2\u2212K among all possible sK .\nThis result shows that quantum algorithms cannot do much better than classic algorithm when tackling a sequential structure where each step requires finding a new secret for the next direction. The only speedup in this case is the quadratic speedup brought by Grover\u2019s algorithm on the unstructured search problem. Moreover, the error of any quantum algorithm is exponential with the depth of the problem.\nB.2 PROOF OF PROPOSITION 6\nFrom an oracle Of , we defined its \u201cshuffled\u201d version Of\u0303 for f\u0303 (Definition 3) where Of\u0303 |i\u27e9 |x\u27e9 = Of \u2223\u2223\u03a0\u22121(i)\u232a \u2223\u2223U\u22a4x\u232a (48)\nin which \u03a0 is a randomly sampled permutation over [N ] and U is a randomly sampled rotation. According to the property of the zero chain, the subspace that we are interested in is the one in which the progress is greater than expected. Formally speaking, we define\nP\u22a5t = {x \u2208 BR(0)|\u2203i > t.\u27e8x,ui\u27e9 > \u03b1, i \u2208 [T ]} P \u2225 t = BR(0)\u2212 P\u22a5t (49)\nTo prove Proposition 6, we begin by observing that making progress on an N -element zero-chain is essentially solving the multi-round unstructured search problem (Problem 1). In particular, Of\u0303 is the analog of Osearch defined in (32), the p-th function after pi is the analog of the solution of the p-th round of the unstructured search problem, and the informative region of this function is the analog of the \u201ckey\u201d in this round. Moreover, we define the following \u201ctruncated\u201d oracle O(i)\nf\u0303 of Of\u0303 , to be the\nanalog of the oracle O(i)search in Section B.1.\nO (i)\nf\u0303 |j\u27e9 |x\u27e9 = Ofi \u2223\u2223\u03a0\u22121(j)\u232a \u2223\u2223U\u22a4x\u232a , (50) where Ofi is the evaluation oracle for the i-th function fi. Based on this oracle, we prove the following result that is an analog of Lemma 6. Lemma 8. For any quantum algorithm A making at most T = \u221a N/6 queries to the oracles {O(i)\nf\u0303 }\nA = O(iT \u22121) f\u0303 VT \u22121O (iT \u22122) f\u0303 \u00b7 \u00b7 \u00b7O(i0) f\u0303 V0, (51)\nfor any 0 \u2264 k < K, if at any step t of the algorithm the intermediate quantum state |\u03a8t\u27e9 satisfies\nE \u03a0,U \u2225P(\u03a0\u22121(k)) |\u03a8t\u27e9 \u2225 \u2264 \u03b4, (52)\nwhere P(j) denotes the projector onto the informative region of the j-th function fj , we have\nE \u03a0,U \u2225P(\u03a0\u22121(k + 1)) |\u03a8t\u27e9 \u2225 \u2264\n\u03b4 3 + 2e\u2212d\u03b1 2/2. (53)\nProof. We use \u2223\u2223\u03a8kt \u232a to denote the quantum state at stage t. Similarly, we use |\u03a8\u2032t\u27e9 to denote the quantum state at stage t if any query to O(k) f\u0303\nis replaced by an identity operation, which can be expressed as\n|\u03a8\u2032t\u27e9 = \u2225P(\u03a0\u22121(k)) |\u03a8\u2032t\u27e9 \u2225P(\u03a0\u22121(k)) |\u03a8\u2032t\u27e9+ \u221a 1\u2212 \u2225P(\u03a0\u22121(k)) |\u03a8\u2032t\u27e9 \u22252 |\u22a5\u27e9 , (54)\nwhere P(\u03a0\u22121(k)) |\u03a8\u2032t\u27e9 represents the quantum state in the second and the third register that can be written as\nP(\u03a0\u22121(k)) |\u03a8\u2032t\u27e9 = \u2211 i\u2208[N ] \u03b2t,i |i\u27e9 |xi,t\u27e9 , (55)\nwhere we reorganize the state with respect to the second register, whose computational basis corresponds to all possible values in [N ]. Then we can derive that\n\u2225\u2225\u2223\u2223\u03a8kt \u232a\u2212 |\u03a8\u2032t\u27e9\u2225\u2225 \u2264 2\u2225P(\u03a0\u22121(k)) |\u03a8\u2032t\u27e9 \u2225 t\u22121\u2211 \u03c4=0 |\u03b2\u03c4,x|. (56)\nConsider taking expectation over \u03a0 and U , based on our assumption that E \u03a0,U \u2225P(\u03a0\u22121(k)) |\u03a8t\u27e9 \u2225 \u2264 \u03b4, we have\nE sk \u2225\u2225\u2223\u2223\u03a8kt \u232a\u2212 |\u03a8\u2032t\u27e9\u2225\u2225 \u2264 2\u03b4 t\u22121\u2211 \u03c4=0 |\u03b2\u03c4,\u03a0\u22121(k)|, (57)\nand\nE \u03a0,U \u2225\u2225\u2223\u2223\u03a8kt \u232a\u2212 |\u03a8\u2032t\u27e9\u2225\u2225 \u2264 2\u03b4 t\u22121\u2211 \u03c4=0 E|\u03b2\u03c4,\u03a0\u22121(k)| \u2264 2\u03b4t\u221a N \u2264 \u03b4 3 . (58)\nSince |\u03a8\u2032t\u27e9 is irrelavant from U and \u03a0, using a known fact in the probability theory (see e.g., Zhang & Li 2023, Lemma 17)\nPr u (\u27e8x,u\u27e9 \u2265 \u03b1) \u2264 2e\u2212d\u03b1 2/2, (59)\nwe have\nE \u03a0,U |\u2225P(\u03a0\u22121(k)) |\u03a8\u2032t\u27e9 \u2225 \u2264 2e\u2212d\u03b1 2/2, (60)\nby which we can conclude that\nE\u2225P(\u03a0\u22121(k + 1)) |\u03a8t\u27e9 \u2225 \u2264 E \u03a0,U \u2225\u2225\u2223\u2223\u03a8kt \u232a\u2212 |\u03a8\u2032t\u27e9\u2225\u2225+ E \u03a0,U |\u2225P(\u03a0\u22121(k)) |\u03a8\u2032t\u27e9 \u2225 (61)\n\u2264 \u03b4 3 + 2e\u2212d\u03b1 2/2. (62)\nThe next lemma is an analog of Lemma 7. Lemma 9. For any K \u2264 d\u03b12/4, any quantum algorithm making less than \u221a N\n6K queries to the oracle Of\u0303 defined in (32), for any intermediate state |\u03a8\u27e9 of the algorithm, we have\nE \u03a0,U \u2225P(\u03a0\u22121(K)) |\u03a8\u27e9 \u2225 \u2264 2\u2212K . (63)\nProof. We first consider the case with access to the oraclesO(1) f\u0303 , . . . , O (K) f\u0303 . In particular, we consider any quantum algorithmA for Problem 1 using T = \u221a N/6 queries to O(1)\nf\u0303 , . . . , O\n(K) f\u0303 for some large\nenough constant C \u2265 1, it can be expressed as\nO (iT \u22121)\nf\u0303 VT \u22121O\n(iT \u22122) f\u0303 \u00b7 \u00b7 \u00b7O(i0) f\u0303 V0 |0\u27e9 . (64)\nDenote |\u03c8out\u27e9 to be its output quantum state. We use \u03b4i to denote the expected value of \u2225P(\u03a0\u22121(i)) |\u03a8\u27e9 \u2225 among any intermediate stage of the algorithm. Then by Lemma 6, we have\n\u03b4i+1 \u2264 \u03b4i 3 + 2e\u2212d\u03b1 2/2, (65)\nwhich leads to\n\u03b4K \u2264 1\n3K + 4e\u2212d\u03b1 2/2 \u2264 1 2K . (66)\nThat is to say, any quantum algorithm making at most \u221a N/6 queries to the oracles O(1)\nf\u0303 , . . . , O\n(K)\nf\u0303\nwill fail to find sK with probability at least 1 \u2212 2\u2212K . Since the oracle Of\u0303 can be implemented using K queries to O(1)\nf\u0303 , . . . , O\n(K) f\u0303 , we can conclude that for any quantum algorithm making at most\n\u221a N/(6K) queries to Of\u0303 , any intermediate state |\u03a8\u27e9 of the algorithm satisfies (63).\nLemma 10. Consider the unitary An with n queries to Of\u0303 of the form\nAn = Of\u0303Vn\u22121Of\u0303 \u00b7 \u00b7 \u00b7Of\u0303V0 (67)\nin which n = \u221a N/(6K) and K = 4 log T + 12 logN + 5. Then for any input state |\u03c8\u27e9, we have\n\u03b3(n) = E [\u2225\u2225P\u22a5KAn |\u03c8\u27e9\u2225\u22252] \u2264 1\n16 \u221a NT 4 , (68)\nas long as the dimension d \u2265 4K/\u03b12.\nProof. Observe that we can achieve \u03b3(n) by the summation of overlap given in Lemma 9 and an upper bound of the success probability of random guesses. The first term is at most\n2\u2212K = 1\n32 \u221a NT 4 , (69)\nby Lemma 9. Meanwhile, the second term is at most\nT \u00b7 2e\u2212d\u03b1 2/2 \u2264 1\n32 \u221a NT 4 , (70)\nby which we can conclude that\n\u03b3(n) \u2264 1 16 \u221a NT 4 . (71)\nNext, we state the fact that it is fundamentally hard to make progress by random guessing. Lemma 11 (Cannot make progress through guessing). Let {ui}ti=1 be a set of fixed orthonormal vectors. Choose {ui}Ti=t+1 uniformly randomly such that {ui}Ti=1 is orthonormal. Then\n\u2200x \u2208 BR(0), Pr ut+1,...uT\n(prog\u03b1T x \u2265 t) \u2264 2Te \u2212(d\u2212T )/32T 3 (72)\nin which \u03b1T = 1/(4T 3/2).\nProof. We use a standard union bound with some common facts to prove this lemma. First, using a union bound we have\nPr ut+1,...uT\n(prog\u03b1(x) \u2265 t) \u2264 T\u2211\ni=t+1\nPr(\u27e8x,ui\u27e9 \u2265 \u03b1) (73)\n= (T \u2212 t) Pr(\u27e8x,ui\u27e9 \u2265 \u03b1) (74) where the final equality is due to the symmetry among ui\u2019s. Next, using a known fact in the probability theory (see e.g., Zhang & Li 2023, Lemma 17) we have\nPr u (\u27e8x,u\u27e9 \u2265 c) \u2264 2e\u2212dc 2/2. (75)\nConsidering that ut+1, . . .uT are sampled from a d \u2212 T dimention space orthogonal to the fixed vectors, we have\nPr ut+1,...uT\n(prog\u03b1(x) \u2265 t) \u2264 2Te\u2212(d\u2212T )/32T 3 . (76)\nWith these results at hand, we now articulate the proof technique for Proposition 6. The proof technique involves using a quantum hybrid such that it is almost impossible for the last hybrid to find the minimizing point. First, we introduce a truncated oracle\nO\u0303t |i\u27e9 |x\u27e9 |y\u27e9 \u2192 |i\u27e9 |x\u27e9 \u2223\u2223y \u2295 f\u03a0\u22121(i) (u\u22a41 x, u\u22a42 x . . . u\u22a4t x, 0, . . . , 0)\u232a . (77)\nNote that O\u0303t does not reveal any information about U>t. Given a quantum algorithm A making n \u2264 T \u221a N/CK queries, the algorithm can be represented in the form\nA = VnOf\u0303Vn\u22121 \u00b7 \u00b7 \u00b7Of\u0303V0. (78)\nFrom this algorithm we could build k hybrids:\nA0 = A = Vk\u221aN/CKOf\u0303 \u00b7 \u00b7 \u00b7 O\u030310 log TV\u221aN/CK\u22121 \u00b7 \u00b7 \u00b7Of\u0303V1Of\u0303V0,\nA1 = Vk \u221a N/CKOf\u0303 \u00b7 \u00b7 \u00b7 O\u030310 log TV\u221aN/CK\u22121 \u00b7 \u00b7 \u00b7 O\u030310 log TV1O\u030310 log TV0,\n\u00b7 \u00b7 \u00b7 Ak = Vk \u221a N/CKO\u030310k log T \u00b7 \u00b7 \u00b7 O\u030310 log TV\u221aN/CK\u22121 \u00b7 \u00b7 \u00b7 O\u030310 log TV1O\u030310 log TV0.\n(79)\nNote that the difference between two consecutive hybridsAi\u22121 andAi is that \u221a N/CK of the oracles Of\u0303 are changed to O\u0303t log T . Following the standard hybrid argument, in the subsequent lemmas we demonstrate that the output of the sequence of unitaries (the difference between At and At\u22121) on random input is similar. Lemma 12. For any t \u2208 [T \u2212 1] and any n \u2264 \u221a N/CK for K = 4 log T + 12 logN + 4, consider the following two sequences of unitaries,\nA(n) = Of\u0303VnOf\u0303Vn\u22121 \u00b7 \u00b7 \u00b7Of\u0303V0 (80)\nand A\u0302t(n) = O\u0303tVnO\u0303tVn\u22121 \u00b7 \u00b7 \u00b7 O\u0303tV0. (81) Given that d \u2265 T +max(32T 3 log(32 \u221a NT 5), 32T 3 log (12T )), we have\n\u03b4(n) := E [\u2225\u2225\u2225(A\u0302t \u2212A) |\u03c8\u27e9\u2225\u2225\u22252] \u2264 n\n16 \u221a NT 4\n(82)\nProof. We use induction to prove this lemma. For n = 1, we have \u03b4(1) = E [\u2225\u2225\u2225(Of\u0303 \u2212 O\u0303t) |\u03c8\u27e9\u2225\u2225\u22252] \u2264 1\n16 \u221a NT 4\n(83)\nwhere the inequality follows from Lemma 11. Suppose the inequality (82) holds for \u2200n \u2264 n\u0303 for some n\u0303 < \u221a n. For n = n\u0303+ 1, by Lemma 10, we first have that\nE [\u2225\u2225P\u22a5t |\u03c8n\u0303\u27e9\u2225\u22252] \u2264 1\n16 \u221a NT 4\n(84)\nNext, we have\n\u03b4(n) = \u03b4(1) = E [\u2225\u2225\u2225(Of\u0303 \u2212 O\u0303t) |\u03c8n\u0303\u27e9\u2225\u2225\u22252]+ \u03b4(n\u0303) (85)\n\u2264 E [\u2225\u2225P\u22a5t |\u03c8n\u0303\u27e9\u2225\u22252]+ \u03b4(n\u0303) \u2264 n\n16 \u221a NT 4 , (86)\nin which inequality (86) is due to the fact that only ui with i > t can contribute to the expectation. Lemma 13. If d \u2265 T + 32T 3 log ( 32 \u221a NT 5 ) , for an N -element zero chain f we have\nE[\u2225(At \u2212At\u22121) |0\u27e9\u22252] \u2264 1\n16T 4 . (87)\nProof. From the definition of the hybrid unitaries Ai in Eq. (79), we have E[\u2225(Ai \u2212Ai\u22121) |0\u27e9\u22252] = E [\u2225\u2225\u2225(A(\u221aN/CK)\u2212 A\u0302(\u221aN/CK)) |\u03c8\u27e9\u2225\u2225\u22252] . (88)\nThus, according to Lemma 12 the expectation is bounded by\nE[\u2225(Ai \u2212Ai\u22121) |0\u27e9\u22252] \u2264 1\n16T 4 . (89)\nEquipped with Lemma 13, we are now ready to prove Proposition 6.\nProof of Proposition 6. First, suppose that the quantum algorithmA only makes at most T \u221a N/CK2 queries, in which K = 4 log T + 12 logN + 4. According to the construction of the hybrid (79), the last vector uT is never revealed. Thus, by Lemma 11, letting d \u2265 T + max(32T 3 log(32 \u221a NT 5), 32T 3 log (4T/\u03b4)), the last unitary in the hybrid can find an x with sufficient progress with probability at most \u03b4/2.\nNext, we can bound the total variance distance between the distributions obtained by sampling A0 |0\u27e9 and AK |0\u27e9. By Lemma 13 and the Cauchy-Schwarz inequality, we have\nE[\u2225(AK \u2212A0) |0\u27e9\u22252] \u2264 K K\u22121\u2211 i=0 E[\u2225(Ai \u2212Ai\u22121) |0\u27e9\u22252] \u2264 1 16T 2 . (90)\nNow, applying Markov\u2019s inequality, we can establish that\nPr [ \u2225(AK \u2212A0) |0\u27e9\u22252 > 1\n4T\n] \u2264 1\n4T , (91)\nwhich indicates that the total variance distance can be bounded by summing up 1/(4T ) + 1/(4T ) = 1/(2T ) \u2264 \u03b4/2, provided that T \u2265 \u03b4\u22121. Combining these two parts allows us to upper bound the success probability by \u03b4.\nB.3 PROOF OF THEOREM 4\nFirst of all, we provide the hard instance we use in the proof of the main theorem:\nf\u0302 {T,N,\u2113} i (x) :=\n{ \u03c8\u03b1,\u2113 ( x[i]\u2212x[i\u22121]\n2\n) i \u2264 T,\n0 otherwise, (92)\nwhere we denote \u03b1T = 14T 3/2 , x[0] := 1\u221a T , and \u03c8\u03b1,\u2113 : R\u2192 R is defined as\n\u03c8\u03b1,\u2113(t) :=  0 |t| \u2264 \u03b1 \u2113 2 (t\u2212 \u03b1)\n2 \u03b1 \u2264 |t| \u2264 \u2113\u22121 + \u03b1 |t| \u2212 \u03b1\u2212 12\u2113 otherwise.\nThe properties of this hard instance f\u0302{T,N,\u2113} is given in the following lemma. Lemma 14 (Carmon et al. 2021, Lemma 2). For every T,N \u2208 N and \u2113 \u2265 0, such that T \u2264 N , we have that\n1. The hard instance (f\u0302{T,N,\u2113}i )i\u2208N is an \u03b1T -robust N -element zero-chain.\n2. The function f\u0302{T,N,\u2113}i is 1-Lipschitz and \u2113-smooth for every i \u2208 [N ].\n3. For any x \u2208 Rd with prog[\u03b1T ](x) < T , the objective F\u0302 {T,N,\u2113}(x) = maxi\u2208[N ] f\u0302 {T,N,\u2113} i (x)\nsatisfies\nF\u0302 {T,N,\u2113}(x)\u2212 min x\u22c6\u2208B1(0)\nF\u0302 {T,N,\u2113}(x\u22c6) \u2265 \u03c8\u03b1T ,\u2113 ( 3\n8T 3/2\n) \u2265 min ( 1\n8T 3/2 ,\n\u2113\n32T 3\n) .\nNext, we present the detailed proof of Theorem 4 using Proposition 6 and the hard instance defined in (92).\nProof of Theorem 4. Theorem 4 is a direct result of Proposition 6 and the property of (92). Notice that from Proposition 6, when d \u2265 T +max(32T 3 log(32 \u221a NT 5), 32T 3 log (4T/\u03b4)) and T \u2265 3, the success probability of the quantum algorithm A making at most T \u221a N/C \u00b7 (4 log T + 12 logN + 4) 2 queries discovering uT is at most 1/3. Set\nT = 1\n5 max\n(( LfR\n\u03f5\n)2/3 , ( LgR 2\n\u03f5\n)1/3) and L = LgR/Lf . (93)\nNote that under this setting we have that the lower bound number of queries is T \u221a N/C(4 log T + 1 2 logN + 4) 2 = \u2126\u0303( \u221a N\u03f5\u22122/3). According to the part 3 of Lemma 14, if the algorithm failed in discovering the T th direction uT (i.e., prog\u03b1T (x) < T ), the suboptimality of the output minimizing point is at least min{ 1\n8T 3/2 , L32T 3 } \u2264 \u03f5. Thus, we have\nPr [ Fmax(xout)\u2212 min\nx\u2208BdR(0) Fmax(x) \u2265 \u03f5\n] \u2264 1\n3 . (94)"
        }
    ],
    "year": 2024
}