{
    "abstractText": "The capabilities of large language models (LLMs) have sparked debate over whether such systems just learn an enormous collection of superficial statistics or a set of more coherent and grounded representations that reflect the real world. We find evidence for the latter by analyzing the learned representations of three spatial datasets (world, US, NYC places) and three temporal datasets (historical figures, artworks, news headlines) in the Llama-2 family of models. We discover that LLMs learn linear representations of space and time across multiple scales. These representations are robust to prompting variations and unified across different entity types (e.g. cities and landmarks). In addition, we identify individual \u201cspace neurons\u201d and \u201ctime neurons\u201d that reliably encode spatial and temporal coordinates. While further investigation is needed, our results suggest modern LLMs learn rich spatiotemporal representations of the real world and possess basic ingredients of a world model.",
    "authors": [],
    "id": "SP:88c817d55ba31f68dfff700d7a8ea885394f8c95",
    "references": [
        {
            "authors": [
                "Mostafa Abdou",
                "Artur Kulmizev",
                "Daniel Hershcovich",
                "Stella Frank",
                "Ellie Pavlick",
                "Anders S\u00f8gaard"
            ],
            "title": "Can language models encode perceptual structure without grounding? a case study in color",
            "venue": "arXiv preprint arXiv:2109.06129,",
            "year": 2021
        },
        {
            "authors": [
                "Guillaume Alain",
                "Yoshua Bengio"
            ],
            "title": "Understanding intermediate layers using linear classifier probes",
            "venue": "arXiv preprint arXiv:1610.01644,",
            "year": 2016
        },
        {
            "authors": [
                "Issa Annamoradnejad",
                "Rahimberdi Annamoradnejad"
            ],
            "title": "Age dataset: A structured general-purpose dataset on life, work, and death of 1.22 million distinguished people",
            "venue": "International AAAI Conference on Web and Social Media (ICWSM),",
            "year": 2022
        },
        {
            "authors": [
                "Jack Bandy"
            ],
            "title": "Three decades of new york times headlines, 2021",
            "venue": "URL https://www.kaggle. com/datasets/johnbandy/new-york-times-headlines. Kaggle dataset",
            "year": 2021
        },
        {
            "authors": [
                "Yonatan Belinkov"
            ],
            "title": "Probing classifiers: Promises, shortcomings, and advances",
            "venue": "Computational Linguistics,",
            "year": 2022
        },
        {
            "authors": [
                "Emily M Bender",
                "Alexander Koller"
            ],
            "title": "Climbing towards nlu: On meaning, form, and understanding in the age of data",
            "venue": "In Proceedings of the 58th annual meeting of the association for computational linguistics,",
            "year": 2020
        },
        {
            "authors": [
                "Emily M Bender",
                "Timnit Gebru",
                "Angelina McMillan-Major",
                "Shmargaret Shmitchell"
            ],
            "title": "On the dangers of stochastic parrots: Can language models be too big",
            "venue": "In Proceedings of the 2021 ACM conference on fairness, accountability, and transparency,",
            "year": 2021
        },
        {
            "authors": [
                "Stella Biderman",
                "Hailey Schoelkopf",
                "Quentin Gregory Anthony",
                "Herbie Bradley",
                "Kyle O\u2019Brien",
                "Eric Hallahan",
                "Mohammad Aflah Khan",
                "Shivanshu Purohit",
                "USVSN Sai Prashanth",
                "Edward Raff"
            ],
            "title": "Pythia: A suite for analyzing large language models across training and scaling",
            "venue": "In International Conference on Machine Learning,",
            "year": 2023
        },
        {
            "authors": [
                "Yonatan Bisk",
                "Ari Holtzman",
                "Jesse Thomason",
                "Jacob Andreas",
                "Yoshua Bengio",
                "Joyce Chai",
                "Mirella Lapata",
                "Angeliki Lazaridou",
                "Jonathan May",
                "Aleksandr Nisnevich"
            ],
            "title": "Experience grounds language",
            "year": 2004
        },
        {
            "authors": [
                "Rishi Bommasani",
                "Drew A Hudson",
                "Ehsan Adeli",
                "Russ Altman",
                "Simran Arora",
                "Sydney von Arx",
                "Michael S Bernstein",
                "Jeannette Bohg",
                "Antoine Bosselut",
                "Emma Brunskill"
            ],
            "title": "On the opportunities and risks of foundation models",
            "venue": "arXiv preprint arXiv:2108.07258,",
            "year": 2021
        },
        {
            "authors": [
                "S\u00e9bastien Bubeck",
                "Varun Chandrasekaran",
                "Ronen Eldan",
                "Johannes Gehrke",
                "Eric Horvitz",
                "Ece Kamar",
                "Peter Lee",
                "Yin Tat Lee",
                "Yuanzhi Li",
                "Scott Lundberg"
            ],
            "title": "Sparks of artificial general intelligence: Early experiments with gpt-4",
            "venue": "arXiv preprint arXiv:2303.12712,",
            "year": 2023
        },
        {
            "authors": [
                "Collin Burns",
                "Haotian Ye",
                "Dan Klein",
                "Jacob Steinhardt"
            ],
            "title": "Discovering latent knowledge in language models without supervision",
            "venue": "arXiv preprint arXiv:2212.03827,",
            "year": 2022
        },
        {
            "authors": [
                "Hoagy Cunningham",
                "Aidan Ewart",
                "Logan Riggs",
                "Robert Huben",
                "Lee Sharkey"
            ],
            "title": "Sparse autoencoders find highly interpretable features in language models",
            "venue": "arXiv preprint arXiv:2309.08600,",
            "year": 2023
        },
        {
            "authors": [
                "dlish",
                "Dario Amodei",
                "Christopher Olah"
            ],
            "title": "Softmax linear units",
            "venue": "Transformer Circuits Thread,",
            "year": 2022
        },
        {
            "authors": [
                "Nelson Elhage",
                "Tristan Hume",
                "Catherine Olsson",
                "Nicholas Schiefer",
                "Tom Henighan",
                "Shauna Kravec",
                "Zac Hatfield-Dodds",
                "Robert Lasenby",
                "Dawn Drain",
                "Carol Chen"
            ],
            "title": "Toy models of superposition",
            "venue": "arXiv preprint arXiv:2209.10652,",
            "year": 2022
        },
        {
            "authors": [
                "Mor Geva",
                "Jasmijn Bastings",
                "Katja Filippova",
                "Amir Globerson"
            ],
            "title": "Dissecting recall of factual associations in auto-regressive language models",
            "venue": "arXiv preprint arXiv:2304.14767,",
            "year": 2023
        },
        {
            "authors": [
                "Gabriel Goh",
                "Nick Cammarata",
                "Chelsea Voss",
                "Shan Carter",
                "Michael Petrov",
                "Ludwig Schubert",
                "Alec Radford",
                "Chris Olah"
            ],
            "title": "Multimodal neurons in artificial neural networks. Distill",
            "year": 2021
        },
        {
            "authors": [
                "Abhijeet Gupta",
                "Gemma Boleda",
                "Marco Baroni",
                "Sebastian Pad\u00f3"
            ],
            "title": "Distributional vectors encode referential attributes",
            "venue": "In Proceedings of the 2015 Conference on Empirical Methods in Natural Language Processing,",
            "year": 2015
        },
        {
            "authors": [
                "Wes Gurnee",
                "Neel Nanda",
                "Matthew Pauly",
                "Katherine Harvey",
                "Dmitrii Troitskii",
                "Dimitris Bertsimas"
            ],
            "title": "Finding neurons in a haystack: Case studies with sparse probing",
            "venue": "arXiv preprint arXiv:2305.01610,",
            "year": 2023
        },
        {
            "authors": [
                "Torkel Hafting",
                "Marianne Fyhn",
                "Sturla Molden",
                "May-Britt Moser",
                "Edvard I Moser"
            ],
            "title": "Microstructure of a spatial map in the entorhinal cortex",
            "year": 2005
        },
        {
            "authors": [
                "Michael Hanna",
                "Ollie Liu",
                "Alexandre Variengien"
            ],
            "title": "How does gpt-2 compute greater-than?: Interpreting mathematical abilities in a pre-trained language model",
            "venue": "arXiv preprint arXiv:2305.00586,",
            "year": 2023
        },
        {
            "authors": [
                "Trevor Hastie",
                "Robert Tibshirani",
                "Jerome H Friedman"
            ],
            "title": "The elements of statistical learning: data mining, inference, and prediction, volume",
            "year": 2009
        },
        {
            "authors": [
                "Dan Hendrycks",
                "Mantas Mazeika",
                "Thomas Woodside"
            ],
            "title": "An overview of catastrophic ai risks",
            "venue": "arXiv preprint arXiv:2306.12001,",
            "year": 2023
        },
        {
            "authors": [
                "Evan Hernandez",
                "Arnab Sen Sharma",
                "Tal Haklay",
                "Kevin Meng",
                "Martin Wattenberg",
                "Jacob Andreas",
                "Yonatan Belinkov",
                "David Bau"
            ],
            "title": "Linearity of relation decoding in transformer language models",
            "venue": "arXiv preprint arXiv:2308.09124,",
            "year": 2023
        },
        {
            "authors": [
                "Michal Konkol",
                "Tom\u00e1\u0161 Brychc\u0131\u0301n",
                "Michal Nykl",
                "Tom\u00e1\u0161 Hercig"
            ],
            "title": "Geographical evaluation of word embeddings",
            "venue": "In Proceedings of the Eighth International Joint Conference on Natural Language Processing (Volume 1: Long Papers),",
            "year": 2017
        },
        {
            "authors": [
                "Jens Lehmann",
                "Robert Isele",
                "Max Jakob",
                "Anja Jentzsch",
                "Dimitris Kontokostas",
                "Pablo N. Mendes",
                "Sebastian Hellmann",
                "Mohamed Morsey",
                "Patrick van Kleef",
                "S\u00f6ren Auer",
                "Christian Bizer"
            ],
            "title": "Dbpedia - a large-scale, multilingual knowledge base extracted from wikipedia",
            "venue": "URL http://dbpedia.org. Version",
            "year": 2015
        },
        {
            "authors": [
                "Belinda Z Li",
                "Maxwell Nye",
                "Jacob Andreas"
            ],
            "title": "Implicit representations of meaning in neural language models",
            "venue": "arXiv preprint arXiv:2106.00737,",
            "year": 2021
        },
        {
            "authors": [
                "Kenneth Li",
                "Aspen K Hopkins",
                "David Bau",
                "Fernanda Vi\u00e9gas",
                "Hanspeter Pfister",
                "Martin Wattenberg"
            ],
            "title": "Emergent world representations: Exploring a sequence model trained on a synthetic task",
            "venue": "arXiv preprint arXiv:2210.13382,",
            "year": 2022
        },
        {
            "authors": [
                "Bastien Li\u00e9tard",
                "Mostafa Abdou",
                "Anders S\u00f8gaard"
            ],
            "title": "Do language models know the way to rome",
            "venue": "arXiv preprint arXiv:2109.07971,",
            "year": 2021
        },
        {
            "authors": [
                "Leo Z Liu",
                "Yizhong Wang",
                "Jungo Kasai",
                "Hannaneh Hajishirzi",
                "Noah A Smith"
            ],
            "title": "Probing across time: What does roberta know and when",
            "venue": "arXiv preprint arXiv:2104.07885,",
            "year": 2021
        },
        {
            "authors": [
                "Max M Louwerse",
                "Nick Benesh"
            ],
            "title": "Representing spatial structure through maps and language: Lord of the rings encodes the spatial structure of middle earth",
            "venue": "Cognitive science,",
            "year": 2012
        },
        {
            "authors": [
                "Max M Louwerse",
                "Rolf A Zwaan"
            ],
            "title": "Language encodes geographical information",
            "venue": "Cognitive Science,",
            "year": 2009
        },
        {
            "authors": [
                "Kevin Meng",
                "David Bau",
                "Alex Andonian",
                "Yonatan Belinkov"
            ],
            "title": "Locating and editing factual associations in gpt",
            "venue": "Advances in Neural Information Processing Systems,",
            "year": 2022
        },
        {
            "authors": [
                "Kevin Meng",
                "Arnab Sen Sharma",
                "Alex Andonian",
                "Yonatan Belinkov",
                "David Bau"
            ],
            "title": "Mass-editing memory in a transformer",
            "venue": "arXiv preprint arXiv:2210.07229,",
            "year": 2022
        },
        {
            "authors": [
                "Eric J Michaud",
                "Ziming Liu",
                "Uzay Girit",
                "Max Tegmark"
            ],
            "title": "The quantization model of neural scaling",
            "venue": "arXiv preprint arXiv:2303.13506,",
            "year": 2023
        },
        {
            "authors": [
                "Tomas Mikolov",
                "Ilya Sutskever",
                "Kai Chen",
                "Greg S Corrado",
                "Jeff Dean"
            ],
            "title": "Distributed representations of words and phrases and their compositionality",
            "venue": "Advances in neural information processing systems,",
            "year": 2013
        },
        {
            "authors": [
                "Tom\u00e1\u0161 Mikolov",
                "Wen-tau Yih",
                "Geoffrey Zweig"
            ],
            "title": "Linguistic regularities in continuous space word representations. In Proceedings of the 2013 conference of the north american chapter of the association for computational linguistics",
            "venue": "Human language technologies,",
            "year": 2013
        },
        {
            "authors": [
                "Neel Nanda",
                "Andrew Lee",
                "Martin Wattenberg"
            ],
            "title": "Emergent linear representations in world models of self-supervised sequence models",
            "venue": "arXiv preprint arXiv:2309.00941,",
            "year": 2023
        },
        {
            "authors": [
                "Richard Ngo",
                "Lawrence Chan",
                "S\u00f6ren"
            ],
            "title": "Mindermann. The alignment problem from a deep learning perspective, 2023",
            "year": 2023
        },
        {
            "authors": [
                "John O\u2019Keefe",
                "Jonathan Dostrovsky"
            ],
            "title": "The hippocampus as a spatial map: preliminary evidence from unit activity in the freely-moving rat",
            "venue": "Brain research,",
            "year": 1971
        },
        {
            "authors": [
                "Roma Patel",
                "Ellie Pavlick"
            ],
            "title": "Mapping language models to grounded conceptual spaces",
            "venue": "In International Conference on Learning Representations,",
            "year": 2021
        },
        {
            "authors": [
                "Tilman R\u00e4uker",
                "Anson Ho",
                "Stephen Casper",
                "Dylan Hadfield-Menell"
            ],
            "title": "Toward transparent ai: A survey on interpreting the inner structures of deep neural networks",
            "venue": "IEEE Conference on Secure and Trustworthy Machine Learning (SaTML),",
            "year": 2023
        },
        {
            "authors": [
                "Abhilasha Ravichander",
                "Yonatan Belinkov",
                "Eduard Hovy"
            ],
            "title": "Probing the probing paradigm: Does probing accuracy entail task relevance",
            "venue": "arXiv preprint arXiv:2005.00719,",
            "year": 2020
        },
        {
            "authors": [
                "Anna Rogers",
                "Olga Kovaleva",
                "Anna Rumshisky"
            ],
            "title": "A primer in bertology: What we know about how bert works",
            "venue": "Transactions of the Association for Computational Linguistics,",
            "year": 2021
        },
        {
            "authors": [
                "Daniel R Schonhaut",
                "Zahra M Aghajan",
                "Michael J Kahana",
                "Itzhak Fried"
            ],
            "title": "A neural code for time and space in the human brain",
            "venue": "Cell Reports,",
            "year": 2023
        },
        {
            "authors": [
                "Shubham Toshniwal",
                "Sam Wiseman",
                "Karen Livescu",
                "Kevin Gimpel"
            ],
            "title": "Chess as a testbed for language model state tracking",
            "venue": "In Proceedings of the AAAI Conference on Artificial Intelligence,",
            "year": 2022
        },
        {
            "authors": [
                "Hugo Touvron",
                "Louis Martin",
                "Kevin Stone",
                "Peter Albert",
                "Amjad Almahairi",
                "Yasmine Babaei",
                "Nikolay Bashlykov",
                "Soumya Batra",
                "Prajjwal Bhargava",
                "Shruti Bhosale"
            ],
            "title": "Llama 2: Open foundation and fine-tuned chat models",
            "venue": "arXiv preprint arXiv:2307.09288,",
            "year": 2023
        }
    ],
    "sections": [
        {
            "heading": "1 INTRODUCTION",
            "text": "Despite being trained to just predict the next token, modern large language models (LLMs) have demonstrated an impressive set of capabilities (Bubeck et al., 2023; Wei et al., 2022), raising questions and concerns about what such models have actually learned. One hypothesis is that LLMs learn a massive collection of correlations but lack any coherent model or \u201cunderstanding\u201d of the underlying data generating process given text-only training (Bender & Koller, 2020; Bisk et al., 2020). An alternative hypothesis is that LLMs, in the course of compressing the data, learn more compact, coherent, and interpretable models of the generative process underlying the training data, i.e., a world model. For instance, Li et al. (2022) have shown that transformers trained with next token prediction to play the board game Othello learn explicit representations of the game state, with Nanda et al. (2023) subsequently showing these representations are linear. Others have shown that LLMs track boolean states of subjects within the context (Li et al., 2021) and have representations that reflect perceptual and conceptual structure in spatial and color domains (Patel & Pavlick, 2021; Abdou et al., 2021). Better understanding of if and how LLMs model the world is critical for reasoning about the robustness, fairness, and safety of current and future AI systems (Bender et al., 2021; Weidinger et al., 2022; Bommasani et al., 2021; Hendrycks et al., 2023; Ngo et al., 2023).\nIn this work, we take the question of whether LLMs form world (and temporal) models as literally as possible\u2014we attempt to extract an actual map of the world! While such spatiotemporal representations do not constitute a dynamic causal world model in their own right, having coherent multi-scale representations of space and time are basic ingredients required in a more comprehensive model.\nSpecifically, we construct six datasets containing the names of places or events with corresponding space or time coordinates that span multiple spatiotemporal scales: locations within the whole world, the United States, and New York City in addition to the death year of historical figures from the past 3000 years, the release date of art and entertainment from 1950s onward, and the publication date of news headlines from 2010 to 2020. Using the Llama-2 (Touvron et al., 2023) and Pythia Biderman et al. (2023) family of models, we train linear regression probes (Alain & Bengio, 2016; Belinkov, 2022) on the internal activations of the names of these places and events at each layer to predict their real-world location (i.e., latitude/longitude) or time (numeric timestamp).\nThese probing experiments reveal evidence that models build spatial and temporal representations throughout the early layers before plateauing at around the model halfway point with larger models\nconsistently outperforming smaller ones (\u00a7 3.1). We then show these representations are (1) linear, given that nonlinear probes do not perform better (\u00a7 3.2), (2) fairly robust to changes in prompting (\u00a7 3.3), and (3) unified across different kinds of entities (e.g. cities and natural landmarks). We then conduct a series of robustness checks to understand how our probes generalize across different data distributions (\u00a7 4.1) and how probes trained on the PCA components perform (\u00a7 4.2). Finally, we use our probes to find individual neurons which activate as a function of space or time and use basic causal interventions to verify their importance in spatiotemporal modeling, providing strong evidence that the model is truly using these features (\u00a7 5)."
        },
        {
            "heading": "2 EMPIRICAL OVERVIEW",
            "text": ""
        },
        {
            "heading": "2.1 SPACE AND TIME RAW DATASETS",
            "text": "To enable our investigation, we construct six datasets of names of entities (people, places, events, etc.) with their respective location or occurrence in time, each at a different order of magnitude of scale. For each dataset, we included multiple types of entities, e.g., both populated places like cities and natural landmarks like lakes, to study how unified representations are across different object types. Furthermore, we maintain or enrich relevant metadata to enable analyzing the data with more detailed breakdowns, identify sources of train-test leakage, and support future work on factual recall within LLMs. We also attempt to deduplicate and filter out obscure or otherwise noisy data.\nSpace We constructed three datasets of place names within the world, the United States, and New York City. Our world dataset is built from raw data queried from DBpedia Lehmann et al. (2015). In particular, we query for populated places, natural places, and structures (e.g. buildings or infrastructure). We then match these against Wikipedia articles, and filter out entities which do not have at least 5,000 page views over a three year period. Our United States dataset is constructed from DBPedia and a census data aggregator, and includes the names of cities, counties, zipcodes, colleges, natural places, and structures where sparsely populated or viewed locations were similarly filtered out. Finally, our New York City dataset is adapted from the NYC OpenData points of interest dataset (NYC OpenData, 2023) containing locations such as schools, churches, transportation facilities, and public housing within the city.\nTime Our three temporal datasets consist of (1) the names and occupations of historical figures who died between 1000BC and 2000AD adapted from (Annamoradnejad & Annamoradnejad, 2022); (2) the titles and creators of songs, movies, and books from 1950 to 2020 constructed from DBpedia with the Wikipedia page views filtering technique; and (3) New York Times news headlines from 2010-2020 from news desks that write about current events, adapted from (Bandy, 2021).\nTable 1: Entity count and representative examples for each of our datasets.\nDataset Count Examples World 39585 \u201cLos Angeles\u201d, \u201cSt. Peter\u2019s Basilica\u201d, \u201cCaspian Sea\u201d, \u201cCanary Islands\u201d USA 29997 \u201cFenway Park\u201d, \u201cColumbia University\u201d, \u201cRiverside County\u201d NYC 19838 \u201cBorden Avenue Bridge\u201d, \u201cTrump International Hotel\u201d\nFigures 37539 \u201cCleopatra\u201d, \u201cDante Alighieri\u201d, \u201cCarl Sagan\u201d, \u201cBlanche of Castile\u201d Art 31321 \u201cStephen King\u2019s It\u201d, \u201cQueen\u2019s Bohemian Rhapsody\u201d Headlines 28389 \u201cPilgrims, Fewer and Socially Distanced, Arrive in Mecca for Annual Hajj\u201d"
        },
        {
            "heading": "2.2 MODELS AND METHODS",
            "text": "Data Preparation All of our experiments are run with the base Llama-2 (Touvron et al., 2023) series of auto-regressive transformer language models, spanning 7 billion to 70 billion parameters. For each dataset, we run every entity name through the model, potentially prepended with a short prompt, and save the activations of the hidden state (residual stream) on the last entity token for each layer. For a set of n entities, this yields an n\u00d7 dmodel activation dataset for each layer.\nProbing To find evidence of spatial and temporal representations in LLMs, we use the standard technique of probing Alain & Bengio (2016); Belinkov (2022), which fits a simple model on the network activations to predict some target label associated with labeled input data. In particular, given an activation dataset A \u2208 Rn\u00d7dmodel , and a target Y containing either the time or twodimensional latitude and longitude coordinates, we fit linear ridge regression probes\nW\u0302 = argmin W\n\u2225Y \u2212AW \u222522 + \u03bb\u2225W \u222522 = (ATA+ \u03bbI)\u22121ATY\nyielding a linear predictor Y\u0302 = AW\u0302 . High predictive performance on out-of-sample data indicates that the base model has temporal and spatial information linearly decodable in its representations, although this does not imply that the model actually uses these representations (Ravichander et al., 2020). In all experiments, we tune \u03bb using efficient leave-out-out cross validation (Hastie et al., 2009) on the probe training set."
        },
        {
            "heading": "2.3 EVALUATION",
            "text": "To evaluate the performance of our probes we report standard regression metrics such as R2 and Spearman rank correlation on our test data (correlations averaged over latitude and longitude for spatial features). An additional metric we compute is the proximity error for each prediction, defined as the fraction of entities predicted to be closer to the target point than the prediction of the target entity. The intuition is that for spatial data, absolute error metrics can be misleading (a 500km error for a city on the East Coast of the United States is far more significant than a 500km error in Siberia), so when analyzing errors per prediction, we often report this metric to account for the local differences in desired precision."
        },
        {
            "heading": "3 LINEAR MODELS OF SPACE AND TIME",
            "text": ""
        },
        {
            "heading": "3.1 EXISTENCE",
            "text": "We first investigate the following empirical questions: do models represent time and space at all? If so, where internally in the model? Does the representation quality change substantially with model scale? In our first experiment, we train probes for every layer of Llama-2-{7B, 13B, 70B} and\nPythia-{160M, 410M, 1B, 1.4B, 2.8B, 6.9B} for each of our space and time datasets. Our main results, depicted in Figure 2, show fairly consistent patterns across datasets. In particular, both spatial and temporal features can be recovered with a linear probe, these representations smoothly increase in quality throughout the first half of the layers of the model before reaching a plateau, and the representations are more accurate with increasing model scale. The gap between the Llama and Pythia models is especially striking, and we suspect is due to the large difference in pre-training corpus size (2T and 300B tokens respectively). For this reason, we report the rest of our results on just the Llama models.\nThe dataset with the worst performance is the New York City dataset. This was expected given the relative obscurity of most of the entities compared with other datasets. However, this is also the dataset where the largest model has the best relative performance, suggesting that sufficiently large LLMs could eventually form detailed spatial models of individual cities."
        },
        {
            "heading": "3.2 LINEAR REPRESENTATIONS",
            "text": "Within the interpretability literature, there is a growing body of evidence supporting the linear representation hypothesis that features within neural networks are represented linearly, that is, the presence or strength of a feature can be read out by projecting the relevant activation on to some feature vector (Mikolov et al., 2013b; Olah et al., 2020; Elhage et al., 2022b). However, these results are almost always for binary or categorical features, unlike the continuous features of space or time.\nTo test whether spatial and temporal features are represented linearly, we compare the performance of our linear ridge regression probes with that of substantially more expressive nonlinear MLP probes of the form W2ReLU(W1x + b1) + b2 with 256 neurons. Table 2 reports our results and shows that using nonlinear probes results in minimal improvement to R2 for any dataset or model. We take this as strong evidence that space and time are also represented linearly (or at the very least are linearly decodable), despite being continuous."
        },
        {
            "heading": "3.3 SENSITIVITY TO PROMPTING",
            "text": "Another natural question is if these spatial or temporal features are sensitive to prompting, that is, can the context induce or suppress the recall of these facts? Intuitively, for any entity token, an autoregressive model is incentivized to produce a representation suitable for addressing any future possible context or question.\nTo study this, we create new activation datasets where we prepend different prompts to each of the entity tokens, following a few basic themes. In all cases, we include an \u201cempty\u201d prompt containing nothing other than the entity tokens (and a beginning of sequence token). We then include a prompt which asks the model to recall the relevant fact, e.g., \u201cWhat is the latitude and longitude of <place>\u201d or \u201cWhat was the release date of <author>\u2019s <book>.\u201d For the United States and NYC datasets we also include versions of these prompts asking where in the US or NYC this location is, in an attempt to disambiguate common names of places (e.g. City Hall). As a baseline we include a prompt of 10 random tokens (sampled for each entity). To determine if we can obfuscate the subject, for some datasets we fully capitalize the names of all entities. Lastly, for the headlines dataset, we try probing on both the last token and on a period token appended to the headline.\nWe report results for the 70B model in Figure 3 and all models in Figure 8. We find that explicitly prompting the model for the information, or giving disambiguation hints like that a place is in the US or NYC, makes little to no difference in performance. However, we were surprised by the degree to which random distracting tokens degrades performance. Capitalizing the entities also degrades performance, though less severely and less surprisingly, as this likely interferes with \u201cdetokenizing\u201d the entity (Elhage et al., 2022a; Gurnee et al., 2023; Geva et al., 2023). The one modification that did notably improve performance is probing on the period token following a headline, suggesting that periods are used to contain some summary information of the sentences they end."
        },
        {
            "heading": "4 ROBUSTNESS CHECKS",
            "text": "The previous section has shown that the true point in time or space of diverse types of events or locations can be linearly recovered from the internal activations of the mid-to-late layers of LLMs. However, this does not imply if (or how) a model actually uses the feature direction learned by the probe, as the probe itself could be learning some linear combination of simpler features which are actually used by the model."
        },
        {
            "heading": "4.1 VERIFICATION VIA GENERALIZATION",
            "text": "Block holdout generalization To illustrate a potential issue with our results, consider the task of representing the full world map. If the model has, as we expect it does, an almost orthogonal binary feature for is in country X, then one could construct a high quality latitude (longitude) probe by summing these orthogonal feature vectors for each country with coefficient equal to the latitude (longitude) of that country. Assuming a place is in only one country, such a probe would place each entity at its country centroid. However, in this case, the model does not actually represent space, only country membership, and it is only the probe which learns the geometry of the different countries from the explicit supervision.\nTo better distinguish these cases, we analyze how the probes generalize when holding out specific blocks of data. In particular, we train a series of probes, where for each one, we hold out one country, state, borough, century, decade, or year for the world, USA, NYC, historical figure, entertainment, and headlines dataset respectively. We then evaluate the probes on the held out block of data. In Table 3, we report the average proximity error for the block of data when completely held out, compared to the error of the test points from that block in the default train-test split, averaged over all held out blocks.\nWe find that while generalization performance suffers, especially for the spatial datasets, it is clearly better than random. By plotting the predictions of the held out states or countries in Figures 11 and 12, a qualitatively clearer picture emerges. That is, the probe correctly generalizes by placing the points in the correct relative position (as measured by the angle between the true and predicted centroid) but not in their absolute position. We take this as weak evidence that the probes are extracting explicitly learned features by the model, but are memorizing the transformation from model coordinates to human coordinates. However, this does not fully rule out the underlying binary features hypothesis, as there could be a hierarchy of such features that do not follow country or decade boundaries.\nCross entity generalization Implicit in our discussion so far is the claim that the model represents the space or time coordinates of different types of entities (like cities or natural landmarks) in a unified manner. However, similar to the concern that a latitude probe could be a weighted sum of membership features, a latitude probe could also be the sum of different (orthogonal) directions for the latitudes of cities and for the latitudes of natural landmarks.\nSimilar to the above, we distinguish these hypotheses by training a series of probes where the traintest split is performed to hold out all points of a particular entity class.1 Table 4 reports the proximity error for the entities in the default test split compared to when heldout, averaged over all such splits as before. The results suggest that the probes largely generalize across entity types, with the main exception of the entertainment dataset.2"
        },
        {
            "heading": "4.2 DIMENSIONALITY REDUCTION",
            "text": "Despite being linear, our probes still have dmodel learnable parameters (ranging from 4096 to 8192 for the 7B to 70B models), enabling it to engage in substantial memorization. As a complementary form of evidence to the generalization experiments, we train probes with 2 to 3 orders of magnitude fewer parameters by projecting the activation datasets onto their k largest principal components.\nFigure 4 illustrates the test R2 for probes trained on each model and dataset over a range of k values, as compared to the performance of the full dmodel-dimensional probe. We also report the test Spearman correlation in Figure 13 which increases much more rapidly with increasing k than the R2. Notably, the Spearman correlation only depends on the rank order of the predictions while R2 also depends on their actual value. We view this gap as further evidence that the model explicitly represents space and time as these features must account for enough variance to be in the top dozen principal components, but that the probe requires more parameters to convert from the model\u2019s coordinate system to literal spatial coordinates or timestamps. We also observed that the first several principal components clustered the different entity types within the dataset, explaining why more than a few are needed.\nFigure 4: Test R2 for probes trained on activations projected onto k largest principal components for each dataset and model compared to training on the full activations.\n1We only do this entities which do not make up the majority of the training data (e.g., as is the case with populated places for the world dataset and songs for the entertainment dataset) which is partially responsible for the discrepancies in the nominal cases for Tables 3 and 4.\n2We note in this case the Spearman correlation is still high, suggesting this is an issue with bias generalization, as the different entity types are not uniformly distributed in time."
        },
        {
            "heading": "5 SPACE AND TIME NEURONS",
            "text": "While the previous results are suggestive, none of our evidence directly shows that the model uses the features learned by the probe. To address this, we search for individual neurons with input or output weights that have high cosine similarity with the learned probe direction. That is, we search for neurons which read from or write to a direction similar to the one learned by the probe.\nWe find that when we project the activation datasets on to the weights of the most similar neurons, these neurons are indeed highly sensitive to the true location of entities in space or time (see Figure 5). In other words, there exist individual neurons within the model that are themselves fairly predictive feature probes. Moreover, these neurons are sensitive to all of the entity types within our datasets, providing stronger evidence for the claim these representations are unified.\nIf probes trained with explicit supervision are an approximate upper bound on the extent to which a model represents these spatial and temporal features, then the performance of individual neurons is a lower bound. In particular, we generally expect features to be distributed in superposition (Elhage et al., 2022b), making individual neurons the wrong level of analysis. Nevertheless, the existence of these individual neurons, which received no supervision other than from next-token prediction, is very strong evidence that the model has learned and makes use of spatial and temporal features.\nWe also perform a series of neuron ablation and intervention experiments in Appendix B to verify the importance of these neurons in spatial and temporal modeling."
        },
        {
            "heading": "6 RELATED WORK",
            "text": "Linguistic Spatial Models Prior work has shown that natural language encodes geographic information (Louwerse & Zwaan, 2009; Louwerse & Benesh, 2012) and that relative coordinates can be approximately recovered with simple techniques like multidimensional scaling, co-occurrence statistics, or probing word embeddings (Louwerse & Zwaan, 2009; Mikolov et al., 2013a; Gupta et al., 2015; Konkol et al., 2017). However, these studies only consider a few hundred well known cities and obtain fairly weak correlations. Most similar to our work is (Lie\u0301tard et al., 2021) who probe word embeddings and small language models for the coordinates of global cities and whether\ncountries share a border, but conclude the amount of geographic information learned is \u201climited,\u201d likely because the largest model they study was 345M parameters (500x smaller than Llama 70B).\nNeural World Models We consider a spatiotemporal model to be a necessary ingredient within a larger world model. The clearest evidence that such models are learnable from next-token prediction comes from GPT-style models trained on chess (Toshniwal et al., 2022) and Othello games (Li et al., 2022) which were shown to have explicit representations of the board and game state, with further work showing these representations are linear (Nanda et al., 2023). In true LLMs, Li et al. (2021) show that an entity\u2019s dynamic properties or relations can be linearly read out from representations at different points in the context. Abdou et al. (2021) and Patel & Pavlick (2021) show LLMs have representations that reflect perceptual and conceptual structure in color and spatial domains.\nFactual Recall The point in time or space of an event or place is a particular kind of fact. Our investigation is informed by prior work on the mechanisms of factual recall in LLMs (Meng et al., 2022a;b; Geva et al., 2023) indicating that early-to-mid MLP layers are responsible for outputting information about factual subjects, typically on the last token of the subject. Many of these works also show linear structure, for example in the factuality of a statement (Burns et al., 2022) or in the structure of subject-object relations (Hernandez et al., 2023). To our knowledge, our work is unique in considering continuous facts.\nInterpretability More broadly, our work draws upon many results and ideas from the interpretability literature (Ra\u0308uker et al., 2023), especially in topics related to probing (Belinkov, 2022), BERTology (Rogers et al., 2021), the linearity hypothesis and superposition (Elhage et al., 2022b), and mechanistic interpretability (Olah et al., 2020). More specific results related to our work include Hanna et al. (2023) who find a circuit implementing greater-than in the context of years, and Goh et al. (2021) who find \u201cregion\u201d neurons in multimodal models that resemble our space neurons."
        },
        {
            "heading": "7 DISCUSSION",
            "text": "We have demonstrated that LLMs learn linear representations of space and time that are unified across entity types and fairly robust to prompting, and that there exists individual neurons that are highly sensitive to these features. We conjecture, but do not show, these basic primitives underlie a more comprehensive causal world model used for inference and prediction.\nOur analysis raises many interesting questions for future work. While we showed that it is possible to linearly reconstruct a sample\u2019s absolute position in space or time, and that some neurons use these probe directions, the true extent and structure of spatial and temporal representations remain unclear. We conjecture that the most canonical form of this structure is a discretized hierarchical mesh, where any sample is represented as a linear combination of its nearest basis points at each level of granularity. Moreover, the model can and does use this coordinate system to represent absolute position using the correct linear combination of basis directions in the same way a linear probe would. We expect that as models scale, this mesh is enhanced with more basis points, more scales of granularity (e.g. neighborhoods in cities), and more accurate mapping of entities to model coordinates (Michaud et al., 2023). This suggests future work on extracting representations in the model\u2019s coordinate system rather than trying to reconstruct human interpretable coordinates, perhaps with sparse autoencoders (Cunningham et al., 2023).\nWe also barely scratched the surface of understanding how these spatial and temporal models are learned, recalled, and used internally, or to what extent these representations exist within a more comprehensive world model. By looking across training checkpoints, it may be possible to localize a point in training when a model organizes constituent is in place X features into a coherent geometry or else conclude this process is gradual (Liu et al., 2021). We expect that the model components which construct these representations are similar or identical to those for factual recall (Meng et al., 2022a; Geva et al., 2023).\nFinally, we note that the representation of space and time has received much more attention in biological neural networks than artificial ones (Buzsa\u0301ki & Llina\u0301s, 2017; Schonhaut et al., 2023). Place and grid cells (O\u2019Keefe & Dostrovsky, 1971; Hafting et al., 2005) in particular are among the most well-studied in the brain and may be a fruitful source of inspiration for future work on LLMs."
        },
        {
            "heading": "ACKNOWLEDGEMENTS",
            "text": "The authors would like to thank Sam Marks, Eric Michaud, Ziming Liu, Janice Yang, and especially Neel Nanda for their helpful discussions and feedback. W.G. was supported by Dimitris Bertsimas and an Open Philanthropy early career grant through the course of this work."
        },
        {
            "heading": "A DATASETS",
            "text": "We describe the construction and post-processing of our data in more detail in addition to known limitations. All datasets and code are available at https://github.com/wesg52/ world-models.\nWorld Places We ran three separate queries to obtain the names, location, country, and associated Wikipedia article of all physical places, natural places, and structures within the DBPedia database Lehmann et al. (2015). Using the Wikipedia article link, we joined this information with data from the Wikipedia pageview statistics database 3 to query how many times this page was accessed over 2018-2020. We use this as a proxy for whether we should expect an LLM to know of this place or not, and filter those with less than 5000 views over this time period.\nSeveral limitation are worth highlighting. First, our data only comes from English Wikipedia, and hence is skewed towards the Anglosphere. Additionally, the distribution of entity types is not uniform, e.g. we noticed the United Kingdom has many more railway stations than any other country, which could introduce unwanted correlations in the data that may affect the probes. Finally, about 25% of the samples had some sort of state or province modifier at the end like\u201cDallas County, Iowa\u201d. Because many of these locations were more obscure or would be ambiguous without the modifier, so we chose to rearrange the string to be of the from \u201cIowa\u2019s Dallas County\u201d such the entity is disambiguated but that we are not probing on a token that is a common country or state name.\nUSA Places The United States places dataset uses structures and natural places within the US from the world places dataset as a starting point, in addition to another DBPedia for US colleges. We then collect the name, population total, and state for every county4, zipcode 5, and city 6 from a census data aggregator. We then remove all duplicate county or city names (there are 31 Washington counties in the US!), though we keep any duplicates that have 2x the population has the next largest place of the same name. We also filter out cities with fewer than 500 people, zipcodes with fewer than 10000 (or with population density greater than 50 and population greater than 2000), and any place not in the lower 48 contiguous states (or Washington D.C.).\nNYC Places Our New York City dataset is adapted from the NYC Open Date points of interest dataset (NYC OpenData, 2023) containing the names of locations tracked by the city government. This includes the names of schools, places of worship, transit locations, important roads or bridges, government buildings, public housing, and more. Each of these places comes with a complex ID for locations comprised of multiple such buildings (e.g. New York University or LaGuardia airport). We construct our test train splits to make sure that all locations within the same complex are put in the same split to avoid test-train leakage. We filtered out a large number of locations describing the position of bouys in the multiple waterways surrounding NYC.\nHistorical Figures Our historical figures dataset contains the names and occupation of historical figures who died between 1000BC-2000AD adapted from (Annamoradnejad & Annamoradnejad, 2022). We filtered the dataset to only contain the 350 most famous people who died from each decade, imperfectly measured by the index of their Wikidata entity identifier.\n3https://en.wikipedia.org/wiki/Wikipedia:Pageview_statistics 4https://simplemaps.com/data/us-counties 5https://simplemaps.com/data/us-zips 6https://simplemaps.com/data/us-cities\nArt and Entertainment Our art and entertainment dataset consists of the names of songs, movies, and books with their corresponding artist, director, and author release date. We constructed this dataset from DBpedia and similarly filtered out entities which had received less than 5000 page views over 2018-2020. Because many songs or books have fairly generic titles, we include the creator\u2019s name in the prompt to disambiguate (e.g. \u201cStephen Kings\u2019 It\u201d for the empty prompt). However, because some artists or authors release many songs or books, we sample our test-train split by creator to avoid leakage.\nHeadlines Our headlines dataset is adapted from a scrape of all New York Times headlines of the past 30 years (Bandy, 2021). In an attempt to filter out headlines which do not describe an event that could be localized in time, we employ a number of strategies. First we filter anything which is not within the first 10 pages of the print edition. Second we filter out articles that don\u2019t come from the Foreign, National, Politics, Washington, or Obits news desks. Third we removed any titles that contained a question mark."
        },
        {
            "heading": "B NEURON ABLATIONS AND INTERVENTIONS",
            "text": "To better understand the role of space and time neurons in LLMs, we conduct several neuron ablation and intervention experiments.\nTime Intervention We study the effect of intervening on a single time neuron (L19.3610; correlation with art and entertainment release date of 0.77) within Llama-2-7b. Given a prompt of the form <media> by <creator> was written in 19, we pin the activation of the time neuron on all tokens and sweep over a range of pinned values, and track the predicted probability of the top five tokens. Results are depicted in Figure 7 and show that just adjusting the time neuron activation can change the next token prediction in all cases.\nNeuron Ablations We also study the effect of zero ablating neurons, and the contexts for which the loss increases the most. For a subset of Wikipedia which includes articles corresponding to world places and contemporary art and entertainment, we first run Llama-2-7b as normal and record the loss. Then, for two space neurons and two time neurons, we run the model with the neuron activation pinned to 0 (we always pin exactly one neuron to 0). For each neuron, we report the top 10 contexts in which the loss most increased for the next token prediction in Tables 5-8."
        },
        {
            "heading": "C ADDITIONAL RESULTS",
            "text": ""
        }
    ],
    "year": 2024
}