{
    "abstractText": "With the arrival of the Noisy Intermediate-Scale Quantum (NISQ) era, Variational Quantum Algorithms (VQAs) have emerged as popular approaches to obtain possible quantum advantage in the relatively near future. In particular, how to effectively incorporate the common symmetries in physical systems as hard constraints in VQAs remains a critical and open question. In this paper, we revisit the Hamming Weight (HW) preserving ansatz and establish the links from ansatz to various symmetries and constraints, which both enlarges the usage of HW preserving ansatz and provides a coherent solution for constrained VQAs. Meanwhile, we utilize the quantum optimal control theory and quantum overparameterization theory to analyze the capability, expressivity, and trainability of HW preserving ansatz and verify these theoretical results on unitary approximation problem. We further conduct detailed numerical experiments on two well-studied symmetrypreserving problems, namely ground state energy estimation and feature selection in machine learning. The superior performance demonstrates the efficiency and supremacy of the proposed HW preserving ansatz on constrained VQAs.",
    "authors": [],
    "id": "SP:94bbc2c44a0439e91a08637d05e8807302a366fa",
    "references": [
        {
            "authors": [
                "Rodney J Bartlett",
                "Stanislaw A Kucharski",
                "Jozef Noga"
            ],
            "title": "Alternative coupled-cluster ans\u00e4tze ii. the unitary coupled-cluster method",
            "venue": "Chemical physics letters,",
            "year": 1989
        },
        {
            "authors": [
                "Kishor Bharti",
                "Alba Cervera-Lierta",
                "Thi Ha Kyaw",
                "Tobias Haug",
                "Sumner Alperin-Lea",
                "Abhinav Anand",
                "Matthias Degroote",
                "Hermanni Heimonen",
                "Jakob S Kottmann",
                "Tim Menke"
            ],
            "title": "Noisy intermediate-scale quantum algorithms",
            "venue": "Reviews of Modern Physics,",
            "year": 2022
        },
        {
            "authors": [
                "Teng Bian",
                "Daniel Murphy",
                "Rongxin Xia",
                "Ammar Daskin",
                "Sabre Kais"
            ],
            "title": "Quantum computing methods for electronic states of the water molecule",
            "venue": "Molecular Physics,",
            "year": 2019
        },
        {
            "authors": [
                "Marco Cerezo",
                "Andrew Arrasmith",
                "Ryan Babbush",
                "Simon C Benjamin",
                "Suguru Endo",
                "Keisuke Fujii",
                "Jarrod R McClean",
                "Kosuke Mitarai",
                "Xiao Yuan",
                "Lukasz Cincio"
            ],
            "title": "Variational quantum algorithms",
            "venue": "Nature Reviews Physics,",
            "year": 2021
        },
        {
            "authors": [
                "Girish Chandrashekar",
                "Ferat Sahin"
            ],
            "title": "A survey on feature selection methods",
            "venue": "Computers & Electrical Engineering,",
            "year": 2014
        },
        {
            "authors": [
                "El Amine Cherrat",
                "Snehal Raj",
                "Iordanis Kerenidis",
                "Abhishek Shekhar",
                "Ben Wood",
                "Jon Dee",
                "Shouvanik Chakrabarti",
                "Richard Chen",
                "Dylan Herman",
                "Shaohan Hu"
            ],
            "title": "Quantum deep hedging",
            "venue": "arXiv preprint arXiv:2303.16585,",
            "year": 2023
        },
        {
            "authors": [
                "HA Chieza",
                "MT Khumalo",
                "K Prag",
                "M Woolway"
            ],
            "title": "On the computational performance of ibm quantum devices applied to combinatorial optimisation problems",
            "venue": "In International Conference on Soft Computing & Machine Intelligence (ISCMI),",
            "year": 2020
        },
        {
            "authors": [
                "Paulo Cortez",
                "Juliana Teixeira",
                "Ant\u00f3nio Cerdeira",
                "Fernando Almeida",
                "Telmo Matos",
                "Jos\u00e9 Reis"
            ],
            "title": "Using data mining for wine quality assessment",
            "venue": "In Discovery Science,",
            "year": 2009
        },
        {
            "authors": [
                "Domenico d\u2019Alessandro"
            ],
            "title": "Introduction to quantum control and dynamics",
            "venue": "CRC press,",
            "year": 2021
        },
        {
            "authors": [
                "Edward Farhi",
                "Jeffrey Goldstone",
                "Sam Gutmann"
            ],
            "title": "A quantum approximate optimization algorithm",
            "venue": "arXiv preprint arXiv:1411.4028,",
            "year": 2014
        },
        {
            "authors": [
                "Maurizio Ferrari Dacrema",
                "Fabio Moroni",
                "Riccardo Nembrini",
                "Nicola Ferro",
                "Guglielmo Faggioli",
                "Paolo Cremonesi"
            ],
            "title": "Towards feature selection for ranking and classification exploiting quantum annealers",
            "venue": "In ACM SIGIR Conference on Research and Development in Information Retrieval,",
            "year": 2022
        },
        {
            "authors": [
                "Bryan T Gard",
                "Linghua Zhu",
                "George S Barron",
                "Nicholas J Mayhall",
                "Sophia E Economou",
                "Edwin Barnes"
            ],
            "title": "Efficient symmetry-preserving state preparation circuits for the variational quantum eigensolver algorithm",
            "venue": "npj Quantum Information,",
            "year": 2020
        },
        {
            "authors": [
                "Isabelle Guyon",
                "Andr\u00e9 Elisseeff"
            ],
            "title": "An introduction to variable and feature selection",
            "venue": "Journal of machine learning research,",
            "year": 2003
        },
        {
            "authors": [
                "Stuart Hadfield",
                "Zhihui Wang",
                "Bryan O\u2019gorman",
                "Eleanor G Rieffel",
                "Davide Venturelli",
                "Rupak Biswas"
            ],
            "title": "From the quantum approximate optimization algorithm to a quantum alternating operator ansatz",
            "year": 2019
        },
        {
            "authors": [
                "Abhinav Kandala",
                "Antonio Mezzacapo",
                "Kristan Temme",
                "Maika Takita",
                "Markus Brink",
                "Jerry M Chow",
                "Jay M Gambetta"
            ],
            "title": "Hardware-efficient variational quantum eigensolver for small molecules and quantum magnets",
            "year": 2017
        },
        {
            "authors": [
                "Iordanis Kerenidis",
                "Jonas Landman",
                "Natansh Mathur"
            ],
            "title": "Classical and quantum algorithms for orthogonal neural networks",
            "venue": "arXiv preprint arXiv:2106.07198,",
            "year": 2021
        },
        {
            "authors": [
                "Maxine T Khumalo",
                "Hazel A Chieza",
                "Krupa Prag",
                "Matthew Woolway"
            ],
            "title": "An investigation of ibm quantum computing deviceperformance on combinatorial optimisation problems",
            "venue": "arXiv preprint arXiv:2107.03638,",
            "year": 2021
        },
        {
            "authors": [
                "Kenji Kira",
                "Larry A Rendell"
            ],
            "title": "A practical approach to feature selection",
            "venue": "In Machine learning proceedings",
            "year": 1992
        },
        {
            "authors": [
                "Murat Koklu",
                "Ilker Ali Ozkan"
            ],
            "title": "Multiclass classification of dry beans using computer vision and machine learning techniques",
            "venue": "Computers and Electronics in Agriculture,",
            "year": 2020
        },
        {
            "authors": [
                "Vipin Kumar",
                "Sonajharia Minz"
            ],
            "title": "Feature selection: a literature review",
            "venue": "SmartCR,",
            "year": 2014
        },
        {
            "authors": [
                "Jonas Landman",
                "Natansh Mathur",
                "Yun Yvonna Li",
                "Martin Strahm",
                "Skander Kazdaghli",
                "Anupam Prakash",
                "Iordanis Kerenidis"
            ],
            "title": "Quantum methods for neural networks and application to medical image classification",
            "year": 2022
        },
        {
            "authors": [
                "Martin Larocca",
                "Nathan Ju",
                "Diego Garc\u0131\u0301a-Mart\u0131\u0301n",
                "Patrick J Coles",
                "Marco Cerezo"
            ],
            "title": "Theory of overparametrization in quantum neural networks",
            "venue": "Nature Computational Science,",
            "year": 2023
        },
        {
            "authors": [
                "Jundong Li",
                "Kewei Cheng",
                "Suhang Wang",
                "Fred Morstatter",
                "Robert P Trevino",
                "Jiliang Tang",
                "Huan Liu"
            ],
            "title": "Feature selection: A data perspective",
            "venue": "ACM computing surveys (CSUR),",
            "year": 2017
        },
        {
            "authors": [
                "Jarrod R McClean",
                "Sergio Boixo",
                "Vadim N Smelyanskiy",
                "Ryan Babbush",
                "Hartmut Neven"
            ],
            "title": "Barren plateaus in quantum neural network training landscapes",
            "venue": "Nature communications,",
            "year": 2018
        },
        {
            "authors": [
                "Jarrod R McClean",
                "Nicholas C Rubin",
                "Kevin J Sung",
                "Ian D Kivlichan",
                "Xavier Bonet-Monroig",
                "Yudong Cao",
                "Chengyu Dai",
                "E Schuyler Fried",
                "Craig Gidney",
                "Brendan Gimby"
            ],
            "title": "Openfermion: the electronic structure package for quantum computers",
            "venue": "Quantum Science and Technology,",
            "year": 2020
        },
        {
            "authors": [
                "Andrew Milne",
                "Maxwell Rounds",
                "Phil Goddard"
            ],
            "title": "Optimal feature selection in credit scoring and classification using a quantum annealer",
            "venue": "White Paper",
            "year": 2017
        },
        {
            "authors": [
                "Sascha M\u00fccke",
                "Raoul Heese",
                "Sabine M\u00fcller",
                "Moritz Wolter",
                "Nico Piatkowski"
            ],
            "title": "Feature selection on quantum computers",
            "venue": "Quantum Machine Intelligence,",
            "year": 2023
        },
        {
            "authors": [
                "Riccardo Nembrini",
                "Maurizio Ferrari Dacrema",
                "Paolo Cremonesi"
            ],
            "title": "Feature selection for recommender systems with quantum computing",
            "year": 2021
        },
        {
            "authors": [
                "Xuan Vinh Nguyen",
                "Jeffrey Chan",
                "Simone Romano",
                "James Bailey"
            ],
            "title": "Effective global approaches for mutual information based feature selection",
            "venue": "In ACM SIGKDD international conference on Knowledge discovery and data mining,",
            "year": 2014
        },
        {
            "authors": [
                "Michael A Nielsen",
                "Isaac Chuang"
            ],
            "title": "Quantum computation and quantum information",
            "year": 2002
        },
        {
            "authors": [
                "John Preskill"
            ],
            "title": "Quantum computing in the nisq era",
            "venue": "and beyond. Quantum,",
            "year": 2018
        },
        {
            "authors": [
                "Viswanath Ramakrishna",
                "Murti V Salapaka",
                "Mohammed Dahleh",
                "Herschel Rabitz",
                "Anthony Peirce"
            ],
            "title": "Controllability of molecular systems",
            "venue": "Physical Review A,",
            "year": 1995
        },
        {
            "authors": [
                "Jonathan Romero",
                "Ryan Babbush",
                "Jarrod R McClean",
                "Cornelius Hempel",
                "Peter J Love",
                "Al\u00e1n Aspuru-Guzik"
            ],
            "title": "Strategies for quantum computing molecular energies using the unitary coupled cluster ansatz",
            "venue": "Quantum Science and Technology,",
            "year": 2018
        },
        {
            "authors": [
                "Ilya G Ryabinkin",
                "Tzu-Ching Yen",
                "Scott N Genin",
                "Artur F Izmaylov"
            ],
            "title": "Qubit coupled cluster method: a systematic approach to quantum chemistry on a quantum computer",
            "venue": "Journal of chemical theory and computation,",
            "year": 2018
        },
        {
            "authors": [
                "Sonia G Schirmer",
                "H Fu",
                "Allan I Solomon"
            ],
            "title": "Complete controllability of quantum systems",
            "venue": "Physical Review A,",
            "year": 2001
        },
        {
            "authors": [
                "Vlad O Shkolnikov",
                "Nicholas J Mayhall",
                "Sophia E Economou",
                "Edwin Barnes"
            ],
            "title": "Avoiding symmetry roadblocks and minimizing the measurement overhead of adaptive variational quantum eigensolvers",
            "year": 2023
        },
        {
            "authors": [
                "Kotaro Tanahashi",
                "Shinichi Takayanagi",
                "Tomomitsu Motohashi",
                "Shu Tanaka"
            ],
            "title": "Application of ising machines and a software development for ising machines",
            "venue": "Journal of the Physical Society of Japan,",
            "year": 2019
        },
        {
            "authors": [
                "Jules Tilly",
                "Hongxiang Chen",
                "Shuxiang Cao",
                "Dario Picozzi",
                "Kanav Setia",
                "Ying Li",
                "Edward Grant",
                "Leonard Wossnig",
                "Ivan Rungger",
                "George H Booth"
            ],
            "title": "The variational quantum eigensolver: a review of methods and best practices",
            "venue": "Physics Reports,",
            "year": 2022
        },
        {
            "authors": [
                "Joaquin Vanschoren",
                "Jan N. van Rijn",
                "Bernd Bischl",
                "Luis Torgo"
            ],
            "title": "Openml: Networked science in machine learning",
            "venue": "SIGKDD Explorations,",
            "year": 2013
        },
        {
            "authors": [
                "Wenjie Wu",
                "Ge Yan",
                "Xudong Lu",
                "Kaisen Pan",
                "Junchi Yan"
            ],
            "title": "Quantumdarts: Differentiable quantum architecture search for variational quantum algorithms",
            "venue": "International Conference on Machine Learning,",
            "year": 2023
        },
        {
            "authors": [
                "Mashiyat Zaman",
                "Kotaro Tanahashi",
                "Shu Tanaka"
            ],
            "title": "Pyqubo: Python library for mapping combinatorial optimization problems to qubo form",
            "venue": "IEEE Transactions on Computers,",
            "year": 2021
        },
        {
            "authors": [
                "Robert Zeier",
                "Thomas Schulte-Herbr\u00fcggen"
            ],
            "title": "Symmetry principles in quantum systems theory",
            "venue": "Journal of mathematical physics,",
            "year": 2011
        },
        {
            "authors": [
                "Bian"
            ],
            "title": "2019) and the Quantum Architecture Search (QAS) (Wu et al., 2023) methods. These methods can produce relatively shallow and feasible ansatz, but they can also generate unphysical states. The most important symmetries (or invariants) in the quantum chemistry problem are the particle number and total spin (Gard et al., 2020)",
            "venue": "(HEA) (Kandala et al.,",
            "year": 2020
        },
        {
            "authors": [
                "M\u00fccke"
            ],
            "title": "2023), constrained QUBO (Hadfield et al., 2019), etc. Previous HW preserving related works. For the above-mentioned constraints, we can easily address them by adding terms in the Hamiltonian to give a penalty if we break the constraints. However, this method can only provide soft constraints and we can still have illegal results in the final states",
            "year": 2019
        },
        {
            "authors": [
                "Hadfield"
            ],
            "title": "2019) proposed a quantum alternating operator ansatz which utilize the XY-mixer and RZZ gate to form a constrained quantum ansatz. The XY-mixer is a HW preserving gate with its Hamiltonian constructed by XX and YY rotation HXY = X \u2297X + Y",
            "year": 2019
        }
    ],
    "sections": [
        {
            "heading": "1 INTRODUCTION",
            "text": "Over the decade, Variational Quantum Algorithms (VQAs) (Cerezo et al., 2021; Tilly et al., 2022) have received increasing attention and numerous studies have been conducted to seek potential quantum supremacy. With the arrival of the Noisy Intermediate-Scale Quantum (NISQ) era (Preskill, 2018; Bharti et al., 2022), the pace of exploring new VQAs has been further accelerated, as VQAs have shown the potential to obtain quantum advantage in the foreseeable future on NISQ devices (Cerezo et al., 2021). However, typical VQAs such as QAOA (Farhi et al., 2014) for Quadratic Unconstrained Binary Optimization (QUBO), and UCCSD (Romero et al., 2018) for ground state energy estimation are not natively designed to deal with constraints. It remains an open problem for addressing and incorporating the symmetries and constraints in the VQAs.\nIn this paper, we propose to resort to Hamming Weight (HW) preserving ansatz to introduce hard constraints to the VQAs instead of modeling the constraints as a regularizer in the Hamiltonian as done in literature (Chieza et al., 2020; Khumalo et al., 2021). The HW preserving ansatz operate in a restricted ( n k ) -dimensional subspace with parameterized HW preserving gates. We argue and show that HW preserving ansatz is able to deal with various symmetries in the physical systems and it could be used as a sound alternative for the Hardware Efficient Ansatz (HEA) for constrained VQAs. We further utilize the quantum optimal control (Schirmer et al., 2001) and quantum overparameterization (Larocca et al., 2023) theories to lay a rigorous theoretical foundation for the HW preserving ansatz. Specifically, quantum optimal control theory can help us decide whether a HW preserving gate with certain connectivity is universal. Analysis of the trainability ensures that we can evolve the quantum state without the presence of barren plateaus. While the overparameterization theory provides us with the guide that how many parameters (layers) one needs to obtain feasible results.\nWe provide experimental results on two representative constrained VQA problems, namely ground state energy estimation (Kandala et al., 2017) and feature selection (Chandrashekar & Sahin, 2014) for machine learning. We use two different HW preserving gates with two different connectivity to illustrate the capability and expressivity of different HW preserving ansatz. Specifically, one of the\ngates is Reconfigurable Beam Splitter (RBS) gate which is proposed in previous literature (Cherrat et al., 2023), and the other BS gate is generated through theoretical analysis and then is verified by empirical results. Both HW preserving gates demonstrate great efficiency on constrained VQA problems. BS gate is universal on the ( n k ) -dimensional subspace and is able to solve the unitary approximation problem on the subspace. However, RBS gate shows a better convergence rate on easier problem such as the ground state energy estimation but only with full connectivity. We summarize our contributions as follows:\n1) We revisit the Hamming weight (HW) preserving ansatz and link the ansatz to popular symmetries and constraints in physical systems, thereby expanding the utility of the HW preserving ansatz beyond their currently limited applications (Landman et al., 2022; Cherrat et al., 2023).\n2) To our best knowledge, we are the few (even the first) to provide a theory for the capability, expressivity, and trainability of HW preserving ansatz. We are able to generate a new gate based on our theories and numerical results on the task of unitary approximation verify our hypotheses.\n3) We conduct detailed numerical experiments on symmetry-preserving ground state energy estimation and feature selection in machine learning, which are two popular tasks. The superior performance demonstrates the efficiency of the HW preserving ansatz on constrained VQAs."
        },
        {
            "heading": "2 PRELIMINARIES",
            "text": "In this section, we will introduce the definition of the HW preserving quantum circuit and why it is useful in customizing the symmetries and other constraints in the VQE problems. We will further introduce several gates that satisfy the constraints of HW preserving."
        },
        {
            "heading": "2.1 HAMMING WEIGHT PRESERVING QUANTUM CIRCUIT",
            "text": "We have discussed several types of symmetries at the physics level and we now consider these symmetries and constraints on the quantum circuits. These symmetries and constraints as discussed in the related work all ensure that the number of 1s in the quantum state does not change. Recall the definition of Hamming distance and Hamming weight (Def. B.1 and Def. B.2), we find that these states in the constrained subspace all have the same Hamming weight. Thus we can employ a Hamming weight preserving circuit to solve the aforementioned problems in a limited subspace.\nTo make sure the quantum circuit will not generate any quantum state that have different Hamming weight, we need to find proper gates that can preserve the Hamming weight of the initial states. The most common gate we can find is the SWAP gate and the RZZ gate with the unitary matrices\nUSWAP =  1 0 0 00 0 1 00 1 0 0 0 0 0 1  , URZZ = e\u2212i \u03b82  1 0 0 00 ei\u03b8 0 0 0 0 ei\u03b8 0 0 0 0 1  . (1) These two gates ensure that they do not change the amplitudes of state |00\u27e9 and |11\u27e9. However, it is still not enough to build a trainable circuit for HW preserving problems. Cherrat et al. (2023) has used another gate called the Reconfigurable Beam Splitter (RBS) gate as the basic element. RBS gate is more trainable compared to RZZ and SWAP gate with a possible decomposition in Fig. 5.\nHRBS =  0 0 0 00 0 \u2212i 00 i 0 0 0 0 0 0  , URBS(\u03b8) = ei\u03b8HRBS =  1 0 0 00 cos(\u03b8) sin(\u03b8) 00 \u2212 sin(\u03b8) cos(\u03b8) 0 0 0 0 1  , (2) Consider a n-qubit quantum circuit with HW k, we have dk = ( n k ) basis states in the HW subspace. The SWAP, RZZ and RBS gates all preserve the subspace with HW as k. The main character of these 2-qubit gates is that they only act on two basis states |01\u27e9 and |10\u27e9. Following this condition, we can theoretically construct our own gate that is HW preserving. Note that the dimension of the HW preserving circuit is ( n k ) , which is smaller than the dimension of the whole Hilbert space as 2n (especially when k is relatively small compared to n). This suggests some interesting properties."
        },
        {
            "heading": "2.2 DYNAMICAL LIE ALGEBRA",
            "text": "To understand the expressivity and capability of the HW preserving ansatz, we need to utilize a mathematics tool, which is Dynamical Lie Algebra (DLA) (Zeier & Schulte-Herbru\u0308ggen, 2011;\nd\u2019Alessandro, 2021). Since quantum circuits are unitary transformations, we can use Lie algebra and Lie group to analyze the properties of them. However, quantum machine learning introduces parameters into the unitary transformations, so we need to further extend the Lie algebra to dynamical Lie algebra. The unitary matrix U(\u03b8) of a QML circuit with L layers is of the form:\nU(\u03b8) = L\u220f l=1 Ul(\u03b8l) = L\u220f l=1 P\u220f p=1 ei\u03b8lpHp (3)\nwhere l indicates the layer, Hp are the Hermitian matrices that generate the unitary matrix Ul(\u03b8l). \u03b8l = {\u03b8l1, \u03b8l2, \u00b7 \u00b7 \u00b7 , \u03b8lp} is the parameters in the l-th layer and \u03b8 = {\u03b81,\u03b82, \u00b7 \u00b7 \u00b7 ,\u03b8L} is the parameters in the whole circuit. The generator of each layer in the ansatz can be defined as follows:\nDefinition 2.1 The set of generators: Consider a single layer of parameterized quantum circuit Ul(\u03b8) in Eq. 3. We define a group of Hermitian matrices that generate the unitary matrices U(\u03b8) as a set of generators G = {Hp}Pp=1, where |G| = P .\nWith the set of generators by Definition 2.1, we introduce a well-established concept:\nDefinition 2.2 Dynamical Lie Algebra (DLA): Consider the set of generators defined in Definition 2.1, the DLA g is defined as:\ng = span\u27e8iH1, iH2, \u00b7 \u00b7 \u00b7 , iHP \u27e9Lie, (4) where \u27e8\u00b7\u27e9Lie denotes the Lie closure. The set of generators is obtained by repeated take the commutators of the elements in the set.\nWe denote the corresponding Dynamical Lie group of DLA g as G. The reachable unitary matrices from arbitrary parameters \u03b8 have the following properties (Larocca et al., 2023):\n{U(\u03b8)}\u03b8 \u2286 G \u2286 SU(N), (5) where SU(N) denotes the special unitary group and d denotes the dimension."
        },
        {
            "heading": "3 INTERPRETABILITY OF THE HW PRESERVING ANSATZ",
            "text": "In this section, we will discuss the capability and expressivity of the proposed HW preserving ansatz. We also introduce definitions and theories for dynamical lie algebra, quantum control system and quantum overparameterization. With these knowledge, we are able to determine if a gate is universal in the dk-dimensional subspace, and estimate the number of parameters (circuit depth) needed in the circuits. We conduct experiments on the unitary approximation problem to verify these theories."
        },
        {
            "heading": "3.1 QUANTUM OPTIMAL CONTROL ON HW PRESERVING SPACE",
            "text": "Now we introduce the quantum control system and how to get complete controllability over a given quantum system. Consider a N -dimensional quantum system, the Hamiltonian of which can be denoted as H\u0302. If we denote the initial state as |\u03c80\u27e9, the time-independent Schro\u0308dinger equation is\nH\u0302U(\u03b8) |\u03c80\u27e9 = EU(\u03b8) |\u03c80\u27e9 , (6) where E is a scalar and stands for the energy. Notice that not all the states in the space can be reached by the dynamical unitary matrix, unless the dynamical Lie group generated by G is equal to the special unitary group SU(N).\nLemma 3.1 A quantum system H\u0302 is completely controllable if {U(\u03b8)}\u03b8 = G = SU(N).\nComplete controllability indicates that any target state in the space can be dynamically reached from any initial state with a proper unitary matrix. We can further conclude that complete controllability implies that any unitary matrices in the space can be approximated to an arbitrary precision by U(\u03b8). Ramakrishna et al. (1995) has shown that if the dimension of DLA g generated by the operators G is N2 then the dynamical Lie group of the system is SU(N). Therefore, we have\nTheorem 3.2 (Ramakrishna et al., 1995) A necessary and sufficient condition for complete controllability of a quantum system H\u0302 is that the dimension of the DLA g is N2.\nThis theorem gives a simple way to verify the controllability of a quantum system, namely by computing the dimension of the Lie algebra generated by the set of generators G. The detailed computational method to calculate the dimension of DLA is described in Alg. 1 (Schirmer et al., 2001).\nNotice that different connectivity of the physical qubits can lead to different dimensions in the DLA since they will have a different set of generators. Take RBS gate as an example, if all the qubits are fully connected (we can apply 2-qubit gates to any pair of qubits), we will have 12n(n\u22121) generators in G and the corresponding dimension of DLA is 12dk(dk \u2212 1). However, if all the physical qubits are linked as a circle (each qubit can only be connected with its two neighbors), we will have n generators in G and the dimension of DLA is 12n(n\u2212 1) (illustrated in Fig. 1(b))."
        },
        {
            "heading": "3.2 OVERPARAMETERIZATION FOR HW PRESERVING ANSATZ",
            "text": "Once we know which ansatz can have full controllability of the system, it is critical to know the number of parameters or layers we need to build such ansatz. Larocca et al. (2023) provides a theory to link the overparameterization phenomenon to the dimension of DLA. Overparameterization has certain implications for the trainability of an ansatz. Underparameterized ansatz will lead to local minima and overparameterized ansatz can have better properties and lead to a better landscape for optimization. We first define a crucial concept in the overparameterization theory.\nDefinition 3.3 Quantum Fisher Information Matrix (QFIM): Consider quantum state |\u03c8\u00b5\u27e9 and a set of parameters \u03b8 = {\u03b81, \u00b7 \u00b7 \u00b7 , \u03b8M}. The QFIM is defined as an M \u00d7M matrix:\n[F\u00b5(\u03b8)]ij = 4Re ( \u27e8\u2202i\u03c8\u00b5(\u03b8)|\u2202j\u03c8\u00b5(\u03b8)\u27e9 \u2212 \u27e8\u2202i\u03c8\u00b5(\u03b8)|\u2202\u03c8\u00b5(\u03b8)\u27e9 \u27e8\u2202\u03c8\u00b5(\u03b8)|\u2202j\u03c8\u00b5(\u03b8)\u27e9 ) , (7)\nwhere M is the number of parameters, |\u2202i\u03c8\u00b5(\u03b8)\u27e9 = \u2202 |\u03c8\u00b5(\u03b8)\u27e9 /\u2202\u03b8i = \u2202i |\u03c8\u00b5(\u03b8)\u27e9, \u03b8i \u2208 \u03b8.\nThe overparameterization phenomenon can then be linked to the rank of QFIM.\nDefinition 3.4 Overparameterized QNN: A QNN is defined overparameterized if increasing the number of parametersM past a minimal boundMc does not further increase the rank of any QFIM:\nmax M\u2265Mc,\u03b8 rank[F\u00b5(\u03b8)] = R\u00b5 (8)\nLarocca et al. (2023) further shows that for the general case of QNN, we have:\nMc \u223c dim(g), (9)\nwhereMc is the bound of the number of parameters to reach overparameterization, and g is the DLA correspond to the ansatz. When the number of parameters is larger than Mc, the ansatz will reach its maximum capacity and further adding parameters will not improve the performance. The theory of overparameterization is important for us to decide the number of gates or layers we need to solve certain problems using a given HW preserving ansatz."
        },
        {
            "heading": "3.3 GENERATING UNIVERSAL HW PRESERVING GATES",
            "text": "Now we have rigorous theories for HW preserving gates as well as HW preserving ansatze. We can use the quantum control system theory to generate a gate and decide the connectivity of physical qubits we need to have full controllability and then use the overparameterization theory to decide the number of gates (layers) we need in the ansatz (see Fig. 1 for details).\nFollowing a similar pattern as SWAP, RZZ and RBS gate, we can generate a two-qubit HW preserving gate by only operating on states |01\u27e9 and |10\u27e9.The Hermitian matrix can be of the form:\nHHW =  0 0 0 00 a b 00 b\u2020 c 0 0 0 0 0  , (10) where a, c \u2208 R and b \u2208 C since H = H\u2020. We only have three variables in the matrix which is simple for us to create new gates. We can then convert the Hermitian matrix to a Unitary matrix that can be further decomposed and applied on a quantum circuit. As an embodiment without loss of\ngenerality, we give the following example of Hamiltonian for a HW preserving gate as BS. We start from HRBS and then repeatedly alter a, b and c to make it universal:\nHBS =  0 0 0 0 0 12 1+i 2 \u221a 2 0\n0 1\u2212i 2 \u221a 2\n1 2 0\n0 0 0 0\n , UBS(\u03b8) =  1 0 0 0 0 (e i\u03b8+1) 2 (1+i)(ei\u03b8\u22121) 2 \u221a 2 0 0 (1\u2212i)(e i\u03b8\u22121)\n2 \u221a 2\n(ei\u03b8+1) 2 0\n0 0 0 1  , (11) where ei\u03b8 = cos(\u03b8) + i sin(\u03b8). We put the detailed derivation of this gate in Apx. D. We then decide the connectivity of the circuit to calculate the size of the set of generators G. For an n-qubit circuit, we have P = n for Nearest Neighbor connectivity and P = 12n(n \u2212 1) for full connectivity. With the set of generators, we can compute the dimension of the corresponding DLA g. Note that The dimension of DLA is d2k for both full connectivity (BS-full) and NN connectivity (BS-NN) for BS gate (how to connect the gate is shown in Fig. 1(b)), which indicates that BS gate is universal in the dk-dimensional subspace (a possible decomposition for BS gate is in Fig. 6).\nWe can further utilize the overparameterization theory to determine the number of parameters or layers we need using BS gate. From Eq. 9, we can see that Mc for BS gate with both connectivity is d2k, which can provide us with an approximation amount of parameters we need to build an ansatz. We are also able to estimate the number of layers we need, e.g. we need around \u2308d2k/n\u2309 layers for NN connectivity and \u23082d2k/ ( n(n\u2212 1) ) \u2309 layers for full connectivity. It is vital for us to tell whether the ansatz have enough parameters and have reached its maximum capability."
        },
        {
            "heading": "3.4 UNITARY APPROXIMATION",
            "text": "To better illustrate the connection between the dimension of DLA and the above mentioned theories, we introduce the task of unitary approximation. As described in Sec. 3.1, we have linked the complete control of a quantum system to the unitary approximation. The unitary approximation aims to solve the problem of whether {U(\u03b8)}\u03b8 is equal to SU(N) (see lemma. 3.1). For a target unitary matrix U\u0302 in dk-dimensional HW subspace, the loss function for unitary approximation is\nLUA(\u03b8) = 1\u2212 |Tr ( U\u0302\u2020U(\u03b8) ) |2/d2k. (12)\nWe conduct the experiments on the challenging and widely accepted task of unitary approximation in the HW preserving subspace with dimension dk. The purpose is to compare the performance of different gates and different connectivity. We first consider RBS gate. The DLA dimensions of RBS are less than d2k for full connectivity (RBS-full) and Nearest Neighbor connectivity (RBS-NN). Theoretically the RBS gate can not form an ansatz that can approximate an arbitrary unitary matrix.\nOn the contrary, we can use BS gate to get complete control over the dk-dimensional subspace. To better illustrate the theoretical results, we test RBS and BS gate on randomly generated unitary matrices. We set dk = { ( 5 1 ) , ( 5 2 ) , ( 6 2 ) , ( 6 3 ) } = {5, 10, 15, 20} and the results are shown in Fig. 2.\nThe results verify the theoretical analysis for both complete controllability and overparameterization phenomenon. RBS gate has failed all the tests thus we omit the RBS gates from Fig. 2. However, both connectivity for BS gate are able to approximate all the given matrices. Moreover, the experiments have shown a clear evidence that we need around d2k parameters to approximate the unitary matrices. This verifies Eq. 9 that the dimension of the DLA for both connectivity of BS gate is d2k.\nNote that the BS gate surpasses RBS gate on the unitary approximation task because of the dimension of DLA (according to Theorem 3.2, and only the dimension of BS gate reached d2k ), but it is not necessarily a better choice on any problem. Unitary approximation is the hardest problem in dk-dimensional subspace and if the problem is easy enough, RBS could also be a better choice. We will further illustrate this phenomenon in the numerical experiments."
        },
        {
            "heading": "3.5 THE TRAINABILITY OF THE HW PRESERVING ANSATZ",
            "text": "Now that we have the optimal control theory to determine whether the target state is within the reachable subspace of the ansatz, and the overparameterization theory to determine how many layers we need to construct a proper ansatz, we need to further discuss the trainability of the HW preserving ansatz to make sure that we can find a path to evolve the initial state to the target state without the presence of barren plateaus problem. A variational quantum circuit is said to have a barren plateaus problem if the gradients decay exponentially with the number of qubits (McClean et al., 2018). Thus, we have the following theorem:\nTheorem 3.5 Consider a n-qubit quantum circuit operating in the subspace with Hamming Weight k. The variance of the cost function partial derivative is V ar\u03b8[\u2202lC] \u2248 16k\n2(n\u2212k)2 n4dk .\nDetailed proof of this theorem is in Apx. H. From the above results, we can further conclude that if k is equal to 1, then V ar\u03b8[\u2202lC] \u2248 16n3 . If k = n 2 on the other hand, V ar\u03b8[\u2202lC] \u2248\n( n\nn/2\n)\u22121 , which is\napproximate to exponentially small. This result is consistent with the conjecture that the trainability of the circuit is closely related to dk and smaller dk will lead to better trainability."
        },
        {
            "heading": "4 EXPERIMENTS",
            "text": "We present results on two well-studied constrained VQAs: symmetry-preserving ground state energy estimation and feature selection. All the experiments are performed on a machine with 190GB\n1Utilizing qiskit.quantum info.random unitary in IBM Qiskit\nmemory, one physical CPU with 32 cores AMD Ryzen Threadripper 3970X CPU, and 5 GPUs (Nvidia GeForce RTX 3090). Source code is written in PyTorch and will be publicly available."
        },
        {
            "heading": "4.1 SYMMETRY-PRESERVING STATE PREPARATION",
            "text": "Background. State preparation is a well-studied problem in quantum chemistry with ground state energy estimation as a popular application. The ground state of a molecule is its stationary state with the lowest allowed energy, i.e. ground state energy E0, which can be estimated given the types and relative coordinates of its atoms as well as the number of orbitals and electrons. The energy is closely related to the molecular Hamiltonian Hm, which is an Hermitian matrix embodying the energy of electrons and nuclei in the molecule. Given the final state |\u03c8\u27e9 of the circuit, we have:\nE0 \u2264 \u27e8\u03c8|Hm |\u03c8\u27e9\n\u27e8\u03c8|\u03c8\u27e9 , (13)\nwhere the equality holds if and only if |\u03c8\u27e9 is the ground state. Notice that there are several welldefined symmetries from the physical level (Gard et al., 2020) such as the particle number, total spin and time-reversal, etc. Consider a molecule with n orbitals and k electrons, the ground state is bounded in the dk-dimensional subspace.\nExperimental Setting. We select three wellstudied molecules, i.e. Hydrogen (H2), Lithium Hydride (LiH), Water (H2O) and Ammonia (NH3). We obtain the Hamiltonian of these molecules from the Python package OpenFermion (McClean et al., 2020). The computational basis for all the molecules is STO-3G. Detailed statistics of the molecules are listed in Tab. 1. LiH-8 is a simplified molecule from the\noriginal LiH with only 8 orbitals and 2 electrons. To better illustrate the efficiency of the HW preserving ansatz, we select HEA ansatz (Kandala et al., 2017) and UCCSD (Romero et al., 2018) as the baselines. Among all the methods, only HEA acts in the whole Hilbert space and use |\u03c80\u27e9 = 0\u2297n as the initial state, all the HW preserving ansatz and UCCSD use Hartree-Fock state |\u03c8HF \u27e9 as the initial state. Thus, the loss function for all the ansatz except HEA can be written as:\nLm(\u03b8) = \u27e8\u03c8HF |U\u2020(\u03b8)HmU(\u03b8) |\u03c8HF \u27e9 (14)\nResults and Discussion. We conduct two groups of experiments on 4 of the above mentioned molecules (NH3 apart). We first use a fixed bond length and vary the number of layers. For all the molecules as shown in Fig. 3, our method can achieve an error below 1 \u00d7 10\u221210 which is much smaller than the chemical accuracy at 1.6 \u00d7 10\u22123Ha (we suspect the error at this level might be caused by the accuracy error of python). HEA is able to achieve comparable results with HW preserving ansatz on H2, but with the problem size increases, the 2n space for HEA to explore grows faster than the dk-dimensional subspace. Thus, HEA will need much more parameters than HW preserving ansatz, which leads to the poor performance on LiH and H2O.\nRecall that we have three different dimensions of DLA for the HW preserving ansatz. The dimension of RBS with NN connectivity is 12n(n\u22121), RBS with full connectivity is 1 2dk(dk\u22121), and BS with both connectivity is d2k. From the results, we can see that RBS with NN connectivity is unable to solve the ground state energy estimation problem, and the other three can achieve consistent good estimation. We can thus conclude that the state preparation problem is much easier than the unitary approximation problem with the dimension of DLA be somewhere between 12n(n\u2212 1) and 1 2dk(dk \u2212 1). We can also observe from Fig. 3 that RBS gate with full connectivity performs better than BS gate with less parameters required to reach the exact energy. This reflects the importance of selecting a proper gate considering the physical qubit connectivity and problem difficulty.\nAs for NH3, it is too large and takes unaffordable time to finish all the tests. We have the following data that using BS gate with full connectivity, we reach an energy error at 3 \u00d7 10\u221210 with 21000 parameters. This verify the capability of BS gate to more complex molecules but the number of parameters required are indeed very large.\nWe then vary the bond distance of these molecules to see if the results are consistent on these methods. We fix the number of parameters for each method to the minimum value that reaches\noverparameterization based on the results in Fig. 3. From the results in Fig. 4, we can see that all the methods are consistent with different bond distances. We are able to provide comparable (or even better) results to UCCSD, which indicates that HW preserving ansatz is an efficient and steady substitution for HEA ansatz. The HW preserving gates can be decomposed into basic gates and the NN connectivity is the same as the connectivity of HEA. We can even adjust the connectivity based on the actual structure of the quantum hardware and provide ansatz with better capability, which is lower bounded by the NN connectivity ansatz."
        },
        {
            "heading": "4.2 FEATURE SELECTION",
            "text": "Background. We then study feature selection (Kira & Rendell, 1992; Kumar & Minz, 2014; Li et al., 2017), which has been widely used in machine learning, serving to mitigate the deleterious effects caused by cast dimension, simplify models for enhanced predictability, decrease redundant and irrelevant and speed up training. The feature selection problem can be mapped to a QUBO problem. Since Variational Quantum Eigensolvers can have potential advantages against classical solvers on QUBO problems (Tilly et al., 2022), numerous papers have utilized quantum algorithms to solve feature selection (Nguyen et al., 2014; Milne et al., 2017; Ferrari Dacrema et al., 2022).\nExperimental Setting. One of the main methods to evaluate a feature selection algorithm is to utilize the mutual information (Guyon & Elisseeff, 2003) (see Apx. G for more details). We then use the following feature selection score to evaluate different algorithms:\nSFS = x \u22a4Qx. (15)\nThus, the target is to maximize the score function SFS . However, selecting more than k features can lead to larger scores than possible. To address the constraint, we add a penalty term to the information matrix Q in the QUBO problem as a soft constraint:\nx\u22a4Q\u2032x = x\u22a4Qx\u2212 \u03b1 ( HW (x)\u2212 k )2 (16)\nwhere \u03b1 is the penalty coefficient and k is the number of features to select. This constrained information matrix Q\u2032 can be converted into a Hamiltonian HFS for the feature selection problem. The initial state should be an arbitrary state in the dk-dimensional subspace. Notice that HW preserving ansatze do not need the penalty term so we can set \u03b1 = 0 for all the HW preserving ansatze.\nWe select four open-source datasets to test the HW preserving ansatz as well as a classical QUBO solver pyQUBO (Tanahashi et al., 2019; Zaman et al., 2021). Statistics for the datasets are listed in Tab. 2. We set k for all the datasets as 3 indicating that we select the top 3 features from all the datasets, which can also lead to various dk.\nResults. The results are listed in Tab. 3, where some numbers are stroked for denoting \u201cinvalidity\u201d as they are obtained with more than k features. This also indicates that the penalty term is not large enough to ensure legal results. The results show that the selection of \u03b1 is important in the large 2n Hilbert space. A small \u03b1 will lead to illegal states and an overlarge \u03b1 can lead to hard optimization landscape. Both HW preserving ansatz can achieve better results than the soft constrained QUBO solver, which again verifies the supremacy of searching in a hard constrained subspace."
        },
        {
            "heading": "5 CONCLUSION AND LIMITATION",
            "text": "In this paper, we mainly focus on the symmetries and constraints in the VQAs. These symmetries and constraints can lead to a smaller subspace, namely a dk-dimensional subspace, which we believe is a coherent fit for the HW preserving ansatz. Thus, we revisit the HW preserving ansatz and link the ansatz with these constrained VQAs. We also provide rigorous theoretical analysis on the capability and expressivity as well as the trainability of the HW preserving ansatz and verify these theoretical results on unitary approximation problem. With these theories, we can generate a new gate that is universal in the subspace. We further conduct numerical experiments on ground state energy estimation and feature selection problems. The superior performance demonstrates the efficiency and supremacy of the HW preserving ansatz on constrained VQAs.\nThe main limitation of this paper is that the BS gate proposed in this paper is quite deep if we decompose the gate with basic gates. It is possible that there is a perfect HW preserving gate which is universal in the subspace and also easy to decompose. We have provided all the theories needed to verify the gate, but finding and decomposing the gate is still remains an open question."
        },
        {
            "heading": "A RELATED WORKS",
            "text": "Symmetries and Constraints in Quantum Systems. We first focus on the quantum chemistry problem where we have several well-defined symmetries to illustrate the necessity of considering hard constraints. The VQE algorithm on ground state energy estimation problems can be divided into two main categories. One is based on chemical properties such as the unitary coupled cluster method (Bartlett et al., 1989; Ryabinkin et al., 2018; Shkolnikov et al., 2023) and utilizes Trotter decomposition to form the ansatz. This approach will lead to deep circuits which is unrealizable on current hardware. The other approach does not follow these chemical properties and only uses parameterized gates that are available on the processor such as the Hardware Efficient Ansatz (HEA) (Kandala et al., 2017; Bian et al., 2019) and the Quantum Architecture Search (QAS) (Wu et al., 2023) methods. These methods can produce relatively shallow and feasible ansatz, but they can also generate unphysical states. The most important symmetries (or invariants) in the quantum chemistry problem are the particle number and total spin (Gard et al., 2020). This kind of symmetry is widely used in various problems such as VQE (Gard et al., 2020), Feature selection (Nembrini et al., 2021; Mu\u0308cke et al., 2023), constrained QUBO (Hadfield et al., 2019), etc.\nPrevious HW preserving related works. For the above-mentioned constraints, we can easily address them by adding terms in the Hamiltonian to give a penalty if we break the constraints. However, this method can only provide soft constraints and we can still have illegal results in the final states. Thus, finding an ansatz that only operates in the constrained subspace can guarantee the results are admissible. There are several works that are related to the idea of HW preserving to enable hard constraints on the circuits.\nThe HW preserving gate is previously used in several literature where (Kerenidis et al., 2021) first proposed the idea of quantum orthogonal neural networks. The authors proposed RBS gate with a pyramid structure on the quantum circuit and called it the Pyramidal Circuit. This circuit can act as a substitution for the classical orthogonal neural networks. The Pyramidal Circuit is used as a data loader with experiments on image classification for MNIST and medical images (Landman et al., 2022). The quantum orthogonal layer can be taken as a special case for the HW preserving circuit with k = 1.\nCherrat et al. (2023) further utilizes the RBS gate to solve the hedging problem. This paper investigates the quantum orthogonal layer as well as the quantum compound layer. The quantum orthogonal layer is used as an encoding layer with different architectures of RBS gates arrangement. Results on financial problems especially the hedging problem on a trapped-ion quantum processor are provided in the paper. The authors also provide theoretical analysis that the variance of the gradients decays only polynomially with the number of qubits, which indicates the HW preserving circuit can have better trainability than HEA.\nHowever, these two papers share a strange opinion to use HW preserving gate only as a data loader. It is obvious that HW preserving ansatz can only load data in the dk-dimensional subspace. For a deep learning problem, it\u2019s rare to find all the data in the dataset falling within such a limited subspace. Furthermore, when additional quantum layers are added to the circuit, the circuit no longer maintains its HW preserving property, which negates the advantages of using the HW preserving ansatz. Thus, we rethink the HW preserving ansatz and link this ansatz to VQEs to enlarge the usage of HW preserving ansatz.\nExisting gates that are HW preserving. Apart from the aforementioned RBS gate that we have discussed in detail in the paper, we also have several HW preserving gates from previous literature. Hadfield et al. (2019) proposed a quantum alternating operator ansatz which utilize the XY-mixer and RZZ gate to form a constrained quantum ansatz. The XY-mixer is a HW preserving gate with its Hamiltonian constructed by XX and YY rotation HXY = X \u2297X + Y \u2297 Y . The Hamiltonians for XX, YY, and ZZ gates are\nHXX =  0 0 0 10 0 1 00 1 0 0 1 0 0 0  , HY Y =  0 0 0 \u221210 0 1 00 1 0 0 \u22121 0 0 0  , HZZ =  1 0 0 00 \u22121 0 00 0 \u22121 0 0 0 0 1  . (17)\nThus, we can see that XX, YY, and ZZ gates are all HW preserving gates, and we might use XX, YY, and ZZ to construct other HW preserving gates. However, if we consider the general form of\nHW preserving gate in Eq. 10, we can only construct HW preserving gates with a = c and b = b\u2020. That is exactly why we need a more general form to construct and analyze the HW preserving gates so that we can fully understand the HW preserving circuit with the ability to generate any specific gates we want.\nIn line with the RBS gate, we here provide a brief analysis on the XY-mixer utilizing all the theoretical tools provided in the paper. First of all, the hamiltonian and unitary matrix of the XY-mixer is\nHXY =  0 0 0 00 0 1 00 1 0 0 0 0 0 0  , UXY =  1 0 0 00 cos(\u03b8) \u2212i sin(\u03b8) 00 \u2212i sin(\u03b8) cos(\u03b8) 0 0 0 0 1  . (18) For the NN connectivity, the dimension of DLA of the XY-mixer is\ndim(gXY ) =  (n+ 1)(n\u2212 1) n is odd 1\n2 n(n\u2212 1) n is even\n(19)\nFor the FC connectivity, the dimension of DLA of the XY-mixer is\ndim(gXY ) =  (dk + 1)(dk \u2212 1) n \u0338= 2k 1\n2 (dk + 2)(dk \u2212 2) n = 2k\n(20)\nThus, we can conclude that XY-mixer with full connectivity is quite capable of solving most of the problems except for some rare cases and maybe that is exactly why it is so famous for solving constrained QAOA. However, the XY-mixer on NN-connectivity is not very good even with the RZZ gate as the phase operator (the dimension of DLA is still not full). Therefore, we can conclude that the XY-mixer might not be so capable considering the physical qubit topology. One possible solution to this is to combine other gates to increase the initial generators and gain full controllability under both connectivities."
        },
        {
            "heading": "B FURTHER INTRODUCTION ON PRELIMINARIES",
            "text": "B.1 QUANTUM COMPUTING AND QUANTUM MACHINE LEARNING\nIn quantum computing, \u2019qubit\u2019 (abbreviation of \u2019quantum bit\u2019) is a key concept which is similar to a classical bit with a binary state. The two possible states for a qubit are the state |0\u27e9 and |1\u27e9, which correspond to the state 0 and 1 for a classical bit respectively. We refer the readers to the textbook (Nielsen & Chuang, 2002) for comprehension of quantum information and quantum computing. Here we give a brief introduction to the background.\nA quantum state is commonly denoted in bracket notation. It is also common to form a linear combination of states, which we call a superposition: |\u03c8\u27e9 = \u03b1|0\u27e9 + \u03b2|1\u27e9. Formally, a quantum system on n qubits is an n-fold tensor product Hilbert space H = (C2)\u2297d with dimension 2d. For any |\u03c8\u27e9 \u2208 H, the conjugate transpose \u27e8\u03c8| = |\u03c8\u27e9\u2020. The inner product \u27e8\u03c8|\u03c8\u27e9 = ||\u03c8||22 denotes the square of the 2-norm of \u03c8. The outer product |\u03c8\u27e9\u27e8\u03c8| is a rank 2 tensor. Computational basis states are given by |0\u27e9 = (1, 0), and |1\u27e9 = (0, 1). The composite basis states are defined by e.g. |01\u27e9 = |0\u27e9 \u2297 |1\u27e9 = (0, 1, 0, 0). Analog to a classical computer, a quantum computer is built from a quantum circuit containing wires and elementary quantum gates to carry around and manipulate the quantum information. These gates can be parameterized quantum gates such as Rx(\u03b8), Ry(\u03b8), Rz(\u03b8) or basic gates as \u03c3x, \u03c3y, \u03c3z, CNOT,CZ. For an initial state |\u03c80\u27e9 and L layers of quantum circuit, the final state |\u03c8\u2032\u27e9 can be denoted as\n|\u03c8\u2032\u27e9 = L\u220f\nl=1\nUl |\u03c80\u27e9 . (21)\nAlgorithm 1 Computing the dimension of DLA Require: Generator set G = {H1,H2, \u00b7 \u00b7 \u00b7 ,HP }, hi = \u03c3(Hi).\nlet D = h1; let r = rank(D); for i = 2 to P do\nif rank(D,hi) > r then D.append(hi); r = r + 1;\nend if end for let rout = 0; while rout \u0338= r and r \u0338= N2 do\nfor l = rout + 1 to r do for j = 1 to l do\nlet Htmp = [\u03c3\u22121(D:,l), \u03c3\u22121(D:,j)], htmp = \u03c3(Htmp); if rank(D,htmp) > r then D.append(htmp); r = r + 1\nend if end for\nend for let rout = r; let r = rank(D);\nend while return rout\nB.2 HAMMING DISTANCE AND HAMMING WEIGHT\nIn this section, we recall the definition of Hamming distance and Hamming weight, which is constantly used in this paper. Considering two binary vectors a and b with a,b \u2208 {0, 1}N , where N is the dimension of the vectors. We can define the corresponding Hamming distance of these two vectors as follows:\nDefinition B.1 Hamming distance: The Hamming distance D of two binary vectors a and b is:\nc = a\u2295 b,\nD(a,b) = N\u2211 i=1 ci, (22)\nwhere \u2295 stands for exclusive OR operator.\nWith the definition of Hamming distance, we can further define the Hamming weight of a given binary vector a.\nDefinition B.2 Hamming weight: Let 0 = 0N . The Hamming weight HW of binary vector a is:\nHW (a) = D(a,0), (23)"
        },
        {
            "heading": "C DETAILED ALGORITHM FOR COMPUTING THE DIMENSION OF DLA",
            "text": "We define a transformation \u03c3 which satisfies h = \u03c3(H) (H \u2208 CN\u00d7N ,h \u2208 CN2\u00d71), where h is a column vector obtained by concatenating the columns of H vertically. \u03c3\u22121 stands for the inversed transformation which maps a column vector \u2208 CN2\u00d71 back to a matrix \u2208 CN\u00d7N . D:,j denotes the j-th column of matrix D, and rank(D,h) is the rank of matrix D appending column vector h to the right. [\u00b7, \u00b7] denotes the commutator between two matrices with [A,B] = AB\u2212BA."
        },
        {
            "heading": "D CONVERTING HAMILTONIAN TO UNITARY MATRIX",
            "text": "HBS =  0 0 0 0 0 12 1+i 2 \u221a 2 0\n0 1\u2212i 2 \u221a 2\n1 2 0\n0 0 0 0  (24) We can get the unitary matrix of the BS gate by the Taylor expansion:\nUBS(\u03b8) = e i\u03b8HBS = \u221e\u2211 j=0 1 j! (i)j(\u03b8)jHjBS . (25)\nWhen we design the Hermitian matrix HBS for the BS gate, we set\nH2BS = HBS . (26)\nThus, we have a special character for the matrix HBS that\nHjBS = H j\u22121 BS = ... = H 2 BS = HBS . (27)\nThe unitary matrix can be simplified as follows:\nUBS(\u03b8) = I+HBS \u221e\u2211 j=1 (i\u03b8)j = I+ \u221e\u2211 j=1 i(\u22121)j\u22121 (\u03b8) 2j\u22121 (2j \u2212 1)! + \u221e\u2211 j=1 (\u22121)j (\u03b8) 2j (2j)! , (28)\nWe Use the Taylor expansion of sin(\u03b8), cos(\u03b8) at \u03b8 = 0\nUBS(\u03b8) = I+HBS(i sin \u03b8 + cos \u03b8 \u2212 1) (29)\nTherefore, the unitary matrix for BS is\nUBS(\u03b8) =  1 0 0 0 0 (cos \u03b8+i sin \u03b8+1)2 (1+i)(cos \u03b8+i sin \u03b8\u22121) 2 \u221a 2 0\n0 (1\u2212i)(cos \u03b8+i sin \u03b8\u22121) 2 \u221a 2\n(cos \u03b8+i sin \u03b8+1) 2 0\n0 0 0 1\n . (30)"
        },
        {
            "heading": "E REMARKS ON THE BIT-FLIP ERROR",
            "text": "It has occurred to us that the bit flip error can easily destroy the Hamming Weight of the quantum states and thus affect the subspace that we are operating in. However, this problem can be tackled by utilizing a parity check to make the whole HW preserving circuit bit-flip fault tolerant. The Hamming weight k indicates that we know whether there are odd number or even number of 1s in\nthe state. We can utilize one ancilla qubit as shown in Fig. 7 to enable the parity check. The ancilla qubit is set to |0\u27e9 in the beginning and all the working qubits are linked to the ancilla qubit with CNOT gate, with the ancilla qubit as the target bit. If k is odd, then the measurement outcome of the ancilla qubit should be |1\u27e9. Otherwise, there is a bit flip occurring in the working qubits. Thus, it is much easier to detect a bit-flip error on the HW preserving circuit compared to Shor\u2019s code with two ancilla qubits required to protect one qubit from bit-flip error. We can either rerun the circuit or locate the qubit to correct the bit-flip error."
        },
        {
            "heading": "F FURTHER RESULTS ON UNITARY APPROXIMATION",
            "text": "In this section, we provide further results on the unitary approximation problem. To better demonstrate the convergence of the algorithms with different number of layers, we list the following results in Fig. 8. We also include RBS gate to better illustrate the best precision RBS can get. It is clear that no matter how many parameters we add, RBS gate is unable to go further than 10\u22123. From\nthe comparison between the first column and the second column, we can see that NN connectivity requires more iterations to get similar results compared to ull connectivity. The results on BS also implies the overparameterization phenomenon. We need more than d2k parameters to reach 10\n\u221215, and further adding parameters will not lead to better performance but less iterations."
        },
        {
            "heading": "G FILTER METHODS AND MUTUAL INFORMATION",
            "text": "Out of three primary categories of feature selection techniques, which are wrapper methods, filter methods and embedded methods, we choose filter methods to address the task. Filter methods are particularly advantageous for their ability to execute swiftly and independently on quantum circuits. Our chosen filter method is based on information theory, specifically utilizing mutual information to quantify the relativity between individual features and the target variable. A higher mutual information indicates that the selected feature has a greater predictive power for the target. The mutual information between feature X and target Y is in the form:\nI(X;Y ) = DKL(PX,Y \u2225 PX \u2297 PY ) = \u2211 y\u2208Y \u2211 x\u2208X PX,Y (x, y) log( PX,Y (x, y) PX(x)PY (y) )\n= H(X) +H(Y )\u2212H(X,Y )\n(31)\nAnd we apply conditional mutual information to quantify the relationship between a specific feature, denoted as X , and the target variable on condition of another feature Z. A higher value of conditional mutual information signifies that the feature X exhibits a greater degree of relevance to target and is independent of Z. Conversely, if the conditional mutual information is lower, it shows that the relativity between Z and the target is primarily mediated by the presence of Z, and thus, Z may be considered a redundant variable if we already picked Z. The conditional mutual information is in the form:\nI(X;Y |Z) = EZ [DKL(P(X,Y )|Z \u2225 PX|Z \u2297 PY |Z)] = \u2211 z\u2208Z \u2211 y\u2208Y \u2211 x\u2208X PX,Y,Z(x, y, z) log( PZ(z)PX,Y,Z(x, y, z) PX,Z(x, z)PY,Z(y, z) )\n= H(X|Z) +H(Y |Z)\u2212H(X,Y |Z)\n(32)\nWith the acquisition of mutual information and conditional mutual information, we can encode all the n features into a binary vector x := x1, ..., xn \u2208 {0, 1}n where xi signifies the i-th feature with 1 means the feature is chosen. Subsequently, this information can be amalgamated into a n \u00d7 n matrix Q where the items on the diagonal Qii := \u2212I(Xi;Y ) correspond to the mutual information between the i-th feature Xi and target Y and the off-diagonal elements Qij := \u2212I(Xi;Y |Xj). Then we reformulate the feature selection problem, seeking to maximize both mutual information and conditional mutual information as well as considering the penalty, into the form of a new QUBO problem Q\u2032:\nx\u22a4Q\u2032x = x\u22a4Qx\u2212 \u03b1 ( HW (x)\u2212 k )2 (33)\nx\u2217 = argmax x\u2208{0,1}n\n( x\u22a4Qx\u2212 \u03b1 ( HW (x)\u2212 k )2) = argmax\nx\u2208{0,1}n\n( x\u22a4Q\u2032x ) (34)"
        },
        {
            "heading": "H DETAILED PROOF FOR THE TRAINABILITY",
            "text": "Theorem H.1 Consider a n-qubit quantum circuit operating in the subspace with Hamming Weight k. The variance of the cost function partial derivative is V ar\u03b8[\u2202lC] \u2248 16k\n2(n\u2212k)2 n4dk .\nProof. Consider the partial derivative of the cost function C with respect to the parameters \u03b8. For some parameter \u03b8l in the l-th RBS gate, we have:\n\u2202lC(\u03b8) = \u2202l(Tr[U(\u03b8)\u03c1U(\u03b8) \u2020O])\n= \u2202l(Tr[U\u2212\u03c1U \u2020 \u2212O+]) = iT r[U\u2212\u03c1U \u2020 \u2212[Hl, O+]]\nwhere \u03c1 is the input state, O is the observable to measure, U\u2212 denotes the unitary matrix of the circuit before the l-th gate and U+ denotes the unitary matrix after gate l. O+ = U \u2020 +OU+. The variance of the partial derivative is\nV ar\u03b8[\u2202lC] = \u222b U+ dU+ \u222b U\u2212 dU\u2212(\u2202lC(\u03b8)) 2\n= \u222b U+ dU+ \u222b U\u2212 dU\u2212(iT r[U\u2212\u03c1U \u2020 \u2212[Hl, O+]]) 2,\nwhere [\u00b7, \u00b7] denotes the commutator of two matrices. V ar\u03b8[\u2202lC] = \u2212 \u222b U+ dU+( Tr[\u03c12]Tr[[Hl, O+] 2] d2k \u2212 1 \u2212 Tr 2[\u03c1]Tr[[Hl, O+] 2] dk(d2k \u2212 1) )\n= \u2212 \u222b U+ dU+(Tr[[Hl, O+] 2] dk \u2217 Tr[\u03c12]\u2212 Tr2[\u03c1] dk(d2k \u2212 1) )\n= \u2212dk \u2217 Tr[\u03c1 2]\u2212 Tr2[\u03c1]\ndk(d2k \u2212 1)\n\u222b U+ dU+Tr[[Hl, O+] 2].\nThe initial state |\u03c80\u27e9 is set to be the uniform superposition over all computational basis in the dk subspace. Thus, we have Tr[\u03c1] = 1, T r[\u03c12] = 1.\nV ar\u03b8[\u2202lC] = \u2212 1\ndk(dk + 1) \u222b U+ dU+Tr[[Hl, O+] 2]\n= \u2212 2 dk(dk + 1) [Tr[HlO+HlO+]\u2212 Tr[HlHlO+O+]]\n= \u2212 2 dk(dk + 1) ( Tr[H2l ]Tr 2[O] d2k \u2212 1 \u2212 Tr[H 2 l ]Tr[O 2] dk(d2k \u2212 1) \u2212 Tr[H 2 l ]Tr[O 2] dk ) = \u2212 2Tr[H 2 l ]\ndk(dk + 1) ( Tr2[O]\u2212 dkTr[O2] d2k \u2212 1 ),\nwhere Tr[H2l ] = 2 ( n\u22122 k\u22121 ) = 2k(n\u2212k)n(n\u22121) dk. We take Z0 as the observable, then Tr[O] = dk(n\u22122k) n , T r[O\n2] = dk. (other observables will also hold with the same magnitude) Thus, we have\nV ar\u03b8[\u2202lC] = \u2212 2 dk(dk + 1) \u00d7 2k(n\u2212 k)dk n(n\u2212 1) \u00d7 (\nd2k(n\u22122k) 2\nn2 \u2212 d 2 k d2k \u2212 1 )\n= 4k(n\u2212 k) (dk + 1)n(n\u2212 1) \u00d7 d 2 k(n 2 \u2212 (n\u2212 2k)2) (d2k \u2212 1)n2 = 4k(n\u2212 k)\n(dk + 1)n(n\u2212 1) \u00d7 d 2 k(4nk \u2212 4k2) (d2k \u2212 1)n2\n= 16k2(n\u2212 k)2d2k (dk + 1)n3(n\u2212 1)(d2k \u2212 1) \u2248 16k 2(n\u2212 k)2 n4dk .\nWe can further analyze that if the k is only 1, then V ar\u03b8[\u2202lC] \u2248 16n3 . If the k = n 2 on the other hand, V ar\u03b8[\u2202lC] \u2248 ( n n/2 )\u22121 , which is approximate to exponentially small. This result is consistent with the conjecture that the trainability of the circuit is closely related to dk and smaller dk will lead to better trainability."
        }
    ],
    "year": 2023
}