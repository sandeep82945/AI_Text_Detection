{
    "abstractText": "While artificial intelligence has made remarkable strides in revealing the relationship between biological macromolecules\u2019 primary sequence and tertiary structure, designing RNA sequences based on specified tertiary structures remains challenging. Though existing approaches in protein design have thoroughly explored structure-to-sequence dependencies in proteins, RNA design still confronts difficulties due to structural complexity and data scarcity. Moreover, direct transplantation of protein design methodologies into RNA design fails to achieve satisfactory outcomes although sharing similar structural components. In this study, we aim to systematically construct a data-driven RNA design pipeline. We crafted a large, well-curated benchmark dataset and designed a comprehensive structural modeling approach to represent the complex RNA tertiary structure. More importantly, we proposed a hierarchical data-efficient representation learning framework that learns structural representations through contrastive learning at both clusterlevel and sample-level to fully leverage the limited data. By constraining data representations within a limited hyperspherical space, the intrinsic relationships between data points could be explicitly imposed. Moreover, we incorporated extracted secondary structures with base pairs as prior knowledge to facilitate the RNA design process. Extensive experiments demonstrate the effectiveness of our proposed method, providing a reliable baseline for future RNA design tasks. The source code and benchmark dataset are available at github.com/A4Bio/RDesign.",
    "authors": [
        {
            "affiliations": [],
            "name": "RNA DESIGN"
        },
        {
            "affiliations": [],
            "name": "Cheng Tan"
        },
        {
            "affiliations": [],
            "name": "Yijie Zhang"
        },
        {
            "affiliations": [],
            "name": "Zhangyang Gao"
        },
        {
            "affiliations": [],
            "name": "Bozhen Hu"
        },
        {
            "affiliations": [],
            "name": "Siyuan Li"
        },
        {
            "affiliations": [],
            "name": "Zicheng Liu"
        },
        {
            "affiliations": [],
            "name": "Stan Z. Li"
        }
    ],
    "id": "SP:731d6b08ae148adc97a9475a55d144ee26e545aa",
    "references": [
        {
            "authors": [
                "Bartosz Adamczyk",
                "Maciej Antczak",
                "Marta Szachniuk"
            ],
            "title": "RNAsolo: a repository of cleaned PDBderived RNA 3D structures",
            "venue": "Bioinformatics, 38(14):3668\u20133670,",
            "year": 2022
        },
        {
            "authors": [
                "Bartosz Adamczyk",
                "Maciej Antczak",
                "Marta Szachniuk"
            ],
            "title": "Rnasolo: a repository of cleaned pdbderived rna",
            "venue": "3d structures. Bioinformatics,",
            "year": 2022
        },
        {
            "authors": [
                "Mirela Andronescu",
                "Anthony P Fejes",
                "Frank Hutter",
                "Holger H Hoos",
                "Anne Condon"
            ],
            "title": "A new algorithm for rna secondary structure design",
            "venue": "Journal of molecular biology,",
            "year": 2004
        },
        {
            "authors": [
                "Christof Angermueller",
                "Tanel P\u00e4rnamaa",
                "Leopold Parts",
                "Oliver Stegle"
            ],
            "title": "Deep learning for computational biology",
            "venue": "Molecular systems biology,",
            "year": 2016
        },
        {
            "authors": [
                "Minkyung Baek",
                "Frank DiMaio",
                "Ivan Anishchenko",
                "Justas Dauparas",
                "Sergey Ovchinnikov",
                "Gyu Rie Lee",
                "Jue Wang",
                "Qian Cong",
                "Lisa N Kinch",
                "R Dustin Schaeffer"
            ],
            "title": "Accurate prediction of protein structures and interactions using a three-track",
            "year": 2021
        },
        {
            "authors": [
                "Minkyung Baek",
                "Ryan McHugh",
                "Ivan Anishchenko",
                "David Baker",
                "Frank DiMaio"
            ],
            "title": "Accurate prediction of nucleic acid and protein-nucleic acid complexes using rosettafoldna",
            "venue": "bioRxiv,",
            "year": 2022
        },
        {
            "authors": [
                "Helen M Berman",
                "John Westbrook",
                "Zukang Feng",
                "Gary Gilliland",
                "Talapady N Bhat",
                "Helge Weissig",
                "Ilya N Shindyalov",
                "Philip E Bourne"
            ],
            "title": "The protein data bank",
            "venue": "Nucleic acids research,",
            "year": 2000
        },
        {
            "authors": [
                "BE Bernstein",
                "E Birney",
                "I Dunham",
                "ED Green",
                "C Gunter",
                "M Snyder"
            ],
            "title": "Project consortium encode. An integrated encyclopedia of DNA elements in the human",
            "venue": "genome. Nature,",
            "year": 2012
        },
        {
            "authors": [
                "Anke Busch",
                "Rolf Backofen"
            ],
            "title": "Info-rna\u2014a fast approach to inverse rna",
            "venue": "folding. Bioinformatics,",
            "year": 2006
        },
        {
            "authors": [
                "Hanqun Cao",
                "Cheng Tan",
                "Zhangyang Gao",
                "Yilun Xu",
                "Guangyong Chen",
                "Pheng-Ann Heng",
                "Stan Z Li"
            ],
            "title": "A survey on generative diffusion models",
            "venue": "IEEE Transactions on Knowledge and Data Engineering,",
            "year": 2024
        },
        {
            "authors": [
                "Jiayang Chen",
                "Zhihang Hu",
                "Siqi Sun",
                "Qingxiong Tan",
                "Yixuan Wang",
                "Qinze Yu",
                "Licheng Zong",
                "Liang Hong",
                "Jin Xiao",
                "Tao Shen"
            ],
            "title": "Interpretable rna foundation model from unannotated data for highly accurate rna structure and function predictions",
            "venue": "bioRxiv,",
            "year": 2022
        },
        {
            "authors": [
                "Sheng Chen",
                "Zhe Sun",
                "Lihua Lin",
                "Zifeng Liu",
                "Xun Liu",
                "Yutian Chong",
                "Yutong Lu",
                "Huiying Zhao",
                "Yuedong Yang"
            ],
            "title": "To improve protein sequence profile prediction through image captioning on pairwise residue distance map",
            "venue": "Journal of chemical information and modeling,",
            "year": 2019
        },
        {
            "authors": [
                "Xinshi Chen",
                "Yu Li",
                "Ramzan Umarov",
                "Xin Gao",
                "Le Song"
            ],
            "title": "Rna secondary structure prediction by learning unrolled algorithms",
            "venue": "In International Conference on Learning Representations,",
            "year": 2019
        },
        {
            "authors": [
                "Alexander Churkin",
                "Matan Drory Retwitzer",
                "Vladimir Reinharz",
                "Yann Ponty",
                "J\u00e9r\u00f4me Waldisp\u00fchl",
                "Danny Barash"
            ],
            "title": "Design of rnas: comparing programs for inverse rna folding",
            "venue": "Briefings in bioinformatics,",
            "year": 2018
        },
        {
            "authors": [
                "Francis Crick"
            ],
            "title": "Central dogma of molecular biology",
            "venue": "Nature, 227(5258):561\u2013563,",
            "year": 1970
        },
        {
            "authors": [
                "Rhiju Das",
                "John Karanicolas",
                "David Baker"
            ],
            "title": "Atomic accuracy in predicting and designing noncanonical rna structure",
            "venue": "Nature methods,",
            "year": 2010
        },
        {
            "authors": [
                "Justas Dauparas",
                "Ivan Anishchenko",
                "Nathaniel Bennett",
                "Hua Bai",
                "Robert J Ragotte",
                "Lukas F Milles",
                "Basile IM Wicky",
                "Alexis Courbet",
                "Rob J de Haas",
                "Neville Bethel"
            ],
            "title": "Robust deep learning\u2013 based protein sequence design using proteinmpnn",
            "year": 2022
        },
        {
            "authors": [
                "Jared W Ellefson",
                "Jimmy Gollihar",
                "Raghav Shroff",
                "Haridha Shivram",
                "Vishwanath R Iyer",
                "Andrew D Ellington"
            ],
            "title": "Synthetic evolutionary origin of a proofreading reverse transcriptase",
            "year": 2016
        },
        {
            "authors": [
                "EA Feingold",
                "L Pachter"
            ],
            "title": "The encode (encyclopedia of dna",
            "venue": "elements) project. Science,",
            "year": 2004
        },
        {
            "authors": [
                "Matthias Fey",
                "Jan Eric Lenssen"
            ],
            "title": "Fast graph representation learning with pytorch geometric",
            "venue": "arXiv preprint arXiv:1903.02428,",
            "year": 2019
        },
        {
            "authors": [
                "Laiyi Fu",
                "Yingxin Cao",
                "Jie Wu",
                "Qinke Peng",
                "Qing Nie",
                "Xiaohui Xie"
            ],
            "title": "Ufold: fast and accurate rna secondary structure prediction with deep learning",
            "venue": "Nucleic acids research,",
            "year": 2022
        },
        {
            "authors": [
                "Hin Hark Gan",
                "Samuela Pasquali",
                "Tamar Schlick"
            ],
            "title": "Exploring the repertoire of rna secondary motifs using graph theory; implications for rna design",
            "venue": "Nucleic acids research,",
            "year": 2003
        },
        {
            "authors": [
                "Zhangyang Gao",
                "Cheng Tan",
                "Stan Li"
            ],
            "title": "Alphadesign: A graph protein design method and benchmark on alphafolddb",
            "venue": "arXiv preprint arXiv:2202.01079,",
            "year": 2022
        },
        {
            "authors": [
                "Zhangyang Gao",
                "Cheng Tan",
                "Stan Z Li"
            ],
            "title": "Pifold: Toward effective and efficient protein inverse folding",
            "venue": "arXiv preprint arXiv:2209.12643,",
            "year": 2022
        },
        {
            "authors": [
                "Zhangyang Gao",
                "Cheng Tan",
                "Stan Z Li"
            ],
            "title": "Knowledge-design: Pushing the limit of protein deign via knowledge refinement",
            "venue": "arXiv preprint arXiv:2305.15151,",
            "year": 2023
        },
        {
            "authors": [
                "Zhangyang Gao",
                "Cheng Tan",
                "Yijie Zhang",
                "Xingran Chen",
                "Lirong Wu",
                "Stan Z Li"
            ],
            "title": "Proteininvbench: Benchmarking protein inverse folding on diverse tasks, models, and metrics",
            "venue": "Advances in Neural Information Processing Systems,",
            "year": 2024
        },
        {
            "authors": [
                "Paul P Gardner",
                "Jennifer Daub",
                "John G Tate",
                "Eric P Nawrocki",
                "Diana L Kolbe",
                "Stinus Lindgreen",
                "Adam C Wilkinson",
                "Robert D Finn",
                "Sam Griffiths-Jones",
                "Sean R Eddy"
            ],
            "title": "Rfam: updates to the rna families database",
            "venue": "Nucleic acids research,",
            "year": 2009
        },
        {
            "authors": [
                "Ronald Gstir",
                "Simon Schafferer",
                "Marcel Scheideler",
                "Matthias Misslinger",
                "Matthias Griehl",
                "Nina Daschil",
                "Christian Humpel",
                "Gerald J Obermair",
                "Claudia Schmuckermair",
                "Joerg Striessnig"
            ],
            "title": "Generation of a neuro-specific microarray reveals novel differentially expressed noncoding rnas in mouse models for neurodegenerative diseases",
            "year": 1929
        },
        {
            "authors": [
                "Peixuan Guo",
                "Oana Coban",
                "Nicholas M Snead",
                "Joe Trebley",
                "Steve Hoeprich",
                "Songchuan Guo",
                "Yi Shu"
            ],
            "title": "Engineering rna for targeted sirna delivery and medical application",
            "venue": "Advanced drug delivery reviews,",
            "year": 2010
        },
        {
            "authors": [
                "Ivo L Hofacker",
                "Walter Fontana",
                "Peter F Stadler",
                "L Sebastian Bonhoeffer",
                "Manfred Tacker",
                "Peter Schuster"
            ],
            "title": "Fast folding and comparison of rna secondary structures",
            "venue": "Monatshefte fu\u0308r Chemie/Chemical Monthly,",
            "year": 1994
        },
        {
            "authors": [
                "Chloe Hsu",
                "Robert Verkuil",
                "Jason Liu",
                "Zeming Lin",
                "Brian Hie",
                "Tom Sercu",
                "Adam Lerer",
                "Alexander Rives"
            ],
            "title": "Learning inverse folding from millions of predicted structures",
            "venue": "bioRxiv,",
            "year": 2022
        },
        {
            "authors": [
                "John Ingraham",
                "Vikas Garg",
                "Regina Barzilay",
                "Tommi Jaakkola"
            ],
            "title": "Generative models for graphbased protein design",
            "venue": "Advances in neural information processing systems,",
            "year": 2019
        },
        {
            "authors": [
                "Markus Jeschek",
                "Raphael Reuter",
                "Tillmann Heinisch",
                "Christian Trindler",
                "Juliane Klehr",
                "Sven Panke",
                "Thomas R Ward"
            ],
            "title": "Directed evolution of artificial metalloenzymes for in vivo",
            "venue": "metathesis. Nature,",
            "year": 2016
        },
        {
            "authors": [
                "Bowen Jing",
                "Stephan Eismann",
                "Patricia Suriana",
                "Raphael John Lamarre Townshend",
                "Ron Dror"
            ],
            "title": "Learning from protein structure with geometric vector perceptrons",
            "venue": "In International Conference on Learning Representations,",
            "year": 2020
        },
        {
            "authors": [
                "John Jumper",
                "Richard Evans",
                "Alexander Pritzel",
                "Tim Green",
                "Michael Figurnov",
                "Olaf Ronneberger",
                "Kathryn Tunyasuvunakool",
                "Russ Bates",
                "Augustin \u017d\u0131\u0301dek",
                "Anna Potapenko"
            ],
            "title": "Highly accurate protein structure prediction with alphafold",
            "year": 2021
        },
        {
            "authors": [
                "Yuki Kagaya",
                "Zicong Zhang",
                "Nabil Ibtehaz",
                "Xiao Wang",
                "Tsukasa Nakamura",
                "David Huang",
                "Daisuke Kihara"
            ],
            "title": "Nufold: A novel tertiary rna structure prediction method using deep learning with flexible nucleobase center representation",
            "venue": "bioRxiv,",
            "year": 2023
        },
        {
            "authors": [
                "Ioanna Kalvari",
                "Eric P Nawrocki",
                "Nancy Ontiveros-Palacios",
                "Joanna Argasinska",
                "Kevin Lamkiewicz",
                "Manja Marz",
                "Sam Griffiths-Jones",
                "Claire Toffano-Nioche",
                "Daniel Gautheret",
                "Zasha Weinberg"
            ],
            "title": "Rfam 14: expanded coverage of metagenomic, viral and microrna families",
            "venue": "Nucleic Acids Research,",
            "year": 2021
        },
        {
            "authors": [
                "Kriti Kaushik",
                "Ambily Sivadas",
                "Ankit Verma",
                "Rijith Jayarajan",
                "Satyaprakash Pandey",
                "Tavprithesh Sethi",
                "Souvik Maiti",
                "Vinod Scaria",
                "Sridhar Sivasubbu"
            ],
            "title": "Rna secondary structure profiling in zebrafish reveals unique regulatory features",
            "venue": "BMC genomics,",
            "year": 2018
        },
        {
            "authors": [
                "Robert Kleinkauf",
                "Torsten Houwaart",
                "Rolf Backofen",
                "Martin Mann"
            ],
            "title": "antarna\u2013multi-objective inverse folding of pseudoknot rna using ant-colony optimization",
            "venue": "BMC bioinformatics,",
            "year": 2015
        },
        {
            "authors": [
                "Jens Kortmann",
                "Franz Narberhaus"
            ],
            "title": "Bacterial rna thermometers: molecular zippers and switches",
            "venue": "Nature reviews microbiology,",
            "year": 2012
        },
        {
            "authors": [
                "Zhixiu Li",
                "Yuedong Yang",
                "Eshel Faraggi",
                "Jian Zhan",
                "Yaoqi Zhou"
            ],
            "title": "Direct prediction of profiles of sequences compatible with a protein structure by neural networks with fragment-based local and energy-based nonlocal profiles",
            "venue": "Proteins: Structure, Function, and Bioinformatics,",
            "year": 2014
        },
        {
            "authors": [
                "Zhendong Liu",
                "Yurong Yang",
                "Dongyan Li",
                "Xinrong Lv",
                "Xi Chen",
                "Qionghai Dai"
            ],
            "title": "Prediction of the rna tertiary structure based on a random sampling strategy and parallel mechanism",
            "venue": "Frontiers in Genetics,",
            "year": 2022
        },
        {
            "authors": [
                "Ronny Lorenz",
                "Stephan H Bernhart",
                "Christian H\u00f6ner zu Siederdissen",
                "Hakim Tafer",
                "Christoph Flamm",
                "Peter F Stadler",
                "Ivo L Hofacker"
            ],
            "title": "Viennarna package 2.0",
            "venue": "Algorithms for molecular biology,",
            "year": 2011
        },
        {
            "authors": [
                "Jeffrey D Martell",
                "Masahito Yamagata",
                "Thomas J Deerinck",
                "S\u00e9bastien Phan",
                "Carolyn G Kwa",
                "Mark H Ellisman",
                "Joshua R Sanes",
                "Alice Y Ting"
            ],
            "title": "A split horseradish peroxidase for the detection of intercellular protein\u2013protein interactions and sensitive visualization of synapses",
            "venue": "Nature biotechnology,",
            "year": 2016
        },
        {
            "authors": [
                "David H Mathews"
            ],
            "title": "Rna secondary structure analysis using rnastructure",
            "venue": "Current Protocols in Bioinformatics,",
            "year": 2014
        },
        {
            "authors": [
                "Nono SC Merleau",
                "Matteo Smerlak"
            ],
            "title": "arnaque: an evolutionary algorithm for inverse pseudoknotted rna folding inspired by l\u00e9vy flights",
            "venue": "BMC bioinformatics,",
            "year": 2022
        },
        {
            "authors": [
                "Sarai Meyer",
                "James Chappell",
                "Sitara Sankar",
                "Rebecca Chew",
                "Julius B Lucks"
            ],
            "title": "Improving fold activation of small transcription activating rnas (stars) with rational rna engineering strategies",
            "venue": "Biotechnology and bioengineering,",
            "year": 2016
        },
        {
            "authors": [
                "Zhichao Miao",
                "Ryszard W Adamiak",
                "Maciej Antczak",
                "Micha\u0142 J Boniecki",
                "Janusz Bujnicki",
                "Shi-Jie Chen",
                "Clarence Yu Cheng",
                "Yi Cheng",
                "Fang-Chieh Chou",
                "Rhiju Das"
            ],
            "title": "Rna-puzzles round iv: 3d structure predictions of four ribozymes and two aptamers",
            "year": 2020
        },
        {
            "authors": [
                "Teruyuki Nagamune"
            ],
            "title": "Biomolecular engineering for nanobio/bionanotechnology",
            "venue": "Nano convergence,",
            "year": 2017
        },
        {
            "authors": [
                "Eric P Nawrocki",
                "Sarah W Burge",
                "Alex Bateman",
                "Jennifer Daub",
                "Ruth Y Eberhardt",
                "Sean R Eddy",
                "Evan W Floden",
                "Paul P Gardner",
                "Thomas A Jones",
                "John Tate"
            ],
            "title": "Rfam 12.0: updates to the rna families database",
            "venue": "Nucleic acids research,",
            "year": 2015
        },
        {
            "authors": [
                "RM Nicholas",
                "M Zuker"
            ],
            "title": "Unafold: Software for nucleic acid folding and hybridization",
            "venue": "Bioinformatics, 453:3\u201331,",
            "year": 2008
        },
        {
            "authors": [
                "James O\u2019Connell",
                "Zhixiu Li",
                "Jack Hanson",
                "Rhys Heffernan",
                "James Lyons",
                "Kuldip Paliwal",
                "Abdollah Dehzangi",
                "Yuedong Yang",
                "Yaoqi Zhou"
            ],
            "title": "Spin2: Predicting sequence profiles from protein structures using deep neural networks",
            "year": 2018
        },
        {
            "authors": [
                "Robin Pearce",
                "Gilbert S Omenn",
                "Yang Zhang"
            ],
            "title": "De novo rna tertiary structure prediction at atomic resolution using geometric potentials from deep learning",
            "venue": "bioRxiv,",
            "year": 2022
        },
        {
            "authors": [
                "Genevieve C Pugh",
                "Jonathan R Burns",
                "Stefan Howorka"
            ],
            "title": "Comparing proteins and nucleic acids for next-generation biomolecular engineering",
            "venue": "Nature Reviews Chemistry,",
            "year": 2018
        },
        {
            "authors": [
                "Yifei Qi",
                "John ZH Zhang"
            ],
            "title": "Densecpd: improving the accuracy of neural-network-based computational protein sequence design with densenet",
            "venue": "Journal of chemical information and modeling,",
            "year": 2020
        },
        {
            "authors": [
                "Mengying Qin",
                "Zhendong Liu",
                "Dongyan Li",
                "Xi Chen",
                "Xinrong Lv",
                "Xiaofeng Li",
                "Junxue Zhou",
                "Hui Wang"
            ],
            "title": "Improved predictive algorithm of rna tertiary structure based on gnn",
            "venue": "In 2022 18th International Conference on Computational Intelligence and Security (CIS),",
            "year": 2022
        },
        {
            "authors": [
                "Lisa Rosenbaum"
            ],
            "title": "Tragedy, perseverance, and chance\u2014the story of car-t therapy",
            "venue": "N Engl J Med,",
            "year": 2017
        },
        {
            "authors": [
                "Adam Roth",
                "Ronald R Breaker"
            ],
            "title": "The structural and functional diversity of metabolite-binding riboswitches",
            "venue": "Annual review of biochemistry,",
            "year": 2009
        },
        {
            "authors": [
                "Kristian Rother",
                "Magdalena Rother",
                "Micha\u0142 Boniecki",
                "Tomasz Puton",
                "Janusz M Bujnicki"
            ],
            "title": "Rna and protein 3d structure modeling: similarities and differences",
            "venue": "Journal of molecular modeling,",
            "year": 2011
        },
        {
            "authors": [
                "\u00c1lvaro Rubio-Largo",
                "Nuria Lozano-Garc\u0131\u0301a",
                "Jos\u00e9 M Granado-Criado",
                "Miguel A VegaRodr\u0131\u0301guez"
            ],
            "title": "Solving the rna inverse folding problem through target structure decomposition and multiobjective evolutionary computation",
            "venue": "Applied Soft Computing,",
            "year": 2023
        },
        {
            "authors": [
                "Frederic Runge",
                "Danny Stoll",
                "Stefan Falkner",
                "Frank Hutter"
            ],
            "title": "Learning to design rna",
            "venue": "In International Conference on Learning Representations,",
            "year": 2018
        },
        {
            "authors": [
                "Kengo Sato",
                "Michiaki Hamada",
                "Kiyoshi Asai",
                "Toutai Mituyama"
            ],
            "title": "Centroidfold: a web server for rna secondary structure prediction",
            "venue": "Nucleic acids research,",
            "year": 2009
        },
        {
            "authors": [
                "Tao Shen",
                "Zhihang Hu",
                "Zhangzhi Peng",
                "Jiayang Chen",
                "Peng Xiong",
                "Liang Hong",
                "Liangzhen Zheng",
                "Yixuan Wang",
                "Irwin King",
                "Sheng Wang"
            ],
            "title": "E2efold-3d: End-to-end deep learning method for accurate de novo rna 3d structure prediction",
            "venue": "arXiv preprint arXiv:2207.01586,",
            "year": 2022
        },
        {
            "authors": [
                "Jaswinder Singh",
                "Jack Hanson",
                "Kuldip Paliwal",
                "Yaoqi Zhou"
            ],
            "title": "Rna secondary structure prediction using an ensemble of two-dimensional deep neural networks and transfer learning",
            "venue": "Nature communications,",
            "year": 2019
        },
        {
            "authors": [
                "Jaswinder Singh",
                "Kuldip Paliwal",
                "Jaspreet Singh",
                "Yaoqi Zhou"
            ],
            "title": "Rna backbone torsion and pseudotorsion angle prediction using dilated convolutional neural networks",
            "venue": "Journal of Chemical Information and Modeling,",
            "year": 2021
        },
        {
            "authors": [
                "Michael F Sloma",
                "David H Mathews"
            ],
            "title": "Exact calculation of loop formation probability identifies folding motifs in rna secondary",
            "venue": "structures. RNA,",
            "year": 2016
        },
        {
            "authors": [
                "Cheng Tan",
                "Zhangyang Gao",
                "Stan Z Li"
            ],
            "title": "Rfold: Towards simple yet effective rna secondary structure prediction",
            "venue": "arXiv preprint arXiv:2212.14041,",
            "year": 2022
        },
        {
            "authors": [
                "Cheng Tan",
                "Zhangyang Gao",
                "Jun Xia",
                "Bozhen Hu",
                "Stan Z Li"
            ],
            "title": "Global-context aware generative protein design",
            "venue": "IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP),",
            "year": 2023
        },
        {
            "authors": [
                "Cheng Tan",
                "Zhangyang Gao",
                "Lirong Wu",
                "Jun Xia",
                "Jiangbin Zheng",
                "Xihong Yang",
                "Yue Liu",
                "Bozhen Hu",
                "Stan Z. Li"
            ],
            "title": "Cross-gate mlp with protein complex invariant embedding is a one-shot antibody",
            "year": 2024
        },
        {
            "authors": [
                "Raphael JL Townshend",
                "Stephan Eismann",
                "Andrew M Watkins",
                "Ramya Rangan",
                "Maria Karelina",
                "Rhiju Das",
                "Ron O Dror"
            ],
            "title": "Geometric deep learning of rna",
            "year": 2021
        },
        {
            "authors": [
                "Ashish Vaswani",
                "Noam Shazeer",
                "Niki Parmar",
                "Jakob Uszkoreit",
                "Llion Jones",
                "Aidan N Gomez",
                "\u0141ukasz Kaiser",
                "Illia Polosukhin"
            ],
            "title": "Attention is all you need",
            "venue": "Advances in neural information processing systems,",
            "year": 2017
        },
        {
            "authors": [
                "Jian Wang",
                "Nikolay V Dokholyan"
            ],
            "title": "Application of rna tertiary structure prediction tool ifoldrna in rna nanotechnology",
            "venue": "In RNA Nanotechnology and Therapeutics,",
            "year": 2022
        },
        {
            "authors": [
                "Jingxue Wang",
                "Huali Cao",
                "John ZH Zhang",
                "Yifei Qi"
            ],
            "title": "Computational protein design with deep learning neural networks",
            "venue": "Scientific reports,",
            "year": 2018
        },
        {
            "authors": [
                "Paulina H Wanrooij",
                "Jay P Uhler",
                "Tomas Simonsson",
                "Maria Falkenberg",
                "Claes M Gustafsson"
            ],
            "title": "G-quadruplex structures in rna stimulate mitochondrial transcription termination and primer formation",
            "venue": "Proceedings of the National Academy of Sciences,",
            "year": 2010
        },
        {
            "authors": [
                "Katherine Deigan Warner",
                "Christine E Hajdin",
                "Kevin M Weeks"
            ],
            "title": "Principles for targeting rna with drug-like small molecules",
            "venue": "Nature reviews Drug discovery,",
            "year": 2018
        },
        {
            "authors": [
                "Peng Xiong",
                "Ruibo Wu",
                "Jian Zhan",
                "Yaoqi Zhou"
            ],
            "title": "Pairing a high-resolution statistical potential with a nucleobase-centric sampling algorithm for improving rna model refinement",
            "venue": "Nature communications,",
            "year": 2021
        },
        {
            "authors": [
                "Xiufeng Yang",
                "Kazuki Yoshizoe",
                "Akito Taneda",
                "Koji Tsuda"
            ],
            "title": "Rna inverse folding using monte carlo tree search",
            "venue": "BMC bioinformatics,",
            "year": 2017
        },
        {
            "authors": [
                "Joseph D Yesselman",
                "Rhiju Das"
            ],
            "title": "Rna-redesign: a web server for fixed-backbone 3d design of rna",
            "venue": "Nucleic Acids Research,",
            "year": 2015
        },
        {
            "authors": [
                "Joseph N Zadeh",
                "Conrad D Steenberg",
                "Justin S Bois",
                "Brian R Wolfe",
                "Marshall B Pierce",
                "Asif R Khan",
                "Robert M Dirks",
                "Niles A Pierce"
            ],
            "title": "Nupack: Analysis and design of nucleic acid systems",
            "venue": "Journal of computational chemistry,",
            "year": 2011
        },
        {
            "authors": [
                "Yang Zhang",
                "Jeffrey Skolnick"
            ],
            "title": "Tm-align: a protein structure alignment algorithm based on the tm-score",
            "venue": "Nucleic acids research,",
            "year": 2005
        },
        {
            "authors": [
                "Yuan Zhang",
                "Yang Chen",
                "Chenran Wang",
                "Chun-Chao Lo",
                "Xiuwen Liu",
                "Wei Wu",
                "Jinfeng Zhang"
            ],
            "title": "Prodconn: Protein design using a convolutional neural network. Proteins: Structure",
            "venue": "Function, and Bioinformatics,",
            "year": 2020
        },
        {
            "authors": [
                "Michael Zuker"
            ],
            "title": "Mfold web server for nucleic acid folding and hybridization prediction",
            "venue": "Nucleic acids research,",
            "year": 2003
        },
        {
            "authors": [
                "2019 Ingraham et al",
                "2018 Wang et al",
                "2020 Jing et al",
                "2022 Tan et al",
                "2022a Gao et al",
                "O\u2019Connell"
            ],
            "title": "2018). However, since RNA sequences only contain four letters, the perplexity metric traditionally used in natural language processing may not accurately reflect nucleotide-level prediction accuracy. Therefore, we use the recovery score to assess nucleotide-level accuracy by measuring the proportion of target RNA sequences",
            "year": 2018
        }
    ],
    "sections": [
        {
            "heading": "1 INTRODUCTION",
            "text": "Ribonucleic acid (RNA) is a fundamental polymer composed of ribonucleotides, serving as a vital biological macromolecule that regulates a plethora of cellular functions (Kaushik et al., 2018; Guo et al., 2010; Sloma & Mathews, 2016; Warner et al., 2018). Non-coding RNA strands exhibit intricate three-dimensional structures, which are essential for their biological activities (Feingold & Pachter, 2004; Gstir et al., 2014). The complex geometries of RNA molecules empower them to execute irreplaceable functions in crucial cellular processes (Crick, 1970), encompassing but not limited to mRNA translation (Roth & Breaker, 2009), RNA splicing (Runge et al., 2018; Wanrooij et al., 2010; Kortmann & Narberhaus, 2012), and gene regulation (Meyer et al., 2016).\nSpecifically, the primary structure of RNA refers to its linear sequence of ribonucleotides (Hofacker et al., 1994; Rother et al., 2011; Kagaya et al., 2023). The primary structure then folds into a secondary structure with canonical base pairs, forming stems and loops (Nicholas & Zuker, 2008; Yang et al., 2017; Liu et al., 2022). Tertiary interactions between secondary structural elements subsequently give rise to the three-dimensional structure (Qin et al., 2022; Wang & Dokholyan, 2022; Yesselman & Das, 2015; Das et al., 2010). Figure 1 illustrates an example of the hierarchical folding of RNA primary, secondary, and tertiary structures. Gaining a comprehensive understanding \u2217Equal contribution. \u2020Corresponding author.\nof RNA structure is fundamental to figuring out biological mysteries and holds tremendous promise for biomedical applications. However, solving RNA structures through experimental techniques remains challenging due to their structural complexity and transient nature. Computational modeling of RNA structure and dynamics has thus become particularly valuable and urgent.\nRecent years have witnessed the emergence and rapid advancement of data-driven computational modeling of RNA (Angermueller et al., 2016; Xiong et al., 2021; Singh et al., 2021; Cao et al., 2024). In particular, algorithms for RNA secondary structure prediction have been extensively developed, yielding impressive results through leveraging large datasets of known secondary structures (Singh et al., 2019; Chen et al., 2019b; Fu et al., 2022; Tan et al., 2022). However, knowledge of RNA tertiary structures, which is crucial for thoroughly understanding RNA functional mechanisms and discovering RNA-targeted therapies (Warner et al., 2018; Churkin et al., 2018), remains limited (Townshend et al., 2021). The success of protein structure prediction (Jumper et al., 2021; Baek et al., 2021) has motivated researchers to tackle the even more challenging problem of RNA tertiary structure prediction, leading to the development of RNA tertiary structure folding algorithms such as DeepFoldRNA (Pearce et al., 2022), RoseTTAFoldNA (Baek et al., 2022), and RhoFold (Chen et al., 2022; Shen et al., 2022). While predicting RNA tertiary structures from primary sequences can leverage abundant sequence data (Chen et al., 2022), its inverse problem, designing RNA sequences that reliably fold into a specified tertiary structure, remains largely underexplored.\nThe key reasons that RNA tertiary structure modeling lags far behind protein tertiary structure modeling stem from two main aspects: (1) RNA demonstrates greater structural intricacy and flexibility than proteins, posing formidable hurdles for structure prediction and design (Townshend et al., 2021; Bernstein et al., 2012; Berman et al., 2000). The less constrained structure space of RNA leads to intractable challenges in modeling the RNA tertiary structure. (2) High-resolution RNA tertiary structures are scarce compared to proteins due to their conformational dynamics and instability(Rother et al., 2011). The quantity of available RNA structures constitutes less than 1% of that for proteins (Adamczyk et al., 2022b; Kalvari et al., 2021). To deal with the above problem, we propose a thorough pipeline aiming at data-driven tertiary structure-based RNA design tasks. In detail, we first compile a large-scale RNA tertiary structure dataset based on extant high-quality structure data from Protein Data Bank (PDB) (Berman et al., 2000) and RNAsolo (Adamczyk et al., 2022b). Then, regarding the deficiency in RNA tertiary structure modeling and the unsatisfying transferable capability of conventional protein structure modeling techniques to the RNA field, we propose a comprehensive RNA tertiary structure modeling. To optimize the use of the limited data, we introduce a hierarchical and data-efficient representation learning framework that applies contrastive learning at both the cluster and sample levels. We can explicitly impose intrinsic relationships between the data by constraining the data representations within a limited hyperspherical space. Moreover, we provide a strategy that utilizes extracted secondary structure as prior information to guide the RNA design inspired by the correlation between RNA secondary and primary structures.\nThe main contributions of this work are summarized as follows:\n\u2022 We propose a formal formulation of the tertiary structure-based RNA design problem. To establish a fair benchmark for tertiary structure-based RNA design, we compile a large dataset of RNA tertiary structures and provide a fundamental data split based on both structural similarity and sequence length distribution.\n\u2022 We propose a comprehensive structural modeling approach for the complex RNA tertiary structure and design an RNA design framework called RDesign, which is composed of a hierarchical representation learning scheme and a secondary structure imposing strategy.\n\u2022 Through extensive experiments across standard RNA design benchmarks and generalization ability assessments, we demonstrate the efficacy of our proposed method. This provides a reliable pipeline for future research in this important and promising field."
        },
        {
            "heading": "2 RELATED WORK",
            "text": ""
        },
        {
            "heading": "2.1 BIOMOLECULAR ENGINEERING",
            "text": "In recent decades, the rapid advancements in biophysics, biochemistry, and chemical engineering have enabled a plethora of novel applications (Nagamune, 2017), including engineering enzymes for industrial biocatalysis (Pugh et al., 2018), tailoring antibodies for precision cancer therapies (Jeschek et al., 2016), developing trackable fluorescent proteins for biological imaging (Rosenbaum, 2017), and optimizing polymerases for forensic DNA analysis (Martell et al., 2016). RNA design is of particular interest among them due to the diverse functions that RNA can fulfill, ranging from translation and gene expression to catalysis (Ellefson et al., 2016). This multifunctionality is ascribed to the structural diversity of RNA (Andronescu et al., 2004). In this work, we focus on tertiary structure-based RNA design to uncover the relationships between RNA structure and sequence."
        },
        {
            "heading": "2.2 PROTEIN DESIGN",
            "text": "RNA and protein are essential components of cells. Despite having different chemical constituents, their higher-order structures can be described similarly (Rother et al., 2011). Early works on computational protein design (Wang et al., 2018; Chen et al., 2019a) utilize multi-layer perceptron (MLP), and convolutional neural network(CNN) to predict residue types from protein structure. 3D CNNs have enabled tertiary structure-based design such as ProDCoNN (Zhang et al., 2020) and DenseCPD (Qi & Zhang, 2020). GraphTrans (Ingraham et al., 2019) combines attention (Vaswani et al., 2017) and auto-regressive decoding to generate protein sequences from graphs, inspiring a series of recent advancing approaches (Jing et al., 2020; Dauparas et al., 2022; Hsu et al., 2022; Tan et al., 2023; Gao et al., 2022b; 2023; 2024; Tan et al., 2024). While insights from protein research have illuminated RNA biology, RNA studies have trailed due to a scarcity of available data and complex structure modeling (Gan et al., 2003)."
        },
        {
            "heading": "2.3 RNA DESIGN",
            "text": "The computational design of RNA sequences aims to generate nucleic acid strands that will fold into a targeted secondary or tertiary structure. Secondary structure-based RNA design was first introduced by Vienna (Hofacker et al., 1994). Early works solved the RNA design problem through stochastic optimization and energy minimization with thermodynamic parameters, such as RNAfold (Lorenz et al., 2011), Mfold (Zuker, 2003), UNAFold (Nicholas & Zuker, 2008), and RNAStructure (Mathews, 2014). Probabilistic models and posterior decoding were employed to solve this problem (Sato et al., 2009). Other works that operate on a single sequence and try to find a solution by changing a few nucleotides include RNAInverse (Hofacker et al., 1994), RNASSD (Andronescu et al., 2004), INFO-RNA (Busch & Backofen, 2006), and NUPACK (Zadeh et al., 2011). There are global searching methods, including antaRNA (Kleinkauf et al., 2015), aRNAque (Merleau & Smerlak, 2022), eM2dRNAs (Rubio-Largo et al., 2023) and MCTS-RNA (Yang et al., 2017). Reinforcement learning-based methods have also been developed (Runge et al., 2018).\nAlthough numerous approaches have been studied for engineering RNA secondary structures, RNA design based on the tertiary structure is still challenging due to the lack of high-resolution structural data (Yesselman & Das, 2015; Das et al., 2010). Although structure prediction algorithms (Liu et al., 2022; Qin et al., 2022; Wang & Dokholyan, 2022) can utilize abundant RNA primary sequence information, the progress of RNA design has been hindered by the scarcity of determined RNA 3D structures. To alleviate the difficulty, we explore the uncharted areas of tertiary structure-centric RNA design systematically and propose a complete pipeline to address this challenge."
        },
        {
            "heading": "3 METHODS",
            "text": ""
        },
        {
            "heading": "3.1 PRELIMINARIES",
            "text": "For an RNA sequence in its primary structure, we assume it comprises N nucleotide bases selected from the set of nucleotides: A (Adenine), U (Uracil), C (Cytosine), and G (Guanine). Therefore, the sequence can be represented as:\nNucleotides := {A, U, C, G}, SN = {si \u2208 Nucleotides \u2223\u2223 i \u2208 [1, N ] \u2229 Z}, (1) The formation of the tertiary structure requires the folding of this sequence in three-dimensional space, which can be denoted as:\nAtoms := {P,O5\u2032,C5\u2032,C4\u2032,C3\u2032,O3\u2032}, XN = {x\u03c9i \u2208 R3 \u2223\u2223 i \u2208 [1, N ] \u2229 Z, \u03c9 \u2208 Atoms}, (2) where the Atoms set denotes the six atoms that comprise the RNA backbone.\nWe incorporate secondary structure information using dot-bracket notation. Unpaired nucleotides are represented by dots, and paired nucleotides are represented by brackets, as shown in Figure 2.\nAN = {ai \u2208 { . , ( , )} \u2223\u2223 i \u2208 [1, N ] \u2229 Z}, (3)\nwhere ai is a dot if the nucleotide is unpaired, or a matching bracket otherwise. Finally, the tertiary structure-based RNA design problem could be formulated as:\nF\u0398 : XN 7\u2192 SN , such that AN = g(XN ) satisfies the pairing rules,\n(4)\nwhere F\u0398 is a learnable mapping with parameters \u0398, and g(\u00b7) is a function that extracts the secondary structure denoted by dot-bracket notation from the tertiary structure. Namely, F\u0398 denotes the mapping from XN to SN , which means from the tertiary structure to the primary structure. It illustrates that while we map the tertiary structure X of RNA to the primary sequence S, we ensure that the predicted sequence aligns with the pairing rules associated with the secondary structure A."
        },
        {
            "heading": "3.2 COMPREHENSIVE RNA TERTIARY STRUCTURE MODELING",
            "text": "We construct a local coordinate system Qi for the i-th nucleotide in the RNA tertiary structure. The detailed procedure for defining the local coordinate system is in Appendix D. While studies on protein design have achieved considerable success using only the C\u03b1 atoms to model backbone geometry, this approach does not readily translate to RNA. RNA exhibits a diversity of backbone conformations and base-pairing geometries that cannot be sufficiently captured by such modeling. The complexity and plasticity of RNA structure necessitate a comprehensive treatment.\nTo adequately capture the complex structural information inherent in the three-dimensional folding of RNA molecules, we propose a general approach for modeling RNA tertiary structure. We represent RNA tertiary structure as an attributed graph G = (V,E) comprising node attributes V and edge attributes E. The graph is constructed by identifying the K nearest neighbors in 3D space for each node; each node i has a set of K neighbors denoted N (i,K). Specifically, V \u2208 RN\u00d7fn contains fn-dimensional node attributes for N nodes, and E \u2208 RN\u00d7K\u00d7fm contains fm-dimensional edge attributes for each node\u2019s K neighbors. By default, we set K = 30.\nWe outline the attributes used in our modeling approach along with their corresponding illustrations in Table 1, which includes two levels of attributes: (i) intra-nucleotide level attributes describing the local geometry of each nucleotide as the node attribute V , and (ii) inter-nucleotide level attributes describing the relative geometry between nucleotides as the edge attribute E.\nIntra-nucleotide level (1) The dihedral angles, shown as red arrows in Figure 3, are calculated. We represent the dihedral angles of the RNA backbone using sin and cos functions. (2) The spatial distances between the other intra-nucleotide atoms and the atom Pi are encoded into radial basis functions (RBFs). (3) The directions of the other intra-nucleotide atoms relative to the atom Pi are calculated with respect to the local coordinate system Qi.\nInter-nucleotide level (1) An orientation encoding q(\u00b7) is calculated from the quaternion representation of the spatial rotation matrix QTi Qj . (2) The spatial distances between inter-nucleotide atoms from neighboring nucleotides and the atom Pi are encoded into radial basis functions (RBFs). (3) The directions of the other inter-nucleotide atoms relative to the atom Pi are calculated."
        },
        {
            "heading": "3.3 HIERARCHICAL DATA-EFFICIENT REPRESENTATION LEARNING",
            "text": "Now that RNA tertiary structure has been adequately modeled, the remaining challenge is how to learn from scarce data in a data-efficient manner. The key motivation is explicitly imposing the inherent data relationships based on prior knowledge. We first use L layers of message-passing neural networks (MPNNs) to learn the node representation. Specifically, the l-th hidden layer of the i-th nucleotide is defined as follows:\nh (l) Vi = MPNN([hEij ,h (l\u22121) Vi\n, \u2211\nj\u2208N (i,K)\nh (l\u22121) Vj ]), (5)\nwhere h(0)V , hE are the embeddings of the intra-nucleotide and inter-nucleotide level features from the tertiary structure modeling, respectively. When generating the RNA sequence, a fully connected layer f maps the node representation h(L)Vi to the RNA sequence space: f(h (L) Vi ).\nTo enable data-efficient representation learning, we obtain the graph-level representation through the average pooling of the node representations hG = 1N \u2211N i=1 h (L) Vi\nand the corresponding projection g(hG) by the projection g : R\u2192 S that projects the Euclidean space into the hyperspherical space. We propose a hierarchical representation learning framework comprising cluster-level and confidence-aware sample-level representation learning, as shown in Figure 4. The cluster-level rep-\nresentation learning utilizes topological similarity between RNA structures. We obtain RNA structure clusters based on TM-score, which indicates structural similarity(Zhang & Skolnick, 2005). We define positive pairs as RNA data with similar topological structures that attract each other in the embedding space, while negative pairs with dissimilar topological structures repel each other. The cluster-level representation learning is defined as follows:\nLcluster = \u2212 \u2211 p\u2208D log exp(gp \u00b7 gq/\u03c4)\u2211 gk\u2208{gq}\u222aKc exp(gp \u00b7 gk/\u03c4) , (6)\nwhere (gp, gq) is a positive pair that comes from the same structural cluster, Kc is a set of negative samples for gp identified by the cluster they belong to, and D is the data set. We denote gp as the graph representation projection of the p-th RNA sample for notational convenience.\nThe confidence-aware sample-level representation learning is designed to capture the microscopic intrinsic properties of RNA structures. The positive pairs are defined as a given RNA structure sample and its random perturbed structures. The perturbed structures are obtained by adding Gaussian noise to the experimentally determined coordinates. To prevent excessive deviation, we filter out the perturbed structures with low structural similarity (TM-score \u2264 0.8) and high structural deviation (RMSD \u2265 1.0). The RMSD also evaluates the confidence level of the perturbed data. Formally, the sample-level representation learning can be formulated as:\nLsample = \u2212 \u2211 p\u2208D \u03b3p,p\u2032 log exp(gp \u00b7 g\u2032p/\u03c4)\u2211 gk\u2208{g\u2032p}\u222aKs exp(gp \u00b7 gk/\u03c4) , (7)\nwhere p\u2032 is the perturbed structure of the p-th RNA structure, and Ks is simply defined as other samples apart from gp. The confidence score \u03b3p,p\u2032 is defined as exp\u2212RMSD(p,p\n\u2032) so that when RMSD(p, p\u2032)\u2192 0, the confidence approaches 1. The cluster-level representation provides a coarse-grained embedding, capturing the global topological similarity between RNA structures. The confidence-aware sample-level representation provides intrinsic knowledge that is robust to minor experimental deviations. As shown in Figure 4, by constraining the limited data into the restricted hyperspherical space with imposed prior knowledge, the intrinsic relationships between data are explicitly modeled."
        },
        {
            "heading": "3.4 SECONDARY STRUCTURE IMPOSING STRATEGY",
            "text": "With the given tertiary structure, we can derive the corresponding secondary structure using the notation shown in Figure 2. The secondary structure is represented using parentheses to indicate paired nucleotides, with unpaired sites represented by one of the four RNA nucleotides (A, U, C, G). Paired sites are denoted by two nucleotides placed simultaneously in one of the following pairs: {CG, GC, AU, UA, UG, GU}. When a pair of positions (i, j) in the predicted primary sequence and its corresponding secondary structure are given, we can calculate the confidence score for each position i based on the predicted letter at that position and the known secondary structure constraint. We then choose the position with the higher confidence score as the \u201dreference\u201d (say position i). We correct the predicted letter at position j so that the letters at i and j form the allowed pairs. Specifically, if position i is selected as the reference, we maintain the predicted letter at i unchanged and modify the predicted letter at j to satisfy the base pairing constraint. We then update the predicted primary sequence. By leveraging the information from the known secondary structure, we\ncan rectify and refine the initially predicted primary sequence. The refinement helps enhance the accuracy of RNA 3D structure prediction. In the training phase, we compel the model to sharpen the confidence of the nucleotides in the paired positions. The supervised loss is defined as:\nLsup = \u2211\n(i,j)\u2208Pairs\n[ `CE(si, f(h (L) Vi )/\u03c4 \u2032) + `CE(sj , f(h (L) Vj )/\u03c4 \u2032) ] + \u2211\nk/\u2208Pairs\n`CE(sk, f(h (L) Vk )), (8)\nwhere Pairs encompasses all the paired position indices given by the secondary structure, \u03c4 \u2032 is the temperature that is set as 0.5 by default to sharpen the confidence of paired nucleotides, si are true sequence labels. The training objective is the linear combination of representation learning loss and supervised loss:\nL = Lsup + \u03bb(Lcluster + Lsample), (9)\nwhere we set the weight parameter \u03bb as 0.5 by default."
        },
        {
            "heading": "4 EXPERIMENTS",
            "text": "We evaluate RDesign on the tertiary structure-based RNA design task by comparing it with four categories of baseline models: (i) sequence-based models (SeqRNN and SeqLSTM) that do not utilize any structural information and could be viewed as the performance reference for RNA design; (ii) A tertiary structure-based model (StructMLP) that exploits structural features while ignoring the graph topological structure; (iii) Tertiary structure-based models (StructGNN and GraphTrans) (Ingraham et al., 2019) and PiFold (Gao et al., 2022b) that incorporate the graph topological structure; (iv) secondary structure-based RNA sequence design models (MCTS-RNA (Yang et al., 2017), LEARNA (Runge et al., 2018), eM2dRNAs (Rubio-Largo et al., 2023), aRNAque (Merleau & Smerlak, 2022)). The detailed experimental settings and dataset descriptions are shown in Appendix A and Appendix B-C, respectively."
        },
        {
            "heading": "4.1 STANDARD TERTIARY STRUCTURE-BASED RNA DESIGN",
            "text": "Using our carefully curated benchmark dataset, we trained the model using the training set. Then, we evaluated the performance of the model on the testing set by selecting the model with the lowest loss on the validation set. Given that RNA sequences of varying lengths may impact prediction results, we stratified the testing set into three groups based on RNA length: (i) Short, RNA samples less than or equal to 50 nucleotides; (ii) Medium - RNA samples greater than 50 nucleotides but less than or equal to 100 nucleotides; (iii) Long - RNA samples greater than 100 nucleotides. To gain a thorough understanding of the relationship between RNA length and model accuracy, we reported both the recovery and Macro-F1 metrics for Short, Medium, and Long testing samples separately, in addition to overall testing set performance.\nAs presented in Table 2, the baseline models achieved suboptimal recovery scores, with performance ranging from 24-28%. Unexpectedly, tertiary structure-based models like StructMLP, StructGNN, and GraphTrans attained comparable results to sequence-based models. This indicates that directly applying protein design techniques to RNA is misguided and fails to capture the intricacies of RNA structures. Moreover, StructMLP and GraphTrans achieved higher recovery scores for short RNA\nsequences but struggled on longer, namely more complex RNA structures. Their struggles on the long dataset stem from the inability to learn from more intricate RNA structures and their low generalization capability. In contrast, our RDesign model outperforms all baseline methods on the recovery metric, achieving substantial gains. RDesign\u2019s strong performance, particularly on medium and long sets, indicates that it can learn intrinsic RNA structural properties.\nIt could be seen from Table 3 that there exist large gaps between the recovery metrics and Macro-F1 scores of most baseline models, which suggests those models tend to predict the high-frequency nucleotide letters instead of reflecting the actual tertiary structure. Among them, only StructGNN achieved consistent results in its Macro-F1 score and recovery metric but with unsatisfying performance. Our proposed RDesign consistently outperformed all other models on these metrics, demonstrating its effectiveness."
        },
        {
            "heading": "4.2 EVALUATE THE GENERALIZATION ON RFAM AND RNA-PUZZLES",
            "text": "To assess the generalization capability of our model, we evaluated our model and the baseline methods on the Rfam (Kalvari et al., 2021) and RNA-Puzzles (Miao et al., 2020) datasets using the model pre-trained on our benchmark training set. We presented the results in Table 4. The performance remained consistent with that of our benchmark dataset. Specifically, StructGNN, which effectively learned certain tertiary structure information, achieved a relatively small gap between the recovery metric and Macro F1 score. In contrast, the other baselines that learned little structural information performed sub-optimally. Our proposed RDesign model demonstrated superior generalization on both datasets and outperformed all the baselines.\nIt is notable that the results reported here were generated by directly assessing pretrained models on the entire training dataset, mirroring real-world scenarios. Furthermore, in Appendix H, we have included the results of the pretrained models assessed on a training set with similar data removed."
        },
        {
            "heading": "4.3 ABLATION STUDY",
            "text": "We conducted an ablation study of RDesign and presented the results in Table 5. Firstly, we replaced our tertiary structure modeling approach with the classical modeling from protein design, which led to a significant decrease in performance. Secondly, removing the hierarchical representation learning also resulted in a performance drop, indicating its importance. Replacing the hyperspherical space with Euclidean space led to a substantial reduction in performance, indicating its impact on dataefficient learning. In contrast, removing the secondary structure constraints provided a relatively small decrease in performance because RDesign itself could accurately generate RNA sequences. Additionally, we further tested the capability that our designed sequences could fold into desired tertiary structures, which is the final aim of the RNA sequences design problem. However, due to the lack of reliable RNA tertiary structure prediction tools, we are only able to conduct this experiment in a qualitative way. Results of three example structures from each length category have been reported and analyzed in Appendix 5."
        },
        {
            "heading": "5 EVALUATION THE CAPABILITY OF FOLDING FOR DESIGNED SEQUENCES",
            "text": "We used RhoFold (Shen et al., 2022) to predict the structures of RNA sequences designed by RDesign. Figure 5 shows three visualization examples: (a) a short sequence reconstructed by RDesign; (b) a long sequence that was designed with a similar structure and low structure deviation; (c) a complicated sequence that was designed with a similar structure but failed to achieve low structure deviation. These visualization examples demonstrate the effectiveness of our RDesign model in designing RNA sequences with structures similar to the target structure."
        },
        {
            "heading": "6 CONCLUSION AND LIMITATIONS",
            "text": "In this work, we investigate the challenging task of designing RNA tertiary structures. We compile a benchmark dataset to systematically assess the performance of various computational models on this task. While existing protein design methods cannot be directly applied, we propose a hierarchical data-efficient representation learning framework. Our framework explicitly captures the intrinsic relationships within the data while constraining the limited data to a restricted hyperspherical space. We also introduce a secondary structure constraining strategy to leverage extra structural information. Extensive experiments demonstrate the effectiveness of our proposed RDesign model. We hope this work provides a new perspective on tertiary structure-based RNA design. A limitation is that our method is currently limited to in silico design we leave wet-lab validation to future work."
        },
        {
            "heading": "7 ACKNOWLEDGEMENTS",
            "text": "We thank the anonymous reviewers for their constructive and helpful reviews. This work was supported by National Science and Technology Major Project (No. 2022ZD0115101), National Natural Science Foundation of China Project (No. U21A20427), the Center of Synthetic Biology and Integrated Bioengineering of Westlake University and Integrated Bioengineering of Westlake University Project (No. WU2022A009) and the Westlake University Industries of the Future Research Funding Project (No. WU2023C019)."
        },
        {
            "heading": "A EXPERIMENTAL SETTING",
            "text": "Datasets We evaluate our method on two tasks using three datasets: (i) We train and assess performance on our proposed RNA structure benchmark dataset which aggregates and cleans data from RNAsolo (Adamczyk et al., 2022b) and the Protein Data Bank (PDB) (Bank, 1971; Berman et al., 2000). The benchmark dataset consists of 2218 RNA tertiary structures, which are divided into training (1774 structures), testing (223 structures), and validation (221 structures) sets based on their structural similarity. The RNA sequence length is highly consistent within each subset, minimizing negative effects from distribution shifts. A detailed illustration of the creation and features of our dataset is shown in Appendix B. (ii) To test the generalization ability, we apply pre-trained models to the Rfam (Gardner et al., 2009; Nawrocki et al., 2015) and RNAPuzzle (Miao et al., 2020) datasets that contain non-overlapping structures. Rfam and RNAPuzzle are common datasets that contain novel RNA structures, which have 105 and 17 tertiary structures, respectively. The detailed description is in Appendix C.\nMetrics Previous protein design approaches usually use sequence perplexity and recovery metrics to evaluate the performance (Li et al., 2014; Ingraham et al., 2019; Wang et al., 2018; Jing et al., 2020; Tan et al., 2022; Gao et al., 2022a; O\u2019Connell et al., 2018). However, since RNA sequences only contain four letters, the perplexity metric traditionally used in natural language processing may not accurately reflect nucleotide-level prediction accuracy. Therefore, we use the recovery score to assess nucleotide-level accuracy by measuring the proportion of target RNA sequences that our model regenerates correctly. We also introduce the Macro-F1 score to evaluate performance by conceptualizing the RNA design task as a multi-class classification problem. The detailed illustrations of recovery and Macro-F1 scores are provided in Appendix E. We conducted each experiment three times with different random seeds and reported the mean and standard deviation values.\nImplementation Details We trained the model for 200 epochs using the Adam optimizer with a learning rate of 0.001. The batch size was set as 64. The model was implemented based on the standard PyTorch Geometric (Fey & Lenssen, 2019) library using the PyTorch 1.11.0 library. We ran the models on Intel(R) Xeon(R) Gold 6240R CPU @ 2.40GHz CPU and NVIDIA A100 GPU.\nThe model\u2019s encoder and decoder each had three layers. With a dropout rate of 0.1, it considered 30 nearest neighbors and a vocabulary size matching RNA\u2019s four alphabets. For the baseline models, the loss function is the negative log-likelihood loss 1N \u2211N i=1\u2212 log p(yi), where p(y) denotes the predicted probability of the true class. Notably, p(y) are presented in logarithmic form. With the exception of SeqRNN (h=256) and SeqLSTM (h=256), which feature a hidden size of 256, the remaining models were configured with a hidden size of 128. In our study, we have repurposed StructGNN and GraphTrans, initially designed for protein design as described in Ingraham et al.\u2019s work (Ingraham et al., 2019). These models have been adapted for RNA design, harnessing the capabilities of graph neural networks and the transformer architecture, respectively.\nBaseline Models We explored six baseline models that could be categorized into four classes based on the level of structural information utilized: (i) Sequence-based models (SeqRNN and SeqLSTM) that do not utilize any structural information and could be viewed as the performance reference for RNA design; (ii) A tertiary structure-based model (StructMLP) that exploits structural features while ignoring the graph topological structure; (iii) Tertiary structure-based models (StructGNN and GraphTrans) (Ingraham et al., 2019) and PiFold (Gao et al., 2022b) that incorporate the graph topological structure; (iv) several state-of-the-art RNA sequence design models based on secondary structure (MCTS-RNA (Yang et al., 2017), LEARNA (Runge et al., 2018), eM2dRNAs (RubioLargo et al., 2023), aRNAque (Merleau & Smerlak, 2022))."
        },
        {
            "heading": "B BENCHMARK DATASET DETAILS",
            "text": "B.1 OVERVIEW\nWe meticulously gathered RNA tertiary structure data from two principal sources: RNAsolo (Adamczyk et al., 2022a) and the Protein Data Bank (PDB) (Berman et al., 2000). RNAsolo is an RNA 3D structure database that provides free online access for downloading. After the initial collection, we cleaned the structures by removing non-RNA data. We then annotated and assigned them to\nequivalent classes defined by pairwise analysis of structural redundancy. We refined the abnormal samples that had inconsistent sequences and structures according to the PDB database.\nRegarding the sequence length distribution, we provided a quantitative analysis shown in Table 6. From the original RNA solo dataset, 95.79% of sequences are below 500 nucleotides in length, with sequences exceeding this length being sporadically dispersed between 500 and 4000 nucleotides.\nIncorporating such extremely long sequences would result in the selected features being overwhelmed by superfluous padding, thereby significantly escalating the computational resources needed. Therefore, we filtered out those with more than 500 nucleotides. We provide a runtime and memory usage analysis in Table 7.\nAfter filtering out the sequences with more than 500 nucleotides, we collected a total of 2218 highquality representative RNA structures, each with a resolution of less than 4.0 A\u030a.\nB.2 DATA CLUSTERING\nWe used the TM-score (Zhang & Skolnick, 2005) to assess structural similarity among RNA structures. To group samples with similar structures, we employed a graph-based clustering approach. Each structure is represented as a node, and the TM-Score between every pair of structures is computed. If the TM-Score for a pair exceeds 0.45, an edge is drawn between them, indicating their high similarity. After processing all pairs in this manner, clusters are identified as connected components within the graph. From our dataset of 2218 RNA structures, we yielded 987 distinct clusters.\nB.3 DATA SPLITTING\nHow to split biological datasets in a way that avoids information leakage and provides consistent evaluation is an important topic in AI for science. To achieve this, we split the collected data based on two principles: (i) avoiding similar structures in different sets and (ii) maintaining similar length distributions across sets. After obtaining 987 clusters, we added each to the training, validation, and testing datasets, maintaining vigilance to prevent similar structures from appearing in divergent sets. Specifically, we calculated the average length of all sequences and sequentially allocated clusters to the respective train/validation/test sets, managing to align each cluster closely with the global average length. Consequently, we maintained a consistent sequence length distribution across all sets, as depicted in Figure 6.\nIn this way, we allocated entire clusters\u2014rather than individual samples\u2014to specific sets, eliminating the possibility of data leakage between sets. Of the 987 total clusters, 838 were designated to the\ntraining set, 68 to the validation set, and 81 to the test set. The cluster size distribution in each set is shown in Table 8. It is worth noting that clusters containing a large number of samples (size > 30) are placed in the training set rather than the validation and test sets to prevent bias from dominant clusters when evaluating model performance.\nFinally, we partitioned the original dataset into training (1774 structures), testing (223 structures), and validation (221 structures) sets based on structural similarity and RNA sequence length. The evaluations of the baseline models were conducted on this split to ensure a fair comparison.\nB.4 DATA AUGMENTATION\nFor the purpose of sample-level representation learning, we employed a method to generate pseudo RNA structures by introducing slight perturbations to the coordinates. This approach takes into account the possibility of minor errors in experimental data. Initially, we obtained the coordinates of each atom within the RNA chains and introduced Gaussian noise, with the magnitude of noise determined by the scale of each coordinate value.\nSubsequently, we assessed the structural fidelity of the generated data by calculating two key metrics: the Root Mean Square Deviation (RMSD) and the TM-score in comparison to the ground truth structure. We excluded any generated data with an RMSD exceeding 1.0 A\u030a or a TM-score lower than 0.8. This stringent criterion was applied to ensure that the augmented samples maintained structural characteristics closely resembling those of the original data."
        },
        {
            "heading": "C RFAM AND RNA-PUZZLES DATASET DETAILS",
            "text": "C.1 RFAM DATABASE\nThe Rfam database (Kalvari et al., 2021) is a collection of RNA families, each represented by a multiple sequence alignment, a consensus secondary structure, and covariance models that describe\nthe consensus structure and base-pairing constraints of the RNA family. In the 14.7 release, 122 usable RNA sequences are aligned with their 3D structure stored in PDB format.\nC.2 RNA-PUZZLES DATASET\nThe RNA-puzzles dataset (Miao et al., 2020) is a public dataset that consists of a series of RNA structure prediction challenges, designed to evaluate and improve the accuracy of computational methods for predicting the structure of RNA molecules. Each RNA-puzzles challenge provides a set of experimental data, such as X-ray crystallography measurements stored in PDB format, along with a target sequence and structure for the RNA molecule. It has been widely used to benchmark and compare different computational methods for RNA structure prediction."
        },
        {
            "heading": "D LOCAL COORDINATE SYSTEMS UTILIZED IN OUR PAPER",
            "text": "Generally, the conventional modeling mentioned is the common protein tertiary structural modeling approach from (Ingraham et al., 2019). It considers dihedral angles as node features and uses C\u03b1 atoms to build the local coordinate system. While it is sufficient for extracting features from protein structures, they may not be suitable for the more complex RNA structures. We propose a comprehensive approach to modeling RNA tertiary structures that are specifically designed for RNA.\nOur baseline models StructGNN and GraphTrans are from (Ingraham et al., 2019), which uses the conventional modeling approach. We adjusted this protein modeling for RNA by replacing its three dihedral angles with RNA\u2019s six and using the P atom instead of the C\u03b1 atom.\nWe construct a local coordinate system for each nucleotide i. This system is defined as:\nQi = [bi,ni,bi \u00d7 ni], (10)\nwhere bi is the negative bisector of angles between the rays of contiguous coordinates (xi\u22121,P,xi,P) and (xi+1,P,xi,P), and ni is a unit vector normal to that plane. Formally, bi and ni are:\nui = xi \u2212 xi\u22121 \u2016xi \u2212 xi\u22121\u2016 ,bi = ui \u2212 ui+1 \u2016ui \u2212 ui+1\u2016 ,ni = ui \u00d7 ui+1 \u2016ui \u00d7 ui+1\u2016 . (11)\nAs illustrated in Figure 7, constructing the local coordinate system involves calculating the bond vectors between successive P atoms and using these to determine the bisector bi and normal ni. Since this coordinate system is defined relative to a fixed set of atoms within each nucleotide, it is invariant to overall rotations and translations of the RNA structure."
        },
        {
            "heading": "E EVALUATION METRICS",
            "text": "E.1 RECOVERY\nTo rigorously assess the nucleotide-level prediction accuracy of an RNA sequence model, we adopt the following recovery metric:\nRecovery(SN ,XN ) = 1 N N\u2211 i=1 1 [ SNi = arg maxP(SNi |X ) ] , (12)\nwhere P(SNi |Xi,X<i) represents the probability of predicting nucleotide SNi at position i given the input structure X , and 1[ ] is the indicator function. This recovery metric evaluates the fraction of nucleotides in the RNA sequence that are correctly predicted as the most probable by the model, averaged over all N positions. It thus rigorously assesses the model\u2019s ability to accurately predict the sequence at the nucleotide level based on the inputs. This metric provides a nuanced evaluation of the predictive accuracy achieved by the RNA sequence model at the nucleotide resolution.\nE.2 MACRO-F1 SCORE\nWe introduce the Macro-F1 score to evaluate performance by conceptualizing the RNA design task as a multi-class classification problem and adopt the Macro-F1 score metric to comprehensively evaluate the model\u2019s performance on different classes. It is calculated as the average of the F1 scores for each class of letters.\nMacro-F1 = 1\n|C| C\u2211 c\u2208{A,U,C,G} F1c, (13)\nwhere |C| is the number of letters and F1c is the F1 score for letter c. The F1 score is the harmonic mean of precision and recall. It considers both the proportion of correctly predicted instances of letter c and the proportion of instances predicted as letter c that belong to letter c.\nF1c = 2\u00d7 Precisionc \u00d7 Recallc Precisionc + Recallc . (14)\nTherefore, the Macro-F1 score comprehensively reflects the model\u2019s prediction performance on different letters by evaluating the F1 score for each letter. Compared to simply calculating the average precision or recall over all letters, it can more comprehensively evaluate the model\u2019s ability to identify instances of each letter, especially in cases where there is an imbalance between the number of instances of different letters. It examines the proportion of correctly classified instances at the letter level while balancing precision and recall.\nE.3 PERPLEXITY\nPerplexity is a common metric used in various fields including natural language processing and bioinformatics. In the context of RNA design, perplexity can be used as a measure to evaluate the uncertainty of RNA sequences, reflecting how well a model can predict a given RNA sequence.\nPerplexity(SN ,XN ) = exp(\u2212 1 N N\u2211 i=1 SNi log p(SNi |XN )), (15)\nWhere p(SNi |XN ) is the output probability from the model. While perplexity is a crucial metric in natural language processing (NLP) and protein design, its suitability is significantly less in RNA design due to the inherent simplicity and structural constraints of RNA sequences. RNA sequences, with only four letters A, U, C, G, lack the compositional complexity found in natural languages, making perplexity less discriminative and revealing as a model evaluation metric in this context. Considering these limitations, we chose not to prioritize this metric in our main text. We show the results in Table 9. It can be seen that the outcomes are not aligned with other metrics, and notably, sequence-based methods consistently outperform structure-based methods, which is a phenomenon contrary to common sense."
        },
        {
            "heading": "F HYPERSPHERICAL SPACE OF REPRESENTATION LEARNING",
            "text": "In contrastive representation learning, mapping features to hyperspherical space is a technique used to better represent similarity. In this supervised learning algorithm, the similarity between two samples is represented as the distance or similarity between their feature vectors. To better represent this similarity, the features are mapped to hyperspherical space. Specifically, the feature vector h is mapped to hyperspherical space by dividing it by its norm ||h||, resulting in a unit vector h||h|| . This unit vector is the representation in hyperspherical space. The projection head comprises an MLP and feature normalization. The advantage of this method is that it normalizes feature vectors to the same length, avoiding the influence of scale changes in the feature space on similarity measurement. Additionally, since hyperspherical space is a convex space, similarity measurement in this space is convenient and efficient.\nUsing a hypersphere for embedding data points is advantageous because it allows each data point to cover a larger expressive space compared to confining all points within a small region of Euclidean space. This enables the model to maximize the expressive power and learnability of each individual data point within the limited dataset. Conversely, if data distributions are not controlled, the representations may collapse and cluster in a small portion of the space, limiting their individual expressiveness. The hypersphere provides a structured way to distribute data representations evenly. This uniform assignment of limited data to hypersphere space is thus crucial for ensuring every data point can be maximally informative during contrastive representation learning. The design choice stems directly from the need to learn efficiently from scarce RNA structure data."
        },
        {
            "heading": "G MODEL DETAILS",
            "text": "G.1 RDESIGN MODEL\nHere we present two levels of the system paradigm of our model. The brief pipeline is shown in Figure 8, which serves as a comparison with the baselines proposed in our paper. Another detailed pipeline is presented as Figure 9, which draws a comprehensive view of our model, indicating the function of each part, and illustrating the formulation of the loss function.\nG.2 BASELINE MODELS\nIn this work, we employed five baseline models to perform as the reference to our RDesign model. For each of them, we provide a brief introduction and summarize the pipeline in the figure below. In the experiment, both the encoder and decoder contain three layers by default.\nSeqRNN SeqRNN is a context-aware recurrent neural network model that is suitable for sequence generation tasks. Based on recurrent networks, it can utilize its memory to process the input sequences and learn the distribution of the sequences by adjusting the weight coefficients. The output of SeqRNN is a sequence with the same length as the inputs. The pipeline is shown in Figure 10.\nSeqLSTM Similar to SeqRNN, SeqLSTM is an LSTM-based context-aware suitable for sequence generation tasks. It can extract the sequence order features into embeddings. Then the output sequence could be obtained by passing the embeddings through a linear layer. The pipeline of the model is shown in Figure 11.\nStructMLP StructMLP represents a structure-based RNA sequence prediction model. This approach harnesses the structural characteristics of RNA molecules through a Multilayer Perceptron (MLP) architecture, allowing for the structural insights to produce sequence predictions. The schematic representation of the model\u2019s workflow is illustrated in Figure 12.\nStructGNN In contrast to StructMLP, StructGNN employs a Graph Neural Network (GNN) as its feature encoder. This choice equips StructGNN with the capacity to capture and learn the intricate graph structures inherent in RNA tertiary structures, a capability beyond the reach of StructMLP. The model\u2019s workflow is visually depicted in Figure 13.\nGraphTrans The primary distinction between GraphTrans and StructGNN lies in the feature encoder employed. GraphTrans leverages the Transformer architecture for this purpose. To illustrate the model\u2019s workflow, please refer to Figure 14."
        },
        {
            "heading": "H EVALUATION ON EXTERNAL DATASETS",
            "text": "In the main text, we used the pretrained model trained on the entire training set to evaluate models on the external datasets Rfam and RNA-Puzzles. We show the structural similarity distribution between our training data and the three test sets in Figure 15. This distribution demonstrates that the majority of structural similarities are concentrated around a TM-score of 0.1, which suggests low structural similarity. In our benchmark dataset, the structural similarity between all test data and any training sample remains below 0.45. However, in the Rfam and RNA-Puzzles datasets, there are still a few instances of similar samples. We directly evaluated the models pretrained on the complete training set on these two datasets, as this approach closely mirrors real-world application scenarios.\nTo evaluate the model\u2019s generalization ability on dissimilar samples, we implemented a filtering process on the training set. While evaluating models on the Rfam dataset, we removed all samples from the training set that exhibited a structural similarity exceeding 0.45 with any sample in Rfam. Likewise, during the evaluation on the RNA-Puzzles dataset, we excluded all samples from the training set that possessed structural similarity scores surpassing 0.45 with any sample in RNAPuzzles. The distributions of pairwise structural similarity between the training set and three test sets are visualized in Figure 16.\nThe results on the Rfam and RNA-Puzzles with filtered training sets are shown in Table 10. It can be seen that RDesign still outperforms other baseline models."
        },
        {
            "heading": "I COMPARISON ON AUROC AND AUPRC METRICS",
            "text": "We conduct comparisons with baseline models using the AUROC and AUPRC metrics. For our benchmark test set, the results for the AUROC and AUPRC metrics are presented in Tables 11 and\n12, respectively. Regarding the Rfam and RNA-Puzzles datasets, the AUROC and AUPRC results are displayed in Tables 13, 14, 15, and 16, respectively. RDesign consistently outperforms the other baseline models in these datasets."
        }
    ],
    "title": "RDESIGN: HIERARCHICAL DATA-EFFICIENT REPRE-",
    "year": 2024
}